
[[cls_10]]
== Thematic model

The thematic model of CityGML consists of the class definitions for the most important types of objects within virtual 3D city models. These classes have been identified to be either required or important in many different application areas. Most thematic classes are (transitively) derived from the basic classes &#95;__Feature__ and &#95;__FeatureCollection__, the basic notions defined in ISO 19109 and GML3 for the representation of spatial objects and their aggregations. Features contain spatial as well as non-spatial attributes which are mapped to GML3 feature properties with corresponding data types. Geometric properties are represented as associations to the geometry classes described in <<cls_8>>. The thematic model also comprises different types of interrelationships between feature classes like aggregations, generalisations and associations.

The aim of the explicit modelling is to reach a high degree of semantic interoperability between different applications. By specifying the thematic concepts and their semantics along with their mapping to UML and GML3 different applications can rely on a well-defined set of _feature types_, attributes and data types with a standardised meaning or interpretation. In order to also allow for the exchange of objects and/or attributes that are not explicitly modelled in CityGML, the concepts of _generic city objects_ and _attributes_ as well as CityGML's _Application Domain Extension_ mechanism have been introduced (cf. <<scls_10-12>> and <<scls_10-13>>).

Each field of CityGML's thematic model is covered by a separate CityGML extension module. Thus, the extension modules are derived by vertically slicing the overall thematic data model of CityGML. All extension modules are based on and are dependent from the CityGML core module. The core comprises the basic concepts and components of the CityGML data model. Implementations may choose to combine CityGML extension modules in conjunction with the core according to their specific information needs or application domain. As for version 2.0 of CityGML, the following thirteen thematic extension modules are defined: _Appearance_, _Bridge_, _Building_, _CityFurniture_, _CityObjectGroup_, _Generics_, _LandUse_, _Relief_, _Transportation_, _Tunnel_, _Vegetation_, _WaterBody_, and _TexturedSurface [deprecated]_. Valid combinations of CityGML modules are called CityGML profiles. By this means, CityGML profiles explicitly allow for partial implementations of the overall CityGML data model (cf. <<cls_7>>).

The thematic fields covered by the CityGML data model are introduced within the sub clauses of this chapter. Each sub clause is related to a specific CityGML module.



[[scls_10-1]]
=== CityGML Core

The _CityGML Core_ module defines the basic concepts and components of the overall CityGML data model. It forms the universal lower bound of the CityGML data model and, thus, is a dependency of all extension modules. Consequently, the core module has to be implemented by any conformant system. Primarily, the core module provides the abstract base classes from which thematic classes within extension modules are (transitively) derived. Besides abstract type definitions, the core also contains non-abstract content, for example basic data types and thematic classes that may be used by more than one extension module. The UML diagram in <<fig_21>> illustrates CityGML's core module, for the XML Schema definition see below and <<a_A-1>>.

[[fig_21]]
.UML diagram of CityGML's core module. The bracketed numbers following the attribute names denote the attribute's multiplicity: the minimal and maximal number of occurrences of the attribute per object. For example, a _name_ is optional (0) in the class &#95;__Feature__ or may occur multiple times (star symbol), while a &#95;__CityObject__ has none or at most one _creationDate_. Prefixes are used to indicate XML namespaces associated with model elements. Element names without a prefix are defined within the _CityGML Core_ module.
image::047.png["",756,346]


The base class of all thematic classes within CityGML's data model is the abstract class &#95;__CityObject__. &#95;__CityObject__ provides a creation and a termination date for the management of histories of features as well as the possibility to model external references to the same object in other data sets. Furthermore, two qualitative attributes _relativeToTerrain_ and _relativeToWater_ are provided which enable to specify the feature's location with respect to the terrain and water surface. The possible topological relations are illustrated in <<fig_22>>. Both attributes facilitate simple and efficient queries like for the number of subsurface buildings (_entirelyBelowTerrain_) without the need for an additional digital terrain model or a model of the water body.


[[fig_22]]
.Topological relations of a CityGML object with respect to a) the terrain and b) the water surface.
====
[%unnumbered]
.a)
image::048.png["",354,233]

[%unnumbered]
.b)
image::049.png["",354,233]
====

&#95;__CityObject__ is a subclass of the GML class &#95;__Feature__, thus it inherits the metadata property (which can be e.g. information about the lineage, quality aspects, accuracy, local CRS) and name property from the superclass &#95;__GML__. A &#95;__CityObject__ may have multiple names, which are optionally qualified by a _codeSpace_.This enables the differentiation between, for example, an official name and a popular name or of names in different languages (cf. the name property of GML objects, Cox et al. 2004). The generalisation property _generalizesTo_ of &#95;__CityObject__ may be used to relate features, which represent the same real-world object in different Levels-of-Detail, i.e. a feature and its generalised counterpart(s). The direction of this relation is from the feature to the corresponding generalised feature.

Thematic classes may have further subclasses with relations, attributes and geometry. Features of the specialized subclasses of &#95;__CityObject__ may be aggregated to a single _CityModel_, which is a feature collection with optional metadata. Generally, each feature has the attributes _class_, _function,_ and _usage_, unless it is stated otherwise. The _class_ attribute can occur only once, while the attributes _usage_ and _function_ can be used multiple times. The _class_ attribute allows for the classification of features beyond the thematic class hierarchy of &#95;__CityObject__. For example, a building feature is represented by the thematic subclass _bldg:Building_ of &#95;__CityObject__ in the first place (this subclass is defined within CityGML's _Building_ module, cf. <<scls_10-3>>). A further classification, e.g. as residential or administration building, may then be modelled using the _class_ attribute of the class _bldg:Building_. The attribute _function_ normally denotes the intended purpose or usage of the object, such as hotel or shopping centre for a building, while the attribute _usage_ normally defines its real or actual usage. Possible values for the attributes _class_, _function_, and _usage_ can be specified in code lists which are recommended to be implemented as simple dictionaries following the _Simple Dictionary Profile_ of GML 3.1.1 (cf. <<scls_6-6>> and <<scls_10-14>>). <<annex_c>> provides code lists proposed and maintained by the SIG 3D which contain feasible attribute values and which may be extended or redefined by users.

In addition to thematic content, the core module also provides the concept of implicit geometries as an enhancement of the geometry model of GML3. Since this concept is strongly related to the spatial model of CityGML it has already been introduced in <<scls_8-2>>.

The top level class hierarchy of the thematic model in CityGML is presented in <<fig_23>>. The subclasses of &#95;__CityObject__ comprise the different thematic fields of a city model covered by separate CityGML extension modules: the terrain, buildings, bridges, tunnels, the coverage by land use objects, water bodies, vegetation, generic city objects, city furniture objects, city object groups, and transportation. To indicate the extension module defining a respective subclass of &#95;__CityObject__, the class names in <<fig_23>> are preceded by prefixes. Each prefix is associated with one CityGML extension module (see <<scls_4-3>> and <<cls_7>> for a list of CityGML's extension modules and the corresponding prefixes).

[[fig_23]]
.CityGML's top level class hierarchy. Prefixes are used to indicate XML namespaces associated with model elements. Element names without a prefix are defined within the _CityGML Core_ module.
image::050a.png["",755,461]



The classes _GenericCityObject_ and &#95;__genericAttribute__ defined within CityGML's _Generics_ module (cf. <<scls_6-11>> and <<scls_10-12>>) allow for modelling and exchanging of 3D objects which are not covered by any other thematic class or which require attributes not represented in CityGML. For example, in the future, sites derived from the abstract class &#95;__Site__ of the core module may be completed by further subclasses like excavation, city wall or embankment. At present, the class _GenericCityObject_ should be used in order to represent and exchange these features. However, the concept of generic city objects and attributes may only be used if appropriate thematic classes or attributes are not provided by any other CityGML module.

If the _Generics_ module is employed, each _CityObject_ may be assigned an arbitrary number of generic attributes in order to represent additional properties of features. For this purpose, the _Generics_ module augments the abstract base class &#95;__CityObject__ by the property element &#95;__genericAttribute__. The additional property &#95;__genericAttribute__ is injected into &#95;__CityObject__ using CityGML's _Application Domain Extension_ mechanism (cf. <<scls_10-13>>). By this means, each thematic subclass of &#95;__CityObject__ inherits this property and, thus, the possibility to contain generic attributes. Therefore, the _Generics_ module has a deliberate impact on all CityGML extension modules defining thematic subclasses of &#95;__CityObject__.

Appearance information about a feature's surfaces can be represented by the class _Appearance_ provided by CityGML's _Appearance_ module (cf. <<cls_9>>). In contrast to the other thematic extensions to the core, _Appearance_ is not derived from &#95;__CityObject__ but from the GML class &#95;__Feature__. &#95;__CityObject__ features and _Appearance_ features may be embraced within a single _CityModel_ feature collection in an arbitrary or even mixed sequence using the _cityObjectMember_ and _appearanceMember_ elements, both being members of the substitution group _gml:featureMember_ (cf. <<cls_9>> and <<scls_10-1-1>>). Furthermore, feature appearances may be stored inline the &#95;__CityObject__ itself. In order to enable city objects to store appearance information, the _Appearance_ module augments the abstract base class &#95;__CityObject__ by the property element _appearance_ using CityGML's _Application Domain Extension_ mechanism (cf. <<scls_10-13>>). Consequently, the _appearance_ property is only available for &#95;__CityObject__ and its thematic subclasses if the _Appearance_ module is supported. Therefore, like the _Generics_ module, the _Appearance_ module has a deliberate impact on any other extension module.

For sake of completeness, the class _TexturedSurface_ is also illustrated in <<fig_23>>. This approach of appearance modelling of previous versions of CityGML has been deprecated and is expected to be removed in future CityGML versions. Since the information covered by _TexturedSurface_ can be losslessly converted to the _Appearance_ module, the use of _TexturedSurface_ is _strongly discouraged_.


*XML namespace*

The XML namespace of the _CityGML Core_ module is identified by the Uniform Resource Identifier (URI) http://www.opengis.net/citygml/2.0. Within the XML Schema definition of the core module, this URI is also used to identify the default namespace.


[[scls_10-1-1]]
==== Base elements


.AbstractCityObjectType, _CityObject
[source%unnumbered,xml]
----
<xs:complexType name="AbstractCityObjectType" abstract="true">
    <xs:complexContent>
        <xs:extension base="gml:AbstractFeatureType">
            <xs:sequence>
                <xs:element name="creationDate" type="xs:date" minOccurs="0"/>
                <xs:element name="terminationDate" type="xs:date" minOccurs="0"/>
                <xs:element name="externalReference" type="ExternalReferenceType" minOccurs="0" maxOccurs="unbounded"/>
                <xs:element name="generalizesTo" type="GeneralizationRelationType" minOccurs="0" maxOccurs="unbounded"/>
                <xs:element name="relativeToTerrain" type="RelativeToTerrainType" minOccurs="0"/>
                <xs:element name="relativeToWater" type="RelativeToWaterType" minOccurs="0"/>
                <xs:element ref="_GenericApplicationPropertyOfCityObject" minOccurs="0" maxOccurs="unbounded"/>
            </xs:sequence>
        </xs:extension>
    </xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="_CityObject" type="AbstractCityObjectType" abstract="true" substitutionGroup="gml:_Feature"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfCityObject" type="xs:anyType" abstract="true"/>
----



.CityModelType, CityModel
[source%unnumbered,xml]
----
<xs:complexType name="CityModelType">
    <xs:complexContent>
        <xs:extension base="gml:AbstractFeatureCollectionType">
            <xs:sequence>
                <xs:element ref="_GenericApplicationPropertyOfCityModel" minOccurs="0" maxOccurs="unbounded"/>
            </xs:sequence>
        </xs:extension>
    </xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="CityModel" type="CityModelType" substitutionGroup="gml:_FeatureCollection"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfCityModel" type="xs:anyType" abstract="true"/>
----


.cityObjectMember
[source%unnumbered,xml]
----
<xs:element name="cityObjectMember" type="gml:FeaturePropertyType" substitutionGroup="gml:featureMember"/>
----


.AbstractSiteType, _Site
[source%unnumbered,xml]
----
<xs:complexType name="AbstractSiteType" abstract="true">
    <xs:complexContent>
        <xs:extension base="AbstractCityObjectType">
            <xs:sequence>
                <xs:element ref="_GenericApplicationPropertyOfSite" minOccurs="0" maxOccurs="unbounded"/>
            </xs:sequence>
        </xs:extension>
    </xs:complexContent>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:element name="_Site" type="AbstractSiteType" abstract="true" substitutionGroup="_CityObject"/>
<!-- ========================================================================================== -->
<xs:element name="_GenericApplicationPropertyOfSite" type="xs:anyType" abstract="true"/>
----

The abstract class &#95;__Site__ is intended to be the superclass for buildings, bridges, tunnels, facilities, etc. Future extension of CityGML (e.g. excavations, city walls or embankments) would be modelled as subclasses of &#95;__Site__. As subclass of &#95;__CityObject__, a &#95;__Site__ inherits all attributes and relations, in particular the id, names, external references, and generalisation relations.


[[scls_10-1-2]]
==== Generalisation relation, RelativeToTerrainType and RelativeToWaterType

.GeneralizationRelationType
[source%unnumbered,xml]
----
<xs:complexType name="GeneralizationRelationType">
    <xs:sequence minOccurs="0">
        <xs:element ref="_CityObject"/>
    </xs:sequence>
    <xs:attributeGroup ref="gml:AssociationAttributeGroup"/>
</xs:complexType>
----


.RelativeToTerrainType, RelativeToWaterType
[source%unnumbered,xml]
----
<xs:simpleType name="RelativeToTerrainType">
    <xs:restriction base="xs:string">
        <xs:enumeration value="entirelyAboveTerrain"/>
        <xs:enumeration value="substantiallyAboveTerrain"/>
        <xs:enumeration value="substantiallyAboveAndBelowTerrain"/>
        <xs:enumeration value="substantiallyBelowTerrain"/>
        <xs:enumeration value="entirelyBelowTerrain"/>
    </xs:restriction>
</xs:simpleType>
<!-- ========================================================================================= -->
<xs:simpleType name="RelativeToWaterType">
    <xs:restriction base="xs:string">
        <xs:enumeration value="entirelyAboveWaterSurface"/>
        <xs:enumeration value="substantiallyAboveWaterSurface"/>
        <xs:enumeration value="substantiallyAboveAndBelowWaterSurface"/>
        <xs:enumeration value="substantiallyBelowWaterSurface"/>
        <xs:enumeration value="entirelyBelowWaterSurface"/>
        <xs:enumeration value="temporarilyAboveAndBelowWaterSurface"/>
    </xs:restriction>
</xs:simpleType>
----


[[scls_10-1-3]]
==== External references

An _ExternalReference_ defines a hyperlink from a &#95;__CityObject__ to a corresponding object in another information system, for example in the German cadastre (ALKIS), the German topographic information system (ATKIS), or the OS MasterMap^(R)^. The reference consists of the name of the external information system, represented by an URI, and the reference of the external object, given either by a string or by an URI. If the _informationSystem_ element is missing in the _ExternalReference_, the _ExternalObjectReference_ must be an URI.


.ExternalReferenceType, ExternalObjectReferenceType
[source%unnumbered,xml]
----
<xs:complexType name="ExternalReferenceType">
    <xs:sequence>
        <xs:element name="informationSystem" type="xs:anyURI" minOccurs="0"/>
        <xs:element name="externalObject" type="ExternalObjectReferenceType"/>
    </xs:sequence>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:complexType name="ExternalObjectReferenceType">
    <xs:choice>
        <xs:element name="name" type="xs:string"/>
        <xs:element name="uri" type="xs:anyURI"/>
    </xs:choice>
</xs:complexType>
----


[[scls_10-1-4]]
==== Address information

The CityGML core module provides the means to represent address information of real-world features within virtual city models. Since not every real-world feature is assigned an address, a correspondent _address_ property is not defined for the base class &#95;__CityObject__, but has to be explicitly modelled for a thematic subclass. For example, the building model declares _address_ properties for its classes &#95;__AbstractBuilding__ and _Door_. Both classes are referencing the corresponding data types of the core module to represent address information (cf. <<scls_10-3>>).

Addresses are modelled as GML features having one _xalAddress_ property and an optional _multiPoint_ property. For example, for a building feature the _multiPoint_ property allows for the specification of the exact positions of the building entrances that are associated with the corresponding address. The point coordinates can be 2D or 3D. Modelling addresses as features has the advantage that GML3's method of representing features by reference (using XLinks) can be applied. This means, that addresses might be bundled as an address _FeatureCollection_ that is stored within an external file or that can be served by an external Web Feature Service. The addressproperty elements within the CityGML file then would not contain the address information inline but only references to the corresponding external features.

The address information is specified using the _xAL address standard_ issued by the OASIS consortium (OASIS 2003), which provides a generic schema for all kinds of international addresses. Therefore, child elements of the _xalAddress_ property of _Address_ have to be structured according to the OASIS xAL schema.


.AddressPropertyType, AddressType, Address
[source%unnumbered,xml]
----
<xs:complexType name="AddressPropertyType">
    <xs:sequence minOccurs="0">
        <xs:element ref="Address"/>
    </xs:sequence>
    <xs:attributeGroup ref="gml:AssociationAttributeGroup"/>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:complexType name="AddressType">
    <xs:complexContent>
        <xs:extension base="gml:AbstractFeatureType">
            <xs:sequence>
                <xs:element name="xalAddress" type="xalAddressPropertyType"/>
                <xs:element name="multiPoint" type="gml:MultiPointPropertyType" minOccurs="0"/>
                <xs:element ref="_GenericApplicationPropertyOfAddress" minOccurs="0" maxOccurs="unbounded"/>
            </xs:sequence>
        </xs:extension>
    </xs:complexContent>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:element name="Address" type="AddressType" substitutionGroup="gml:_Feature"/>
<!-- ========================================================================================== -->
<xs:element name="_GenericApplicationPropertyOfAddress" type="xs:anyType" abstract="true"/>
<!-- ========================================================================================== -->
<xs:complexType name="xalAddressPropertyType">
    <xs:sequence>
        <xs:element ref="xAL:AddressDetails"/>
    </xs:sequence>
</xs:complexType>
----

The following two excerpts of a CityGML dataset contain examples for the representation of German and British addresses in xAL. The address information is attached to building objects (_bldg:Building_) according to the CityGML _Building_ module (cf. <<scls_10-3>>). Generally, if a CityGML instance document contains address information, the namespace prefix "xAL" should be declared in the root element and must refer to "urn:oasis:names:tc:ciq:xsdschema:xAL:2.0". An example showing a complete CityGML dataset including a building with an address element is provided in <<a_G-1>>.


[source%unnumbered,xml]
----
<bldg:Building>
    ...
    <bldg:address>
        <core:Address>
            <core:xalAddress>
                <!-- Bussardweg 7, 76356 Weingarten, Germany -->
                <xAL:AddressDetails>
                    <xAL:Country>
                        <xAL:CountryName>Germany</xAL:CountryName>
                        <xAL:Locality Type="City">
                            <xAL:LocalityName>Weingarten</xAL:LocalityName>
                            <xAL:Thoroughfare Type="Street">
                                <xAL:ThoroughfareNumber>7</xAL:ThoroughfareNumber>
                                <xAL:ThoroughfareName>Bussardweg</xAL:ThoroughfareName>
                            </xAL:Thoroughfare>
                            <xAL:PostalCode>
                                <xAL:PostalCodeNumber>76356</xAL:PostalCodeNumber>
                            </xAL:PostalCode>
                        </xAL:Locality>
                    </xAL:Country>
                </xAL:AddressDetails>
            </core:xalAddress>
        </core:Address>
    </bldg:address>
</bldg:Building>
----




[source%unnumbered,xml]
----
<bldg:Building>
    ...
    <bldg:address>
        <core:Address>
            <core:xalAddress>
                <!-- 46 Brynmaer Road Battersea LONDON, SW11 4EW United Kingdom -->
                <!-- source: http://xml.coverpages.org/xnal.html -->
                <xAL:AddressDetails>
                    <xAL:Country>
                        <xAL:CountryName>United Kingdom</xAL:CountryName>
                        <xAL:Locality Type="City">
                            <xAL:LocalityName>LONDON</xAL:LocalityName>
                            <xAL:DependentLocality Type="District">
                                <xAL:DependentLocalityName>Battersea</xAL:DependentLocalityName>
                                <xAL:Thoroughfare>
                                    <xAL:ThoroughfareNumber>46</xAL:ThoroughfareNumber>
                                    <xAL:ThoroughfareName>Brynmaer Road</xAL:ThoroughfareName>
                                </xAL:Thoroughfare>
                            </xAL:DependentLocality>
                            <xAL:PostalCode>
                                <xAL:PostalCodeNumber>SW11 4EW</xAL:PostalCodeNumber>
                            </xAL:PostalCode>
                        </xAL:Locality>
                    </xAL:Country>
                </xAL:AddressDetails>
            </core:xalAddress>
        </core:Address>
    </bldg:address>
</bldg:Building>
----


[[scls_10-1-5]]
==== Code lists

The _mimeType_ attribute of _ImplicitGeometry_ is specified as _gml:CodeType_. The values of this property can be enumerated in a code list. A proposal for this code list can be found in <<a_C-6>>.

[[scls_10-1-6]]
==== Conformance requirements

*Base requirements*

. The _CityModel_ element (type: _CityModelType,_ substitutionGroup: _gml:&#95;__FeatureCollection__) shall only contain _cityObjectMember_elements (type: _gml:FeaturePropertyType_), _app:appearanceMember_ elements (type: _app:AppearancePropertyType_), and _gml:featureMember_ elements (type: _gml:FeaturePropertyType_) as feature members.
. The type _ExternalObjectReference_ introduces the two elements _name_ (type: _xs:string_) and _uri_ (type: _xs:anyURI_). The external reference may be specified by either of them. However, if the _informationSystem_ property element (type: _xs:anyURI_) of the type _ExternalReferenceType_ is not provided, the _uri_ element of _ExternalObjectReference_ must be given.
. In order to represent address information about a feature, the corresponding thematic class of the feature shall define a property of the type _AddressPropertyType_. Thus, for all CityGML extension modules only the type _AddressPropertyType_ shall be used for elements providing address information.
. Since the concept of implicit geometries (cf. <<scls_8-2>>) is part of the _CityGML Core_ module, the conformance requirements introduced for implicit geometries (cf. <<scls_8-3-3>>) are part of the conformance requirements of the core. 


*Referential integrity*

[start=5]
. The _cityObjectMember_ element (type: _gml:FeaturePropertyType_) may contain a &#95;__CityObject__ element, which typically is an object from a derived subclass like _bldg:Building_, inline or an XLink reference to a remote &#95;__CityObject__ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _cityObjectMember_ element may only point to a remote &#95;__CityObject__ element (where remote &#95;__CityObject__ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The type _AddressPropertyType_ may contain an _Address_ element inline or an XLink reference to a remote _Address_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the correspondingelement of type _AddressPropertyType_ may only point to a remote _Address_ element (where remote _Address_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.



[[scls_10-2]]
=== Digital Terrain Model (DTM)

An essential part of a city model is the terrain. The Digital Terrain Model (DTM) of CityGML is provided by the thematic extension module _Relief_ (cf. <<cls_7>>). In CityGML, the terrain is represented by the class _ReliefFeature_ in LOD 0-4 (<<fig_24>> depicts the UML diagram, for the XML schema definition see <<a_A-9>>). A _ReliefFeature_ consists of one or more entities of the class _ReliefComponent_. Its validity may be restricted to a certain area defined by an optional _validity extent polygon_. As _ReliefFeature_ and _ReliefComponent_ are derivatives of &#95;__CityObject__, the corresponding attributes and relations are inherited. The class _ReliefFeature_ is associated with different concepts of terrain representations which can coexist. The terrain may be specified as a regular raster or grid (_RasterRelief)_, as a TIN (Triangulated Irregular Network, _TINReflief_), by break lines (_BreaklineRelief)_, or by mass points _(MasspointRelief)_. The four types are implemented by the corresponding GML3 classes: grids by _gml:__RectifiedGridCoverage,_ break lines by _gml:MultiCurve,_ mass points by _gml:MultiPoint_ and TINs either by _gml:TriangulatedSurface_ or by _gml:Tin_. In case of _gml:__ TriangulatedSurfaces_, the triangles are given explicitly while in case of _gml:Tin_ only 3D points are represented, where the triangulation can be reconstructed by standard methods (Delaunay triangulation, cf. Okabe et al. 1992). Break lines are represented by 3D curves. Mass points are simply a set of 3D points.

[[fig_24]]
.UML diagram of the Digital Terrain Model in CityGML. Prefixes are used to indicate XML namespaces associated with model elements. Element names without a prefix are defined within the CityGML _Relief_ module.
image::051.png["",755,454]


In a CityGML dataset the four terrain types may be combined in different ways, yielding a high flexibility. First, each type may be represented in different levels of detail, reflecting different accuracies or resolutions. Second, a part of the terrain can be described by the combination of multiple types, for example by a raster and break lines, or by a TIN and break lines. In this case, the break lines must share the geometry with the triangles. Third, neighboring regions may be represented by different types of terrain models. To facilitate this combination, each terrain object is provided with a spatial attribute denoting its _extent of validity_ (<<fig_25>>). In most cases, the extent of validity of a regular raster dataset corresponds to its bounding box. This validity extent is represented by a 2D footprint polygon, which may have holes. This concept enables, for example, the modelling of a terrain by a coarse grid, where some distinguished regions are represented by a detailed, high-accuracy TIN. The boundaries between both types are given by the extent attributes of the corresponding terrain objects.

[[fig_25]]
.Nested DTMs in CityGML using validity extent polygons (graphic: IGG Uni Bonn).
image::052.png["",475,290]



Accuracy and resolution of the DTM are not necessarily dependent on features of other CityGML extenstion modules such as building models. Hence, there is the possibility to integrate building models with higher LOD to a DTM with lower accuracy or resolution.

This approach interacts with the concept of _TerrainIntersectionCurves TIC_ (cf. <<scls_6-5>>). The TIC can be used like break lines to adjust the DTM to different features such as buildings, bridges, or city furnitures, and hence to ensure a consistent representation of the DTM. If necessary, a retriangulation may have to be processed. A TIC can also be derived by the individual intersection of the DTM and the corresponding feature.

_ReliefFeature_ and its _ReliefComponents_ both have an _lod_ attribute denoting the corresponding level of detail. In most cases, the LOD of a _ReliefFeature_ matches the LOD of its _ReliefComponents_. However, it is also allowed to specify a _ReliefFeature_ with a high LOD which consists of _ReliefComponents_ where some of them can have a LOD lower than that of the aggregating _ReliefFeature_. The idea is that, for example, for a LOD3 scene it might be sufficient to use a regular grid in LOD2 with certain higher precision areas defined by _ReliefComponents_ in LOD3. The LOD2 grid and the LOD3 components can easily be integrated using the concept of the validity extent polygon. Therefore, although some of the _ReliefComponents_ would have been classified to a lower LOD, the whole _ReliefFeature_ would be appropriate to use with other LOD3 models which is indicated by setting its _lod_ value to 3.

*XML namespace*

The XML namespace of the CityGML _Relief_ module is identified by the Uniform Resource Identifier (URI) http://www.opengis.net/citygml/relief/2.0. Within the XML Schema definition of the _Relief_ module, this URI is also used to identify the default namespace.

[[scls_10-2-1]]
==== Relief feature and relief component

.ReliefFeatureType, ReliefFeature
[source%unnumbered,xml]
----
<xs:complexType name="ReliefFeatureType">
	<xs:complexContent>
		<xs:extension base="core:AbstractCityObjectType">
			<xs:sequence>
				<xs:element name="lod" type="core:integerBetween0and4"/>
				<xs:element name="reliefComponent" type="ReliefComponentPropertyType" maxOccurs="unbounded"/>
				<xs:element ref="_GenericApplicationPropertyOfReliefFeature" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="ReliefFeature" type="ReliefFeatureType" substitutionGroup="core:_CityObject"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfReliefFeature" type="xs:anyType" abstract="true"/>
<!-- ========================================================================================= -->
<xs:complexType name="ReliefComponentPropertyType">
	<xs:sequence minOccurs="0">
		<xs:element ref="_ReliefComponent"/>
	</xs:sequence>
	<xs:attributeGroup ref="gml:AssociationAttributeGroup"/>
</xs:complexType>
----


.AbstractReliefComponentType, _ReliefComponent
[source%unnumbered,xml]
----
<xs:complexType name="AbstractReliefComponentType" abstract="true">
	<xs:complexContent>
		<xs:extension base="core:AbstractCityObjectType">
			<xs:sequence>
				<xs:element name="lod" type="core:integerBetween0and4"/>
				<xs:element name="extent" type="gml:PolygonPropertyType" minOccurs="0"/>
				<xs:element ref="_GenericApplicationPropertyOfReliefComponent" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="_ReliefComponent" type="AbstractReliefComponentType" abstract="true" substitutionGroup="core:_CityObject"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfReliefComponent" type="xs:anyType" abstract="true"/>
----


[[scls_10-2-2]]
==== TIN relief

.TINReliefType, TINRelief
[source%unnumbered,xml]
----
<xs:complexType name="TINReliefType">
	<xs:complexContent>
		<xs:extension base="AbstractReliefComponentType">
			<xs:sequence>
				<xs:element name="tin" type="tinPropertyType"/>
				<xs:element ref="_GenericApplicationPropertyOfTinRelief" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="TINRelief" type="TINReliefType" substitutionGroup="_ReliefComponent"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfTinRelief" type="xs:anyType" abstract="true"/>
<!-- ========================================================================================= -->
<xs:complexType name="tinPropertyType">
	<xs:sequence minOccurs="0">
		<xs:element ref="gml:TriangulatedSurface"/>
	</xs:sequence>
	<xs:attributeGroup ref="gml:AssociationAttributeGroup"/>
</xs:complexType>

----

The geometry of a _TINRelief_ is defined by the GML geometry class _gml:TriangulatedSurface_. This allows either the explicit provision of a set of triangles (_gml:TriangulatedSurface_) or specifying of only the control points, break and stop lines using the subclass _gml:Tin_ of _gml:TriangulatedSurface_. In the latter case, an application that processes an instance document containing a _gml:Tin_ has to reconstruct the triangulated surface by the application of a constrained Delaunay triangulation algorithm (cf. Okabe et al. 1992).



[[scls_10-2-3]]
==== Raster relief

.RasterReliefType, RasterRelief, Elevation
[source%unnumbered,xml]
----
<xs:complexType name="RasterReliefType">
	<xs:complexContent>
		<xs:extension base="AbstractReliefComponentType">
			<xs:sequence>
				<xs:element name="grid" type="gridPropertyType"/>
				<xs:element ref="_GenericApplicationPropertyOfRasterRelief" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="RasterRelief" type="RasterReliefType" substitutionGroup="_ReliefComponent"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfRasterRelief" type="xs:anyType" abstract="true"/>
<!-- ========================================================================================= -->
<!-- ========================================================================================= -->
<xs:complexType name="gridPropertyType">
	<xs:sequence minOccurs="0">
		<xs:element ref="gml:RectifiedGridCoverage"/>
	</xs:sequence>
	<xs:attributeGroup ref="gml:AssociationAttributeGroup"/>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="Elevation" type="gml:LengthType" substitutionGroup="gml:_Object"/>
----


[[scls_10-2-4]]
==== Mass point relief

.MassPointReliefType, MassPointRelief
[source%unnumbered,xml]
----
<xs:complexType name="MassPointReliefType">
	<xs:complexContent>
		<xs:extension base="AbstractReliefComponentType">
			<xs:sequence>
				<xs:element name="reliefPoints" type="gml:MultiPointPropertyType"/>
				<xs:element ref="_GenericApplicationPropertyOfMassPointRelief" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="MassPointRelief" type="MassPointReliefType" substitutionGroup="_ReliefComponent"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfMassPointRelief" type="xs:anyType" abstract="true"/>
----


[[scls_10-2-5]]
==== Breakline relief

.BreaklineReliefType, BreaklineRelief
[source%unnumbered,xml]
----
<xs:complexType name="BreaklineReliefType">
	<xs:complexContent>
		<xs:extension base="AbstractReliefComponentType">
			<xs:sequence>
				<xs:element name="ridgeOrValleyLines" type="gml:MultiCurvePropertyType" minOccurs="0"/>
				<xs:element name="breaklines" type="gml:MultiCurvePropertyType" minOccurs="0"/>
				<xs:element ref="_GenericApplicationPropertyOfBreaklineRelief" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="BreaklineRelief" type="BreaklineReliefType" substitutionGroup="_ReliefComponent"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfBreaklineRelief" type="xs:anyType" abstract="true"/>
----

The geometry of a _BreaklineRelief_ can be composed of break lines and ridge/valley lines. Whereas break lines indicate abrupt changes of terrain slope, ridge/valley lines in addition mark a change of the sign of the terrain slope gradient. A _BreaklineRelief_ must have at least one of the two properties.

[[scls_10-2-6]]
==== Conformance requirements

*Base requirements*

. The _gml:Polygon_ geometry element describing the extent of validity of a &#95;__ReliefComponent__ element using the _extent_ property (type: _gml:PolygonPropertyType_) of &#95;__ReliefComponent__ shall be given as 2D footprint polygon which may have inner holes.


*Referential integrity*

[start=2]
. The _reliefComponent_ property (type: _ReliefComponentPropertyType_) of the element _ReliefFeature_ may contain a &#95;__ReliefComponent__ element inline or an XLink reference to a remote &#95;__ReliefComponent__ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _reliefComponent_ property may only point to a remote &#95;__ReliefComponent__ element (where remote &#95;__ReliefComponent__ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _tin_ property (type: _tinPropertyType_) of the element _TINRelief_ may contain a _gml:TriangulatedSurface_ element inline or an XLink reference to a remote _gml:TriangulatedSurface_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _tin_ property may only point to a remote _gml:TriangulatedSurface_ element (where remote _gml:TriangulatedSurface_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _grid_ property (type: _gridPropertyType_) of the element _RasterRelief_ may contain a _gml:RectifiedGridCoverage_ element inline or an XLink reference to a remote _gml:RectifiedGridCoverage_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _grid_ property may only point to a remote _gml:RectifiedGridCoverage_ element (where remote _gml:RectifiedGridCoverage_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.



[[scls_10-3]]
=== Building model

The building model is one of the most detailed thematic concepts of CityGML. It allows for the representation of thematic and spatial aspects of buildings and building parts in five levels of detail, LOD0 to LOD4. The building model of CityGML is defined by the thematic extension module _Building_ (cf. <<cls_7>>). <<fig_26>> provides examples of 3D city and building models in LOD1 – 4.


[[fig_26]]
.Examples for city or building models in LOD1 (upper left), LOD2 (upper right), LOD3 (lower left), and LOD4 (lower right) (source: District of Recklinghausen, m-g-h ingenieure+architekten GmbH).
image::055.png["",600,600]




The UML diagram of the building model is depicted in <<fig_27>>, for the XML schema definition see <<a_A-4>> and below. The pivotal class of the model is &#95;__AbstractBuilding__, which is a subclass of the thematic class &#95;__Site__ (and transitively of the root class &#95;__CityObject__). &#95;__AbstractBuilding__ is specialised either to a _Building_ or to a _BuildingPart_. Since an &#95;__AbstractBuilding__ consists of _BuildingParts_, which again are &#95;__AbstractBuildings__, an aggregation hierarchy of arbitrary depth may be realised. As subclass of the root class &#95;__CityObject__, an &#95;__AbstractBuilding__ inherits all properties from &#95;__CityObject__ like the GML3 standard feature properties (_gml:name_ etc.) and the CityGML specific properties like _ExternalReferences_ (cf. <<scls_6-7>>). Further properties not explicitly covered by &#95;__AbstractBuilding__ may be modelled as _generic attributes_ provided by the CityGML _Generics_ module (cf. <<scls_10-12>>) or using the CityGML Application Domain Extension mechanism (cf. <<scls_10-13>>).

Building complexes, which consist of a number of distinct buildings like a factory site or hospital complex, should be aggregated using the concept of _CityObjectGroups_ (cf. <<scls_6-8>>). The main building of the complex can be denoted by providing "main building" as the role name of the corresponding group member.

Both classes _Building_ and _BuildingPart_ inherit the attributes of &#95;__AbstractBuilding__: the class of the building, the function (e.g. residential, public, or industry), the usage, the year of construction, the year of demolition, the roof type, the measured height, and the number and individual heights of the storeys above and below ground. This set of parameters is suited for roughly reconstructing the three-dimensional shape of a building and can be provided by cadastral systems. Furthermore, _Address_ features can be assigned to _Buildings_ or _BuildingParts_.

[[fig_27]]
.UML diagram of CityGML's building model. Prefixes are used to indicate XML namespaces associated with model elements. Element names without a prefix are defined within the CityGML _Building_ module.
image::057a.png["",740,843]



The geometric representation and semantic structure of an &#95;__AbstractBuilding__ is shown in <<fig_27>>. The model is successively refined from LOD0 to LOD4. Therefore, not all components of a building model are represented equally in each LOD and not all aggregation levels are allowed in each LOD. In CityGML, all object classes are associated to the LODs with respect to the proposed minimum acquisition criteria for each LOD (cf. <<scls_6-2>>). An object can be represented simultaneously in different LODs by providing distinct geometries for the corresponding LODs.

In LOD0, the building can be represented by horizontal, 3-dimensional surfaces. These can represent the footprint of the building and, separately, the roof edge. This allows the easy integration of 2D data into the model. In many countries these 2D geometries readily exist, for example in cadastral or topographic data holdings. Cadastre data typically depicts the shape of the building on the ground (footprints) and topographic data is often a mixture between footprints and geometries at roof level (roof edges), which are often photogrametrically extracted from area/satellite images or derived from airborne laser data. The building model allows the inclusion of both. In this case large overhanging roofs can be modelled as a preliminary stage to more detailed LOD2 and LOD3 depictions. The surface geometries require 3D coordinates, though it is mandated that the height values of all vertices belonging to the same surface are identical. If 2D geometries are imported into any of these two LOD0 geometries, an appropriate height value for all vertices needs to be chosen. The footprint is typically located at the lowest elevation of the ground surface of the building whereas the roof edge representation should be placed at roof level (e.g., eaves height).

In LOD1, a building model consists of a generalized geometric representation of the outer shell. Optionally, a _gml:MultiCurve_ representing the _TerrainIntersectionCurve_ (cf. <<scls_6-5>>) can be specified. This geometric representation is refined in LOD2 by additional _gml:MultiSurface_ and _gml:MultiCurve_ geometries, used for modelling architectural details like roof overhangs, columns, or antennas. In LOD2 and higher LODs the outer facade of a building can also be differentiated semantically by the classes &#95;__BoundarySurface__ and _BuildingInstallation_. A &#95;__BoundarySurface__ is a part of the building's exterior shell with a special function like wall (_WallSurface_), roof (_RoofSurface_), ground plate (_GroundSurface_), outer floor (_OuterFloorSurface_), outer ceiling (_OuterCeilingSurface_) or _ClosureSurface_. The _BuildingInstallation_ class is used for building elements like balconies, chimneys, dormers or outer stairs, strongly affecting the outer appearance of a building. A _BuildingInstallation_ may have the attributes _class_, _function_, and _usage_ (cf. <<fig_27>>).

In LOD3, theopenings in &#95;__BoundarySurface__ objects (doors and windows) can be represented as thematic objects. In LOD4, the highest level of resolution, also the interior of a building, composed of several rooms, is represented in the building model by the class _Room_. This enlargement allows a virtual accessibility of buildings, e.g. for visitor information in a museum ("Location Based Services"), the examination of accommodation standards or the presentation of daylight illumination of a building. The aggregation of rooms according to arbitrary, user defined criteria (e.g. for defining the rooms corresponding to a certain storey) is achieved by employing the general grouping concept provided by CityGML (cf. <<scls_10-3-6>>). Interior installations of a building, i.e. objects within a building which (in contrast to furniture) cannot be moved, are represented by the class _IntBuildingInstallation_. If an installation is attached to a specific room (e.g. radiators or lamps), they are associated with the _Room_ class, otherwise (e.g. in case of rafters or pipes) with &#95;__AbstractBuilding__. A _Room_ may have the attributes _class_, _function_ and _usage_ whose value can be defined in code lists (<<scls_10-3-8>> and <<a_C-1>>). The _class_ attribute allows a classification of rooms with respect to the stated function, e.g. commercial or private rooms, and occurs only once. The _function_ attribute is intended to express the main purpose of the room, e.g. living room, kitchen. The attribute _usage_ can be used if the way the object is actually used differs from the function. Both attributes can occur multiple times.

The visible surface of a room is represented geometrically as a _Solid_ or _MultiSurface_. Semantically, the surface can be structured into specialised &#95;__BoundarySurfaces__, representing floor (_FloorSurface_), ceiling (_CeilingSurface_), and interior walls (_InteriorWallSurface_). Room furniture, like tables and chairs, can be represented in the CityGML building model with the class _BuildingFurniture_. A _BuildingFurniture_ may have the attributes _class_, _function_ and _usage_. Annexes G.1 to G.6 provide example CityGML documents containing a single building model which is subsequently refined from a coarse LOD0 representation up to a semantically rich and geometric-topologically sound LOD4 model including the building interior.

*XML namespace* 

The XML namespace of the CityGML _Building_ module is identified by the Uniform Resource Identifier (URI) http://www.opengis.net/citygml/building/2.0. Within the XML Schema definition of the _Building_ module, this URI is also used to identify the default namespace.

[[scls_10-3-1]]
==== Building and building part

.BuildingType, Building
[source%unnumbered,xml]
----
<xs:complexType name="BuildingType">
	<xs:complexContent>
		<xs:extension base="AbstractBuildingType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfBuilding" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="Building" type="BuildingType" substitutionGroup="_AbstractBuilding"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfBuilding" type="xs:anyType" abstract="true"/>
----

The _Building_ class is one of the two subclasses of &#95;__AbstractBuilding__. If a building only consists of one (homogeneous) part, this class shall be used. A building composed of structural segments differing in, for example the number of storeys or the roof type has to be separated into one _Building_ having one or more additional _BuildingPart_ (see <<fig_28>>). The geometry and non-spatial properties of the central part of the building should be represented in the aggregating _Building_ feature.

.BuildingPartType, BuildingPart
[source%unnumbered,xml]
----
<xs:complexType name="BuildingPartType">
	<xs:complexContent>
		<xs:extension base="AbstractBuildingType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfBuildingPart" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="BuildingPart" type="BuildingPartType" substitutionGroup="_AbstractBuilding"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfBuildingPart" type="xs:anyType" abstract="true"/>
----

The class _BuildingPart_ is derived from &#95;__AbstractBuilding__. It is used to model a structural part of a building (see <<fig_28>>). A _BuildingPart_ object should be uniquely related to exactly one building or building part object.

[[fig_28]]
.Examples of buildings consisting of one and two building parts (source: City of Coburg).
image::058.gif[Shape1]


.AbstractBuildingType, _AbstractBuilding
[source%unnumbered,xml]
----
<xs:complexType name="AbstractBuildingType" abstract="true">
    <xs:complexContent>
        <xs:extension base="core:AbstractSiteType">
            <xs:sequence>
                <xs:element name="class" type="gml:CodeType" minOccurs="0"/>
                <xs:element name="function" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
                <xs:element name="usage" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
                <xs:element name="yearOfConstruction" type="xs:gYear" minOccurs="0"/>
                <xs:element name="yearOfDemolition" type="xs:gYear" minOccurs="0"/>
                <xs:element name="roofType" type="gml:CodeType" minOccurs="0"/>
                <xs:element name="measuredHeight" type="gml:LengthType" minOccurs="0"/>
                <xs:element name="storeysAboveGround" type="xs:nonNegativeInteger" minOccurs="0"/>
                <xs:element name="storeysBelowGround" type="xs:nonNegativeInteger" minOccurs="0"/>
                <xs:element name="storeyHeightsAboveGround" type="gml:MeasureOrNullListType" minOccurs="0"/>
                <xs:element name="storeyHeightsBelowGround" type="gml:MeasureOrNullListType" minOccurs="0"/>
                <xs:element name="lod0FootPrint" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
                <xs:element name="lod0RoofEdge" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
                <xs:element name="lod1Solid" type="gml:SolidPropertyType" minOccurs="0"/>
                <xs:element name="lod1MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
                <xs:element name="lod1TerrainIntersection" type="gml:MultiCurvePropertyType" minOccurs="0"/>
                <xs:element name="lod2Solid" type="gml:SolidPropertyType" minOccurs="0"/>
                <xs:element name="lod2MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
                <xs:element name="lod2MultiCurve" type="gml:MultiCurvePropertyType" minOccurs="0"/>
                <xs:element name="lod2TerrainIntersection" type="gml:MultiCurvePropertyType" minOccurs="0"/>
                <xs:element name="outerBuildingInstallation" type="BuildingInstallationPropertyType" minOccurs="0" 
                                        maxOccurs="unbounded"/>
                <xs:element name="interiorBuildingInstallation" type="IntBuildingInstallationPropertyType" minOccurs="0" 
                                        maxOccurs="unbounded"/>
                <xs:element name="boundedBy" type="BoundarySurfacePropertyType" minOccurs="0" maxOccurs="unbounded"/>
                <xs:element name="lod3Solid" type="gml:SolidPropertyType" minOccurs="0"/>
                <xs:element name="lod3MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
                <xs:element name="lod3MultiCurve" type="gml:MultiCurvePropertyType" minOccurs="0"/>
                <xs:element name="lod3TerrainIntersection" type="gml:MultiCurvePropertyType" minOccurs="0"/>
                <xs:element name="lod4Solid" type="gml:SolidPropertyType" minOccurs="0"/>
                <xs:element name="lod4MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
                <xs:element name="lod4MultiCurve" type="gml:MultiCurvePropertyType" minOccurs="0"/>
                <xs:element name="lod4TerrainIntersection" type="gml:MultiCurvePropertyType" minOccurs="0"/>
                <xs:element name="interiorRoom" type="InteriorRoomPropertyType" minOccurs="0" maxOccurs="unbounded"/>
                <xs:element name="consistsOfBuildingPart" type="BuildingPartPropertyType" minOccurs="0" maxOccurs="unbounded"/>
                <xs:element name="address" type="core:AddressPropertyType" minOccurs="0" maxOccurs="unbounded"/>
                <xs:element ref="_GenericApplicationPropertyOfAbstractBuilding" minOccurs="0" maxOccurs="unbounded"/>
            </xs:sequence>
        </xs:extension>
    </xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="_AbstractBuilding" type="AbstractBuildingType" abstract="true" substitutionGroup="core:_Site"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfAbstractBuilding" type="xs:anyType" abstract="true"/>
----

The abstract class &#95;__AbstractBuilding__ contains properties for building attributes, purely geometric representations, and geometric/semantic representations of the building or building part in different levels of detail. The attributes describe:

[type=a]
. The classification of the building or building part (_class_), the different intended usages (_function_), and the different actual usages (_usage_). The permitted values for these attributes can be specified in code lists.
. The year of construction (_yearOfConstruction_) and the year of demolition (_yearOfDemolition_) of the building or building part. These attributes can be used to describe the chronology of the building development within a city model. The points of time refer to real world time.
. The roof type of the building or building part (_roofType_). The permitted values for this attribute can be specified in a code list.
. The measured relative height (_measuredHeight_) of the building or building part.
. The number of storeys above (_storeyAboveGround_) and below (_storeyBelowGround_) ground level.
. The list of storey heights above (_storeyHeightsAboveGround_) and below (_storeyHeightsBelowGround_) ground level. The first value in a list denotes the height of the nearest storey wrt. to the ground level and last value the height of the farthest.

Spanning the different levels of detail, the building model differs in the complexity and granularity of the geometric representation and the thematic structuring of the model into components with a special semantic meaning. This is illustrated in <<fig_29>> and <<fig_30>>, showing the same building in five different LODs. The class &#95;__AbstractBuilding__ has a number of properties which are associated with certain LODs.


[[fig_29]]
.The two possibilities of modeling a building in LOD0 using horizontal 3D surfaces. On the left, the building footprint (_lod0FootPrint_) is shown (cyan)which denotes the shape of the building on the ground. The corresponding surface representation is located at ground level.On the right, the _lod0RoofEgde_ representation is illustrated (cyan) which results from a horizontal projection of the building's roof and which is located at the eaves height (source: Karlsruhe Institute of Technology (KIT), courtesy of Franz-Josef Kaiser).
image::060.png[]



[[fig_30]]
.Building model in LOD1 – LOD4 (source: Karlsruhe Institute of Technology (KIT), courtesy of Franz-Josef Kaiser).
image::062.png["",620,620]



<<tab_5>> shows the correspondence of the different geometric and semantic themes of the building model to LODs. In LOD1 – 4, the volume of a building can be expressed by a _gml:Solid_ geometry and/or a _gml:MultiSurface_ geometry. The definition of a 3D Terrain Intersection Curve (TIC), used to integrate buildings from different sources with the Digital Terrain Model, is also possible in LOD1 – 4. The TIC can – but does not have to – build closed rings around the building or building parts.

In LOD0 (cf. <<fig_29>>) the building is represented by horizontal surfaces describing the footprint and the roof edge.

In LOD1 (cf. <<fig_30>>), the different structural entities of a building are aggregated to a simple block and not differentiated in detail. The volumetric and surface parts of the exterior building shell are identical and only one of the corresponding properties (_lod1Solid_ or _lod1MultiSurface_) must be used.

In LOD2 and higher levels of detail, the exterior shell of a building is not only represented geometrically as _gml:Solid_ geometry and/or a _gml:MultiSurface_ geometry, but it can also be composed of semantic objects. The base class for all objects semantically structuring the building shell is &#95;__BoundarySurface__ (cf. <<scls_10-3-2>>), which is associated with a _gml:MultiSurface_ geometry. If in a building model there is both a geometric representation of the exterior shell as volume or surface model and a semantic representation by means of thematic &#95;__BoundarySurfaces__, the geometric representation must not explicitly define the geometry, but has to reference the corresponding geometry components of the _gml:MultiSurface_ of the &#95;__BoundarySurface__ elements.


[[tab_5]]
.Semantic themes of the class __AbstractBuilding._
[cols="<,<,^,^,^,^,^",width=769]
|===
h| Geometric / semantic theme h| Property type h| LOD0 h| LOD1 h| LOD2 h| LOD3 h| LOD4
| Building footprint and roof edge | _gml:MultiSurfaceType_ | • a| a| a| a| 
| Volume part of the building shell | _gml:SolidType_ a| | • | • | • | •
| Surface part of the building shell | _gml:MultiSurfaceType_ a| | • | • | • | •
| Terrain intersection curve | _gml:MultiCurveType_ a| | • | • | • | •
| Curve part of the building shell | _gml:MultiCurveType_ a| a| | • | • | •
| Building parts | _BuildingPartType_ a| | • | • | • | •
| Boundary surfaces (<<scls_10-3-3>>) | _AbstractBoundarySurfaceType_ a| a| | • | • | •
| Outer building installations (<<scls_10-3-2>>) | _BuildingInstallationType_ a| a| | • | • | •
| Openings (<<scls_10-3-4>>) | _AbstractOpeningType_ a| a| a| | • | •
| Rooms (<<scls_10-3-5>>) | _RoomType_ a| a| a| a| | •
| Interior building installations (<<scls_10-3-5>>) | _IntBuildingInstallationType_ a| a| a| a| | •
|===

Apart from _BuildingParts_, smaller features of the building ("outer building installations") can also strongly affect the building characteristic. These features are modelled by the class _BuildingInstallation_ (cf. <<scls_10-3-2>>). Typical candidates for this class are chimneys (see. <<fig_30>>), dormers (see <<fig_28>>), balconies, outer stairs, or antennas. _BuildingInstallations_ may only be included in LOD2 models, if their extents exceed the proposed minimum dimensions as specified in <<scls_6-2>>. For the geometrical representation of the class _BuildingInstallation_, an arbitrary geometry object from the GML subset shown in <<fig_9>> can be used.

The class &#95;__AbstractBuilding__ has no additional properties for LOD3. Besides the higher requirements on geometric precision and smaller minimum dimensions, the main difference of LOD2 and LOD3 buildings concerns the class &#95;__BoundarySurface__ (cf. <<scls_10-3-3>>). In LOD3, openings in a building corresponding with windows or doors (see <<fig_30>>) are modelled by the abstract class &#95;__Opening__ and the derived subclasses _Window_ and _Door_ (cf. <<scls_10-3-4>>).

With respect to the exterior building shell, the LOD4 data model is identical to that of LOD3. But LOD4 provides the possibility to model the interior structure of a building with the classes _IntBuildingInstallation_ and _Room_ (cf. <<scls_10-3-5>>).

Each _Building_ or _BuildingPart_ feature may be assigned zero or more addresses using the _address_ property. The corresponding _AddressPropertyType_ is defined within the CityGML core module (cf. <<scls_10-1-4>>).


[[scls_10-3-2]]
==== Outer building installations

.BuildingInstallationType, BuildingInstallation
[source%unnumbered,xml]
----
<xs:complexType name="BuildingInstallationType">
	<xs:complexContent>
		<xs:extension base="core:AbstractCityObjectType">
			<xs:sequence>
				<xs:element name="class" type="gml:CodeType" minOccurs="0"/>
				<xs:element name="function" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="usage" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="lod2Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod3Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod4Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod2ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element name="lod3ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element name="lod4ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element name="boundedBy" type="BoundarySurfacePropertyType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element ref="_GenericApplicationPropertyOfBuildingInstallation" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="BuildingInstallation" type="BuildingInstallationType" substitutionGroup="core:_CityObject"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfBuildingInstallation" type="xs:anyType" abstract="true"/>
----

A _BuildingInstallation_ is an outer component of a building which has not the significance of a _BuildingPart_, but which strongly affects the outer characteristic of the building. Examples are chimneys, stairs, antennas, balconies or attached roofs above stairs and paths. A _BuildingInstallation_ optionally has attributes _class_, _function_ and _usage_. The attribute _class -_ which can only occur once - represents a general classification of the installation. With the attributes _function_ and _usage_, nominal and real functions of a building installation can be described. For all three attributes the list of feasible values can be specified in a code list. For the geometrical representation of a _BuildingInstallation_, an arbitrary geometry object from the GML subset shown in <<fig_9>> can be used. Alternatively, the geometry may be given as _ImplicitGeometry_ object. Following the concept of _ImplicitGeometry_ the geometry of a prototype building installation is stored only once in a local coordinate system and referenced by other building installation features (see <<scls_8-2>>). The visible surfaces of a building installation can be semantically classified using the concept of boundary surfaces (cf. <<scls_10-3-3>>). A _BuildingInstallation_ object should be uniquely related to exactly one building or building part object.

[[scls_10-3-3]]
==== Boundary surfaces

.AbstractBoundarySurfaceType, _BoundarySurface
[source%unnumbered,xml]
----
<xs:complexType name="AbstractBoundarySurfaceType" abstract="true">
	<xs:complexContent>
		<xs:extension base="core:AbstractCityObjectType">
			<xs:sequence>
				<xs:element name="lod2MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod3MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod4MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="opening" type="OpeningPropertyType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element ref="_GenericApplicationPropertyOfBoundarySurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:element name="_BoundarySurface" type="AbstractBoundarySurfaceType" abstract="true" substitutionGroup="core:_CityObject"/>
<!-- ========================================================================================== -->
<xs:element name="_GenericApplicationPropertyOfBoundarySurface" type="xs:anyType" abstract="true"/>
----

&#95;__BoundarySurface__ is the abstract base class for several thematic classes, structuring the exterior shell of a building as well as the visible surfaces of rooms and both outer and interior building installations. It is a subclass of &#95;__CityObject__ and thus inherits all properties like the GML3 standard feature properties (_gml:name_ etc.) and the CityGML specific properties like _ExternalReferences_. From &#95;__BoundarySurface__, the thematic classes _RoofSurface_, _WallSurface_, _GroundSurface_, _OuterCeilingSurface_, _OuterFloorSurface_, _ClosureSurface_, _FloorSurface_, _InteriorWallSurface_, and _CeilingSurface_ are derived. The thematic classification of building surfaces is illustrated in <<fig_31>> (outer building shell) and <<fig_32>> (additional interior surfaces) and subsequently specified.

For each LOD between 2 and 4, the geometry of a &#95;__BoundarySurface__ may be defined by a different _gml:MultiSurface_ geometry.

In LOD3 and LOD4, a &#95;__BoundarySurface__ may contain &#95;__Openings__ (cf. <<scls_10-3-4>>) like doors and windows. If the geometric location of &#95;__Openings__ topologically lies within a surface component (e.g. _gml:Polygon_) of the _gml:MultiSurface_ geometry, these &#95;__Openings__ must be represented as holes within that surface. A hole is represented by an interior ring within the corresponding surface geometry object. According to GML3, the points have to be specified in reverse order (exterior boundaries counter-clockwise and interior boundaries clockwise when looking in opposite direction of the surface's normal vector). If such an opening is sealed by a _Door_, a _Window_, or a _ClosureSurface_, their outer boundary may consist of the same points as the inner ring (denoting the hole) of the surrounding surface. The embrasure surfaces of an _Opening_ belong to the relevant adjacent &#95;__BoundarySurface__. If, for example a door seals the _Opening_, the embrasure surface on the one side of the door belongs to the _InteriorWallSurface_ and on the other side to the _WallSurface_ (<<fig_32>> on the right).

[[fig_31]]
.Examples of the classification of &#95;__BoundarySurfaces__ of the outer building shell (source: Karlsruhe Institute of Technology (KIT))
image::074.png["",709,359]

[[fig_32]]
.Classification of _BoundarySurfaces_ (left), in particular for _Openings_ (right) (graphic: IGG Uni Bonn).
image::075.png["",659,282]



.GroundSurfaceType, GroundSurface
[source%unnumbered,xml]
----
<xs:complexType name="GroundSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfGroundSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="GroundSurface" type="GroundSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfGroundSurface" type="xs:anyType" abstract="true"/>
----

The ground plate of a building or building part is modelled by the class _GroundSurface_. The polygon defining the ground plate is congruent with the building's footprint. However, the surface normal of the ground plate is pointing downwards.

.OuterCeilingSurfaceType, OuterCeilingSurface
[source%unnumbered,xml]
----
<xs:complexType name="OuterCeilingSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfOuterCeilingSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:element name="OuterCeilingSurface" type="OuterCeilingSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================== -->
<xs:element name="_GenericApplicationPropertyOfOuterCeilingSurface" type="xs:anyType" abstract="true"/>
----

A mostly horizontal surface belonging to the outer building shell and having the orientation pointing downwards can be modeled as an _OuterCeilingSurface_. Examples are the visible part of the ceiling of a loggia or the ceiling of a passage.

.WallSurfaceType, WallSurface
[source%unnumbered,xml]
----
<xs:complexType name="WallSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfWallSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="WallSurface" type="WallSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfWallSurface" type="xs:anyType" abstract="true"/>
----

All parts of the building facade belonging to the outer building shell can be modelled by the class _WallSurface_.

.OuterFloorSurfaceType, OuterFloorSurface
[source%unnumbered,xml]
----
<xs:complexType name="OuterFloorSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfOuterFloorSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:element name="OuterFloorSurface" type="OuterFloorSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================== -->
<xs:element name="_GenericApplicationPropertyOfOuterFloorSurface" type="xs:anyType" abstract="true"/>
----

A mostly horizontal surface belonging to the outer building shell and with the orientation pointing upwards can be modeled as an _OuterFloorSurface_. An example is the floor of a loggia.

.RoofSurfaceType, RoofSurface
[source%unnumbered,xml]
----
<xs:complexType name="RoofSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfRoofSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:element name="RoofSurface" type="RoofSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================== -->
<xs:element name="_GenericApplicationPropertyOfRoofSurface" type="xs:anyType" abstract="true"/>
----

The major roof parts of a building or building part are expressed by the class _RoofSurface_. Secondary parts of a roof with a specific semantic meaning like dormers or chimneys should be modelled as _BuildingInstallation_.

.ClosureSurfaceType, ClosureSurface
[source%unnumbered,xml]
----
<xs:complexType name="ClosureSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfClosureSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="ClosureSurface" type="ClosureSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfClosureSurface" type="xs:anyType" abstract="true"/>
----

An opening in a building not filled by a door or window can be sealed by a virtual surface called _ClosureSurface_ (cf. <<scls_6-4>>). Hence, buildings with open sides like a barn or a hangar, can be virtually closed in order to be able to compute their volume. _ClosureSurfaces_ are also used in the interior building model. If two rooms with a different function (e.g. kitchen and living room) are directly connected without a separating door, a _ClosureSurface_ should be used to separate or connect the volumes of both rooms.

.FloorSurfaceType, FloorSurface
[source%unnumbered,xml]
----
<xs:complexType name="FloorSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfFloorSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="FloorSurface" type="FloorSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfFloorSurface" type="xs:anyType" abstract="true"/>
----

The class _FloorSurface_ must only be used in the LOD4 interior building model for modelling the floor of a room.

.InteriorWallSurfaceType, InteriorWallSurface
[source%unnumbered,xml]
----
<xs:complexType name="FloorSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfFloorSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="FloorSurface" type="FloorSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfFloorSurface" type="xs:anyType" abstract="true"/>
----

The class _InteriorWallSurface_ must only be used in the LOD4 interior building model for modelling the visible surfaces of the room walls.

.CeilingSurfaceType, CeilingSurface
[source%unnumbered,xml]
----
<xs:complexType name="CeilingSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfCeilingSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="CeilingSurface" type="CeilingSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfCeilingSurface" type="xs:anyType" abstract="true"/>
----

The class _CeilingSurface_ must only be used in the LOD4 interior building model for modelling the ceiling of a room.

[[scls_10-3-4]]
==== Openings

.AbstractOpeningType, _Opening
[source%unnumbered,xml]
----
<xs:complexType name="CeilingSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfCeilingSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="CeilingSurface" type="CeilingSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfCeilingSurface" type="xs:anyType" abstract="true"/>
----

The class &#95;__Opening__ is the abstract base class for semantically describing openings like doors or windows in outer or inner boundary surfaces like walls and roofs. Openings only exist in models of LOD3 or LOD4. Each &#95;__Opening__ is associated with a _gml:MultiSurface_ geometry. Alternatively, the geometry may be given as _ImplicitGeometry_ object. Following the concept of _ImplicitGeometry_ the geometry of a prototype opening is stored only once in a local coordinate system and referenced by other opening features (see <<scls_8-2>>).

.WindowType, Window
[source%unnumbered,xml]
----
<xs:complexType name="WindowType">
	<xs:complexContent>
		<xs:extension base="AbstractOpeningType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfWindow" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="Window" type="WindowType" substitutionGroup="_Opening"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfWindow" type="xs:anyType" abstract="true"/>
----

The class _Window_ is used for modelling windows in the exterior shell of a building, or hatches between adjacent rooms. The formal difference between the classes _Window_ and _Door_ is that – in normal cases – _Windows_ are not specifically intended for the transit of people or vehicles.

.DoorType, Door
[source%unnumbered,xml]
----
<xs:complexType name="DoorType">
	<xs:complexContent>
		<xs:extension base="AbstractOpeningType">
			<xs:sequence>
				<xs:element name="address" type="core:AddressPropertyType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element ref="_GenericApplicationPropertyOfDoor" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="Door" type="DoorType" substitutionGroup="_Opening"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfDoor" type="xs:anyType" abstract="true"/>
----

The class _Door_ is used for modelling doors in the exterior shell of a building, or between adjacent rooms. Doors can be used by people to enter or leave a building or room. In contrast to a _ClosureSurface_ a door may be closed, blocking the transit of people. A _Door_ may be assigned zero or more addresses. The corresponding _AddressPropertyType_ is defined within the CityGML core module (cf. <<scls_10-1-4>>) .

[[scls_10-3-5]]
==== Building interior

.RoomType, Room
[source%unnumbered,xml]
----
<xs:complexType name="RoomType">
	<xs:complexContent>
		<xs:extension base="core:AbstractCityObjectType">
			<xs:sequence>
				<xs:element name="class" type="gml:CodeType" minOccurs="0"/>
				<xs:element name="function" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="usage" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="lod4Solid" type="gml:SolidPropertyType" minOccurs="0"/>
				<xs:element name="lod4MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="boundedBy" type="BoundarySurfacePropertyType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="interiorFurniture" type="InteriorFurniturePropertyType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="roomInstallation" type="IntBuildingInstallationPropertyType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element ref="_GenericApplicationPropertyOfRoom" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="Room" type="RoomType" substitutionGroup="core:_CityObject"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfRoom" type="xs:anyType" abstract="true"/>
----

A _Room_ is a semantic object for modelling the free space inside a building and should be uniquely related to exactly one building or building part object. It should be closed (if necessary by using _ClosureSurfaces_) and the geometry normally will be described by a solid (_lod4Solid_). However, if the topological correctness of the boundary cannot be guaranteed, the geometry can alternatively be given as a _MultiSurface_ (_lod4MultiSurface_). The surface normals of the outer shell of a GML solid must point outwards. This is important to consider when _Room_ surfaces should be assigned _Appearances_. In this case, textures and colors must be placed on the backside of the corresponding surfaces in order to be visible from the inside of the room.

In addition to the geometrical representation, different parts of the visible surface of a room can be modelled by specialised _BoundarySurfaces_ (_FloorSurface_, _CeilingSurface_, _InteriorWallSurface_, and _ClosureSurface_ cf. <<scls_10-3-3>>).

A special task is the modelling of passages between adjacent rooms. The room solids are topologically connected by the surfaces representing hatches, doors or closure surfaces that seal open doorways. Rooms are defined as being adjacent, if they have common &#95;__Openings__ or _ClosureSurfaces_. The surface that represents the opening geometrically is part of the boundaries of the solids of both rooms, or the opening is referenced by both rooms on the semantic level. This adjacency implies an accessibility graph, which can be employed to determine the spread of e.g. smoke or gas, but which can also be used to compute escape routes using classical shortest path algorithms (see <<fig_33>>).

[[fig_33]]
.Accessibility graph derived from topological adjacencies of room surfaces (graphic: IGG Uni Bonn).
image::077.png["",600,500]


.BuildingFurnitureType, BuildingFurniture
[source%unnumbered,xml]
----
<xs:complexType name="BuildingFurnitureType">
	<xs:complexContent>
		<xs:extension base="core:AbstractCityObjectType">
			<xs:sequence>
				<xs:element name="class" type="gml:CodeType" minOccurs="0"/>
				<xs:element name="function" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="usage" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="lod4Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod4ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element ref="_GenericApplicationPropertyOfBuildingFurniture" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="BuildingFurniture" type="BuildingFurnitureType" substitutionGroup="core:_CityObject"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfBuildingFurniture" type="xs:anyType" abstract="true"/>
----

Rooms may have _BuildingFurnitures_ and _IntBuildingInstallations_. A _BuildingFurniture_ is a movable part of a room, such as a chair or furniture. A _BuildingFurniture_ object should be uniquely related to exactly one room object. Its geometry may be represented by an explicit geometry or an _ImplicitGeometry_ object. Following the concept of _ImplicitGeometry_ the geometry of a prototype building furniture is stored only once in a local coordinate system and referenced by other building furniture features (see <<scls_8-2>>).

.IntBuildingInstallationType, IntBuildingInstallation
[source%unnumbered,xml]
----
<xs:complexType name="IntBuildingInstallationType">
	<xs:complexContent>
		<xs:extension base="core:AbstractCityObjectType">
			<xs:sequence>
				<xs:element name="class" type="gml:CodeType" minOccurs="0"/>
				<xs:element name="function" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="usage" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="lod4Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod4ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element name="boundedBy" type="BoundarySurfacePropertyType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element ref="_GenericApplicationPropertyOfIntBuildingInstallation" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="IntBuildingInstallation" type="IntBuildingInstallationType" substitutionGroup="core:_CityObject"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfIntBuildingInstallation" type="xs:anyType" abstract="true"/>
----

An _IntBuildingInstallation_ is an object inside a building with a specialised function or semantic meaning. In contrast to _BuildingFurniture_, _IntBuildingInstallations_ are permanently attached to the building structure and cannot be moved. Typical examples are interior stairs, railings, radiators or pipes. Objects of the class _IntBuildingInstallation_ can either be associated with a room (class _Room_), or with the complete building / building part (class &#95;__AbstractBuilding__, cf. <<scls_10-3-1>>). However, they should be uniquely related to exactly one room or one building / building part object. An _IntBuildingInstallation_ optionally has attributes _class_, _function_ and _usage_. The attribute _class,_ which can only occur once, represents a general classification of the internal building component. With the attributes _function_ and _usage_, nominal and real functions of a building installation can be described. For all three attributes the list of feasible values can be specified in a code list. For the geometrical representation of an _IntBuildingInstallation_, an arbitrary geometry object from the GML subset shown in <<fig_9>> can be used. Alternatively, the geometry may be given as _ImplicitGeometry_ object. Following the concept of _ImplicitGeometry_ the geometry of a prototype interior building installation is stored only once in a local coordinate system and referenced by other interior building installation features (see <<scls_8-2>>). The visible surfaces of an interior building installation can be semantically classified using the concept of boundary surfaces (cf. <<scls_10-3-3>>).

[[scls_10-3-6]]
==== Modelling building storeys using CityObjectGroups

CityGML does currently not provide a specific concept for the representation of storeys as it is available in the AEC/FM standard IFC (IAI 2006). However, a storey can be represented as an explicit aggregation of all building features on a certain height level using CityGML's notion of _CityObjectGroups_ (cf. <<scls_10-11>>). This would include _Rooms_, _Doors_, _Windows_, _IntBuildingInstallations_ and _BuildingFurniture_. If thematic surfaces like walls and interior walls should also be associated to a specific storey, this might require the vertical fragmentation of these surfaces (one per storey), as in virtual 3D city models they typically span the whole façade.

In order to model building storeys with CityGML's generic grouping concept, a nested hierarchy of _CityObjectGroup_ objects has to be used. In a first step, all semantic objects belonging to a specific storey are grouped. The attributes of the corresponding _CityObjectGroup_ object are set as follows:

* The _class_ attribute shall be assigned the value _"building separation"_.
* The _function_ attribute shall be assigned the value _"lodXStorey"_ with X between 1 and 4 in order to denote that this group represents a storey wrt. a specific LOD.
* The storey name or number can be stored in the _gml:name_ property. The storey number attribute shall be assigned the value _"storeyNo_X"_ with decimal number X in order to denote that this group represents a storey wrt. a specific number.

In a second step, the _CityObjectGroup_ objects representing different storeys are grouped themselves. By using the generic aggregation concept of _CityObjectGroup,_ the "storeys group" is associated with the corresponding _Building_ or _BuildingPart_ object. The _class_ attribute of the storeys group shall be assigned the value _"building storeys"_.

[[scls_10-3-7]]
==== Examples

The LOD1 model of the Campus North of the Karlruhe Institute of Technology (KIT) shown in <<fig_34>> consists of 596 buildings and 187 building parts. The footprint geometries of the buildings are taken from a cadastral information system and extruded by a given height. Buildings with a unique identifier and a single height value are modeled as one building (_bldg:Building_). Buildings having a unique identifier but different height values are modeled as one building (_bldg:Building_) with one or more building parts (_bldg:BuildingPart_). Both buildings and building parts have solid geometries and their height values are additionally represented as thematic attribute (_bldg:measuredHeight_). <<fig_34>> shows an aerial photograph of the KIT Campus North (left) and the CityGML LOD1 model (right).

[[fig_34]]
.LOD1 model of the KIT Campus North (source: Karlsruhe Institute of Technology (KIT)).
image::078.png["",673,201]


An example for a fully textured LOD2 building model is given in <<fig_35>> which shows the Bernhardus church located in the city of Karlsruhe, Germany. On the left side of <<fig_35>>, a photograph of the church in real world is shown whereas the CityGML building model of the church with photorealistic textures is illustrated on the right. The model is bounded by a ground surface, several wall and roof surfaces. The railing above the church clock is modeled as a building installation (_BuildingInstallation_).

[[fig_35]]
.Textured LOD2 model of the Bernhardus church in Karlsruhe (source: Karlsruhe Institute of Technology (KIT), courtesy of City of Karlsruhe).
image::080.png["",673,322]


The model shown in <<fig_36>> was derived from a 3D CAD model generated during the planning phase of the building. On the left side of <<fig_36>>, the building is shown whereas on the right side the LOD3 model is presented. The building itself is bounded by wall surfaces, roof surfaces and a ground surface. Doors and windows are modeled including reveals. According to the cadaster data, the car port next to the building is not part of the building. Therefore the car port, the balcony and the chimney are modeled as building installations (_BuildingInstallation_). The model also contains the terrain intersection curve (_lod3TerrainIntersection_) as planned by the architect.

In order to determine the volume of the building, the geometries of all boundary surfaces, including doors and windows, are referenced by the building solid (_lod3Solid_) using the XLink mechanism. Consequently, the roof surfaces are split into surfaces representing the roof itself and surfaces representing the roof overhangs.

[[fig_36]]
.Example of a building modeled in the Level of Detail 3. The chimney, the balcony and the car port are modeled as building installations (source: Karlsruhe Institute of Technology (KIT), courtesy of Franz-Josef Kaiser).
image::082.png["",673,242]


[[scls_10-3-8]]
==== Code lists

The attributes _class_, _function_, _usage,_ and _roofType_ of the feature &#95;__AbstractBuilding__ as well as the attributes _class_, _function_ and _usage_ of the features _BuildingInstallation, Room, BuildingFurniture_ and _IntBuildingInstallation_ are specified as _gml:CodeType_. The values of these properties can be enumerated in code lists. Proposals for corresponding code lists can be found in <<a_C-1>>.


[[scls_10-3-9]]
==== Conformance requirements

*Base requirements*

. If a building only consists of one (homogeneous) part, it shall be represented by the element _Building_. However, if a building is composed of individual structural segments, it shall be modelled as a _Building_ element having one or more additional _BuildingPart_ elements. Only the geometry and non-spatial properties of the main part of the building should be represented within the aggregating _Building_ element.

===== Usage restriction of building model components according to different LODs

[start=2]
. The _gml:MultiSurface_ geometries that are associated using the _lod0FootPrint_ and _lod0RoofEdge_ properties must have 3D coordinates. For each surface, the height values of the coordinate tuples belonging to the same surface shall be identical.
. The _lodXSolid_ and _lodXMultiSurface_, stem:[X in [1..4\]], properties (_gml:SolidPropertyType_ resp. _gml:MultiSurfacePropertyType_) of &#95;__AbstractBuilding__ may be used to geometricllay represent the exterior shell of a building (as volume or surface model) within each LOD. For LOD1, either _lod1Solid_ or _lod1MultiSurface_ must be used, but not both. Starting from LOD2, both properties may be modelled individually and complementary.
. Starting from LOD2, the exterior shell of an &#95;__AbstractBuilding__ may be semantically decomposed into &#95;__BoundarySurface__ elements using the _boundedBy_ property (type: _BoundarySurfacePropertyType_) of &#95;__AbstractBuilding__. Only _RoofSurface_, _WallSurface_, _GroundSurface_, _OuterCeilingSurface_, _OuterFloorSurface_ and _ClosureSurface_ as subclasses of &#95;__BoundarySurface__ are allowed. The _boundedBy_ property (not to be confused with the _gml:boundedBy_ property) shall not be used if the building is only represented in LOD1.
+
--
If the exterior shell is represented by &#95;__BoundarySurface__ elements, an additional geometric representation as volume or surface model using the _lodXSolid_ and _lodXMultiSurface_, stem:[X in [2..4\]], properties shall not explicitly define the geometry, but has to reference the according components of the _gml:MultiSurface_ element of &#95;__BoundarySurface__ within each LOD using the XLink concept of GML 3.1.1.
--

. Starting from LOD2, curve parts of the building shell may be represented using the _lodXMultiCurve_, stem:[X in [2..4\]], property of &#95;__AbstractBuilding__. This property shall not be used if the building is only represented in LOD1.
. Starting from LOD2, the _outerBuildingInstallation_ property (type: _BuildingInstallationPropertyType_) of &#95;__AbstractBuilding__ may be used to model _BuildingInstallation_ elements. _BuildingInstallation_ elements shall only be used to represent outer characteristics of a building which do not have the significance of building parts. The _outerBuildingInstallation_ property shall not be used if the building is only represented in LOD1.
. Starting from LOD2, the geometry of _BuildingInstallation_ elements may be semantically classified by &#95;__BoundarySurface__ elements using the _boundedBy_ property (type: _BoundarySurfacePropertyType_) of _BuildingInstallation_. Only _RoofSurface_, _WallSurface_, _GroundSurface_, &#95;__OuterCeilingSurface__, _OuterFloorSurface_ and _ClosureSurface_ as subclasses of &#95;__BoundarySurface__ are allowed.
. Starting from LOD3, openings of &#95;__BoundarySurface__ elements may be modelled using the _opening_ property (type: _OpeningPropertyType_) of &#95;__BoundarySurface__. This property shall not be used for &#95;__BoundarySurface__ elements only represented in LOD2. Accordingly, the surface geometry representing a &#95;__BoundarySurface__ in LOD2 must be simply connected.

The _opening_ property of &#95;__BoundarySurface__ may contain or reference &#95;__Opening__ elements. If the geometric location of an &#95;__Opening__ element topologically lies within a surface component of the &#95;__BoundarySurface__, the opening must also be represented as inner hole of that surface. The embrasure surface of an &#95;__Opening__ element shall belong to the relevant adjacent &#95;__BoundarySurface__.

[start=9]
. Starting from LOD4, the _interiorRoom_ property (type: _InteriorRoomPropertyType_) of &#95;__AbstractBuilding__ may be used to semantically model the free space inside the building by _Room_ elements. This property shall not be used if the building is only represented in LOD 1 – 3. The _Room_ element may be geometrically represented as a surface or volume model, using its _lod4Solid_ or _lod4MultiSurface_ property (_gml:SolidPropertyType_ resp. _gml:MultiSurfacePropertyType_).
+
--
In addition, different parts of the visible surface of a room may be modelled by thematic &#95;__BoundarySurface__ elements. Only _FloorSurface_, _CeilingSurface_, _InteriorWallSurface,_ and _ClosureSurface_ as subclasses of &#95;__BoundarySurface__ are allowed. If the visible surface of a room is represented by &#95;__BoundarySurface__ elements, an additional geometric representation as volume or surface model using the _lod4Solid_ and _lod4MultiSurface_ property shall not explicitly define the geometry, but has to reference the according components of the _gml:MultiSurface_ element of &#95;__BoundarySurface__ using the XLink concept of GML 3.1.1.
--

. Starting from LOD4, the _interiorBuildingInstallation_ property (type: _IntBuildingInstallationPropertyType_) of &#95;__AbstractBuilding__ may be used to represent immovable objects inside the building that are permamently attached to the building structure. The _interiorBuildingInstallation_ property shall not be used if the building is only represented in LOD 1 – 3. Furthermore, the _interiorBuildingInstallation_ property shall only be used if the object cannot be associated with a _Room_ element. In the latter case, the _roomInstallation_ property (type: _IntBuildingInstallationPropertyType_) of the corresponding _Room_ element shall be used to represent the object.
. Starting from LOD4, the geometry of _IntBuildingInstallation_ elements may be semantically classified by &#95;__BoundarySurface__ elements using the _boundedBy_ property (type: _BoundarySurfacePropertyType_) of _IntBuildingInstallation_. Only _FloorSurface_, _CeilingSurface_, _InteriorWallSurface,_ and _ClosureSurface_ as subclasses of &#95;__BoundarySurface__ are allowed.

*Referential integrity*

[start=12]
. The _boundedBy_ property (type: _BoundarySurfacePropertyType_) of the element &#95;__AbstractBuilding__ may contain a &#95;__BoundarySurface__ element inline or an XLink reference to a remote &#95;__BoundarySurface__ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _boundedBy_ property may only point to a remote &#95;__BoundarySurface__ element (where remote &#95;__BoundarySurface__ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
+
--
Only _RoofSurface_, _WallSurface_, _GroundSurface_, _OuterCeilingSurface_, _OuterFloorSurface_ and _ClosureSurface_ elements are allowed to be encapsulated or referenced by the _boundedBy_ property of &#95;__AbstractBuilding__.
--

. The _outerBuildingInstallation_ property (type: _BuildingInstallationPropertyType_) of the element &#95;__AbstractBuilding__ may contain a _BuildingInstallation_ element inline or an XLink reference to a remote _BuildingInstallation_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _outerBuildingInstallation_ property may only point to a remote _BuildingInstallation_ element (where remote _BuildingInstallation_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none. 
. The _interiorBuildingInstallation_ property (type: _IntBuildingInstallationPropertyType_) of the element &#95;__AbstractBuilding__ may contain an _IntBuildingInstallation_ element inline or an XLink reference to a remote _IntBuildingInstallation_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _interiorBuildingInstallation_ property may only point to a remote _IntBuildingInstallation_ element (where remote _IntBuildingInstallation_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _interiorRoom_ property (type: _InteriorRoomPropertyType_) of the element &#95;__AbstractBuilding__ may contain a _Room_ element inline or an XLink reference to a remote _Room_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _interiorRoom_ property may only point to a remote _Room_ element (where remote _Room_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _consistsOfBuildingPart_ property (type: _BuildingPartPropertyType_) of the element &#95;__AbstractBuilding__ may contain a _BuildingPart_ element inline or an XLink reference to a remote _BuildingPart_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _consistsOfBuildingPart_ property may only point to a remote _BuildingPart_ element (where remote _BuildingPart_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _address_ property (type: _core:AddressPropertyType_) of the element &#95;__AbstractBuilding__ may contain an _core:Address_ element inline or an XLink reference to a remote _core:Address_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _address_ property may only point to a remote _core:Address_ element (where remote _core:Address_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _opening_ property(type: _OpeningPropertyType_) of the element &#95;__BoundarySurface__ may contain an &#95;__Opening__ element inline or an XLink reference to a remote &#95;__Opening__ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _opening_ property may only point to a remote &#95;__Opening__ element (where remote &#95;__Opening__ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _address_ property (type: _core:AddressPropertyType_) of the element _Door_ may contain an _core:Address_ element inline or an XLink reference to a remote _core:Address_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _address_ property may only point to a remote _core:Address_ element (where remote _core:Address_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _boundedBy_ property (type: _BoundarySurfacePropertyType_) of the element _BuildingInstallation_ may contain a &#95;__BoundarySurface__ element inline or an XLink reference to a remote &#95;__BoundarySurface__ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _boundedBy_ property may only point to a remote &#95;__BoundarySurface__ element (where remote &#95;__BoundarySurface__ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
+
--
Only _RoofSurface_, _WallSurface_, _GroundSurface_, _OuterCeilingSurface_, _OuterFloorSurface_ and _ClosureSurface_ elements are allowed to be encapsulated or referenced by the _boundedBy_ property of _BuildingInstallation_.
--

. The _boundedBy_ property (type: _BoundarySurfacePropertyType_) of the element _IntBuildingInstallation_ may contain a &#95;__BoundarySurface__ element inline or an XLink reference to a remote &#95;__BoundarySurface__ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _boundedBy_ property may only point to a remote &#95;__BoundarySurface__ element (where remote &#95;__BoundarySurface__ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
+
--
Only _FloorSurface_, _CeilingSurface_, _InteriorWallSurface,_ and _ClosureSurface_ elements are allowed to be encapsulated or referenced by the _boundedBy_ property of _IntBuildingInstallation_.
--
. The _boundedBy_ property (type: _BoundarySurfacePropertyType_) of the element _Room_ may contain a &#95;__BoundarySurface__ element inline or an XLink reference to a remote &#95;__BoundarySurface__ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _boundedBy_ property may only point to a remote &#95;__BoundarySurface__ element (where remote &#95;__BoundarySurface__ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
+
--
Only _FloorSurface_, _CeilingSurface_, _InteriorWallSurface,_ and _ClosureSurface_ elements are allowed to be encapsulated or referenced by the _boundedBy_ property of _Room_.
--

. The _interiorFurniture_ property(type: _InteriorFurniturePropertyType_) of the element _Room_ may contain an _BuildingFurniture_ element inline or an XLink reference to a remote _BuildingFurniture_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _interiorFurniture_ property may only point to a remote _BuildingFurniture_ element (where remote _BuildingFurniture_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _roomInstallation_ property (type: _IntBuildingInstallationPropertyType_) of the element _Room_ may contain an _IntBuildingInstallation_ element inline or an XLink reference to a remote _IntBuildingInstallation_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _roomInstallation_ property may only point to a remote _IntBuildingInstallation_ element (where remote _IntBuildingInstallation_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _lodXImplicitRepresentation_, stem:[X in [2..4\]], property (type: _core:ImplicitRepresentationPropertyType_) of the element _BuildingInstallation_ may contain a _core:ImplicitGeometry_ element inline or an XLink reference to a remote _core:ImplicitGeometry_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _lodXImplicitRepresentation_, stem:[X in [2..4\]], property may only point to a remote _core:ImplicitGeometry_ element (where remote _core:ImplicitGeometry_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _lod4ImplicitRepresentation_ property (type: _core:ImplicitRepresentationPropertyType_) of the element _IntBuildingInstallation_ may contain a _core:ImplicitGeometry_ element inline or an XLink reference to a remote _core:ImplicitGeometry_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _lod4ImplicitRepresentation_ property may only point to a remote _core:ImplicitGeometry_ element (where remote _core:ImplicitGeometry_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _lodXImplicitRepresentation_, stem:[X in [3..4\]], property (type: _core:ImplicitRepresentationPropertyType_) of the element &#95;__Opening__ may contain a _core:ImplicitGeometry_ element inline or an XLink reference to a remote _core:ImplicitGeometry_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _lodXImplicitRepresentation_, stem:[X in [3..4\]], property may only point to a remote _core:ImplicitGeometry_ element (where remote _core:ImplicitGeometry_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _lod4ImplicitRepresentation_ property (type: _core:ImplicitRepresentationPropertyType_) of the element _BuildingFurniture_ may contain a _core:ImplicitGeometry_ element inline or an XLink reference to a remote _core:ImplicitGeometry_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _lod4ImplicitRepresentation_ property may only point to a remote _core:ImplicitGeometry_ element (where remote _core:ImplicitGeometry_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.


[[scls_10-4]]
=== Tunnel model

The tunnel model is closely related to the building model. It supports the representation of thematic and spatial aspects of tunnels and tunnel parts in four levels of detail, LOD1 to LOD4. The tunnel model of CityGML is defined by the thematic extension module _Tunnel_ (cf. <<cls_7>>). <<fig_37>> provides examples of tunnel models for each LOD.


[[fig_37]]
.Examples for tunnel models in LOD1 (upper left), LOD2 (upper right), LOD3 (lower left) and LOD4 (lower right) (source: Google 3D warehouse).
image::086.png[]



The UML diagram of the tunnel model is shown in <<fig_38>>. The XML schema definition is attached in <<a_A-11>>. The pivotal class of the model is &#95;__AbstractTunnel__, which is a subclass of the thematic class &#95;__Site__ (and transitively of the root class &#95;__CityObject__). &#95;__AbstractTunnel__ is specialized either to a _Tunnel_ or to a _TunnelPart_. Since an &#95;__AbstractTunnel__ consists of _TunnelParts_, which again are ___AbstractTunnels_, an aggregation hierarchy of arbitrary depth may be realized. As subclass of the root class &#95;__CityObject__, an ___AbstractTunnel_ inherits all properties from &#95;__CityObject__ like the GML3 standard feature properties (_gml:name_ etc.) and the CityGML specific properties like _ExternalReferences_ (cf. <<scls_6-7>>). Further properties not explicitly covered by &#95;__AbstractTunnel__ may be modelled as _generic attributes_ provided by the CityGML _Generics_ module (cf. <<scls_10-12>>) or using the CityGML Application Domain Extension mechanism (cf. <<scls_10-13>>).

Both classes _Tunnel_ and _TunnelPart_ inherit the attributes of &#95;__AbstractTunnel__: the class of the tunnel, the function, the usage, the year of construction and the year of demolition. In contrast to &#95;__AbstractBuilding__, _Address_ features cannot be assigned to &#95;__AbstractTunnel__.

[[fig_38]]
.UML diagram of CityGML's tunnel model. Prefixes are used to indicate XML namespaces associated with model elements. Element names without a prefix are defined within the CityGML Tunnel module.
image::088.png[]


The geometric representation and semantic structure of an &#95;__AbstractTunnel__ is shown in <<fig_38>>. The model is successively refined from LOD1 to LOD4. Therefore, not all components of a tunnel model are represented equally in each LOD and not all aggregation levels are allowed in each LOD. In CityGML, all object classes are associated to the LODs with respect to the proposed minimum acquisition criteria for each LOD (cf. <<scls_6-2>>). An object can be represented simultaneously in different LODs by providing distinct geometries for the corresponding LODs.

Similar to the building and brigde models (cf. <<scls_10-3>> and <<scls_10-5>>), only the outer shell of a tunnel is represented in LOD1 – 3, which is composed of the tunnel's boundary surfaces to the surrounding earth, water, or outdoor air. The interior of a tunnel may only be modeled in LOD4. Although the interior built environment is especially relevant for subsurface objects like tunnels or underground buildings, CityGML employs a consistent LOD concept for all thematic modules. If, in contrast, the representation of the interior of subsurface objects would be possible in all LODs, the LOD concept for subsurface objects would have to substantially differ from the LOD concept for aboveground objects. This would require the precise definition of a "transition surface" which delimits the scope of both LOD concepts. Furthermore, features being partially above and below ground would have to be split into an above-ground part (modeled according to the aboveground LOD concept) and a subsurface part (modeled according to the subsurface LOD concept). However, such a splitting violates the CityGML concept of unity of features and would not be feasible in many cases where the transition between above and below ground is often not precisely known or depends on (the LOD of) the terrain model. Hence, CityGML applies a single and consistent LOD concept to both aboveground and subsurface objects. As a consequence, penetrations between a tunnel and objects inside this tunnel (e.g., roads and railways) may occur in LOD1 – 3.

In LOD1, a tunnel model consists of a geometric representation of the tunnel volume. Optionally, a _MultiCurve_ representing the _TerrainIntersectionCurve_ (cf. <<scls_6-5>>) can be specified. The geometric representation is refined in LOD2 by additional _MultiSurface_ and _MultiCurve_ geometries.

In LOD2 and higher LODs the outer structure of a tunnel can also be differentiated semantically by the classes &#95;__BoundarySurface__ and _TunnelInstallation_. A boundary surface is a part of the tunnel's exterior shell with a special function like wall (_WallSurface_), roof (_RoofSurface_), ground plate (_GroundSurface_), outer floor (_OuterFloorSurface_), outer ceiling (_OuterCeilingSurface_) or _ClosureSurface_. The _TunnelInstallation_ class is used for tunnel elements like outer stairs, strongly affecting the outer appearance of a tunnel. A _TunnelInstallation_ may have the attributes _class_, _function_ and _usage_ (see <<fig_38>>).

In LOD3, the openings in &#95;__BoundarySurface__ objects (doors and windows) can be represented as thematic objects.

In LOD4, the highest level of resolution, also the interior of a tunnel, composed of several hollow spaces, is represented in the tunnel model by the class _HollowSpace_. This enlargement allows a virtual accessibility of tunnels, e.g. for driving through a tunnel, for simulating disaster management or for presenting the light illumination within a tunnel. The aggregation of hollow spaces according to arbitrary, user defined criteria (e.g. for defining the hollow spaces corresponding to horizontal or vertical sections) is achieved by employing the general grouping concept provided by CityGML (cf. <<scls_10-11>>). Interior installations of a tunnel, i.e. objects within a tunnel which (in contrast to furniture) cannot be moved, are represented by the class _IntTunnelInstallation_. If an installation is attached to a specific hollow space (e.g. lamps, ventilator), they are associated with the _HollowSpace_ class, otherwise (e.g. pipes) with &#95;__AbstractTunnel__. A _HollowSpace_ may have the attributes _class_, _function_ and _usage_ whose possible values can be enumerated in code lists (<<scls_10-4-7>>, <<annex_c>>). The _class_ attribute allows a general classification of hollow spaces, e.g. commercial or private rooms, and occurs only once. The _function_ attribute is intended to express the main purpose of the hollow space, e.g. control area, installation space, storage space. The attribute _usage_ can be used if the way the object is actually used differs from the function. Both attributes can occur multiple times.

The visible surface of a hollow space is represented geometrically as a _Solid_ or _MultiSurface_. Semantically, the surface can be structured into specialised &#95;__BoundarySurfaces__, representing floor (_FloorSurface_), ceiling (_CeilingSurface_), and interior walls (_InteriorWallSurface_). Hollow space furniture, like movable equipment in control areas, can be represented in the CityGML tunnel model with the class _TunnelFurniture_. A _TunnelFurniture_ may have the attributes _class_, _function_ and _usage_.

*XML namespace*

The XML namespace of the CityGML Tunnel module is identified by the Uniform Resource Identifier (URI) http://www.opengis.net/citygml/tunnel/2.0. Within the XML Schema definition of the _Tunnel_ module, this URI is also used to identify the default namespace.

[[scls_10-4-1]]
==== Tunnel and tunnel part

.TunnelType, Tunnel
[source%unnumbered,xml]
----
<xs:complexType name="TunnelType">
	<xs:complexContent>
		<xs:extension base="AbstractTunnelType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfTunnel" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:element name="Tunnel" type="TunnelType" substitutionGroup="_AbstractTunnel"/>
<!-- ========================================================================================== -->
<xs:element name="_GenericApplicationPropertyOfTunnel" type="xs:anyType" abstract="true"/>
----

The _Tunnel_ class is one of the two subclasses of &#95;__AbstractTunnel__. If a tunnel only consists of one (homogeneous) part, this class shall be used. A tunnel composed of structural segments, for example tunnel entrance and subway, has to be separated into one tunnel having one or more additional _TunnelPart_ (see <<fig_39>>). The geometry and non-spatial properties of the central part of the tunnel should be represented in the aggregating _Tunnel_ feature.

.TunnelPartType, TunnelPart
[source%unnumbered,xml]
----
<xs:complexType name="TunnelPartType">
	<xs:complexContent>
		<xs:extension base="AbstractTunnelType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfTunnelPart" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:element name="TunnelPart" type="TunnelPartType" substitutionGroup="_AbstractTunnel"/>
<!-- ========================================================================================== -->
<xs:element name="_GenericApplicationPropertyOfTunnelPart" type="xs:anyType" abstract="true"/>
----

If sections of a tunnel differ in geometry and / or attributes, the tunnel can be separated into parts (see <<fig_39>>). Like _Tunnel_, the class _TunnelPart_ is derived from &#95;__AbstractTunnel__ and inherites all attributes of &#95;__AbstractTunnel__. A _TunnelPart_ object should be uniquely related to exactly one tunnel or tunnel part object.

[[fig_39]]
.Example of a tunnel modeled with two tunnel parts (source: Helmut Stracke).
image::093.png["",650,650]


.AbstractTunnelType, _AbstractTunnel
[source%unnumbered,xml]
----
<xs:complexType name="AbstractTunnelType">
    <xs:complexContent>
        <xs:extension base="core:AbstractSiteType">
            <xs:sequence>
                <xs:element name="class" type="gml:CodeType" minOccurs="0"/>
                <xs:element name="function" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
                <xs:element name="usage" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
                <xs:element name="yearOfConstruction" type="xs:gYear" minOccurs="0"/>
                <xs:element name="yearOfDemolition" type="xs:gYear" minOccurs="0"/>
                <xs:element name="lod1Solid" type="gml:SolidPropertyType" minOccurs="0"/>
                <xs:element name="lod1MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
                <xs:element name="lod1TerrainIntersection" type="gml:MultiCurvePropertyType" minOccurs="0"/>
                <xs:element name="lod2Solid" type="gml:SolidPropertyType" minOccurs="0"/>
                <xs:element name="lod2MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
                <xs:element name="lod2MultiCurve" type="gml:MultiCurvePropertyType" minOccurs="0"/>
                <xs:element name="lod2TerrainIntersection" type="gml:MultiCurvePropertyType" minOccurs="0"/>
                <xs:element name="outerTunnelInstallation" type="TunnelInstallationPropertyType" minOccurs="0" maxOccurs="unbounded"/>
                <xs:element name="interiorTunnelInstallation" type="IntTunnelInstallationPropertyType" minOccurs="0" 
                                        maxOccurs="unbounded"/>
                <xs:element name="boundedBy" type="BoundarySurfacePropertyType" minOccurs="0" maxOccurs="unbounded"/>
                <xs:element name="lod3Solid" type="gml:SolidPropertyType" minOccurs="0"/>
                <xs:element name="lod3MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
                <xs:element name="lod3MultiCurve" type="gml:MultiCurvePropertyType" minOccurs="0"/>
                <xs:element name="lod3TerrainIntersection" type="gml:MultiCurvePropertyType" minOccurs="0"/>
                <xs:element name="lod4Solid" type="gml:SolidPropertyType" minOccurs="0"/>
                <xs:element name="lod4MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
                <xs:element name="lod4MultiCurve" type="gml:MultiCurvePropertyType" minOccurs="0"/>
                <xs:element name="lod4TerrainIntersection" type="gml:MultiCurvePropertyType" minOccurs="0"/>
                <xs:element name="interiorHollowSpace" type="InteriorHollowSpacePropertyType" minOccurs="0" maxOccurs="unbounded"/>
                <xs:element name="consistsOfTunnelPart" type="TunnelPartPropertyType" minOccurs="0" maxOccurs="unbounded"/>
                <xs:element ref="_GenericApplicationPropertyOfAbstractTunnel" minOccurs="0" maxOccurs="unbounded"/>
            </xs:sequence>
        </xs:extension>
    </xs:complexContent>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:element name="_AbstractTunnel" type="AbstractTunnelType" abstract="true" substitutionGroup="core:_Site"/>
<!-- ========================================================================================== -->
<xs:element name="_GenericApplicationPropertyOfAbstractTunnel" type="xs:anyType" abstract="true"/>
----

The abstract class &#95;__AbstractTunnel__ contains properties for tunnel attributes, purely geometric representations, and geometric/semantic representations of the tunnel or tunnel part in different levels of detail. The attributes describe:

[type=a]
. The classification of the tunnel or tunnel part (_class_), the different functions (_function_), and the usage (_usage_). The type of these attributes is _gml:CodeType_ and the values can be specified in separate code lists.
. The year of construction (_yearOfConstruction_) and the year of demolition (_yearOfDemolition_) of the tunnel or tunnel part. The _yearOfConstruction_ is the year of completion of the tunnel. The _yearOfDemolition_ is the year when the demolition of the tunnel was completed. The date (year) refer to real world time (e.g. 2011). 

Spanning the different levels of detail, the tunnel model differs in the complexity and granularity of the geometric representation and the thematic structuring of the model into components with a special semantic meaning. This is illustrated in <<fig_40>>, showing the same tunnel in four different LODs. Some properties of the class &#95;__AbstractTunnel__ are also associated with certain LODs.



[[fig_40]]
.Tunnel model in LOD1 – LOD4 (source: Karlsruhe Institute of Technology (KIT)).
image::094.png[]


<<tab_6>> shows the correspondence of the different geometric and semantic themes of the tunnel model to LODs. In each LOD, the volume of a tunnel can be expressed by a _gml:Solid_ geometry and/or a _gml:MultiSurface_ geometry. The definition of a 3D Terrain Intersection Curve (TIC), used to integrate tunnels from different sources with the Digital Terrain Model, is also possible in all LODs. The TIC can – but does not have to – build closed rings around the tunnel or tunnel parts.


[[tab_6]]
.Semantic themes of the class __AbstractTunnel._
[cols="<,<,^,^,^,^",width=747]
|===
h| _Geometric / semantic theme_ h| Property type h| LOD1 h| LOD2 h| LOD3 h| LOD4
| _Volume part of the tunnel shell_ | _gml:SolidType_ | • | • | • | •
| _Surface part of the tunnel shell_ | _gml:MultiSurfaceType_ | • | • | • | •
| _Terrain intersection curve_ | _gml:MultiCurveType_ | • | • | • | •
| _Curve part of the tunnel shell_ | _gml:MultiCurveType_ a| | • | • | •
| _Tunnel parts_ | _TunnelPartType_ | • | • | • | •
| _Boundary surfaces (<<scls_10-4-3>>)_ | _AbstractBoundarySurfaceType_ a| | • | • | •
| _Outer tunnel installations (<<scls_10-4-2>>)_ | _TunnelInstallationType_ a| | • | • | •
| _Openings_ | _AbstractOpeningType_ a| | | • | •
| _Hollow spaces (<<scls_10-4-5>>)_ | _HollowSpaceType_ a| | | | •
| _Interior tunnel installations_ | _IntTunnelInstallationType_ a| | | | •
|===



[[scls_10-4-2]]
==== Outer tunnel installations

===== TunnelInstallationType, TunnelInstallation

A _TunnelInstallation_ is an outer component of a tunnel which has not the significance of a _TunnelPart_, but which strongly affects the outer characteristic of the tunnel, for examples stairs. A _TunnelInstallation_ optionally has attributes _class_, _function_ and _usage_. The attribute _class_ - which can only occur once - represents a general classification of the installation. With the attributes _function_ and _usage_, nominal and real functions of a tunnel installation can be described. For all three attributes the list of feasible values can specified in a code list. For the geometrical representation of a _TunnelInstallation_, an arbitrary geometry object from the GML subset shown in <<fig_9>> can be used. Alternatively, the geometry may be given as _ImplicitGeometry_ object. Following the concept of _ImplicitGeometry_ the geometry of a prototype tunnel installation is stored only once in a local coordinate system and referenced by other tunnel installation features (see <<scls_8-2>>). The visible surfaces of a tunnel installation can be semantically classified using the concept of boundary surfaces (cf. <<scls_10-3-3>>). A _TunnelInstallation_ object should be uniquely related to exactly one tunnel or tunnel part object.

[[scls_10-4-3]]
==== Boundary surfaces

[source%unnumbered,xml]
----
<xs:complexType name="AbstractBoundarySurfaceType" abstract="true">
	<xs:complexContent>
		<xs:extension base="core:AbstractCityObjectType">
			<xs:sequence>
				<xs:element name="lod2MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod3MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod4MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="opening" type="OpeningPropertyType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element ref="_GenericApplicationPropertyOfBoundarySurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:element name="_BoundarySurface" type="AbstractBoundarySurfaceType" abstract="true" substitutionGroup="core:_CityObject"/>
<!-- ========================================================================================== -->
<xs:element name="_GenericApplicationPropertyOfBoundarySurface" type="xs:anyType" abstract="true"/>
----

&#95;__BoundarySurface__ is the abstract base class for several thematic classes, structuring the exterior shell of a tunnel as well as the visible surface of hollow spaces and both outer and interior tunnel installations. It is a subclass of &#95;__CityObject__ and thus inherits all properties like the GML3 standard feature properties (_gml:name_ etc.) and the CityGML specific properties like _ExternalReferences_. From &#95;__BoundarySurface__, the thematic classes _RoofSurface_, _WallSurface_, _GroundSurface_, _OuterCeilingSurface_, _OuterFloorSurface_, _ClosureSurface_, _FloorSurface_, _InteriorWallSurface_, and _CeilingSurface_ are derived. The thematic classification of tunnel surfaces is illustrated in <<fig_41>> for different types of tunnel cross sections and are specified below.

[[fig_41]]
.Examples for the use of boundary surfaces for tunnels with different cross sections. _WallSurface_, _RoofSurface_, _GroundSurface_, _OuterCeilingSurface_ and _OuterFloorSurface_ are available in LOD2 – 4, whereas _InteriorWallSurface_, _FloorSurface_ and _CeilingSurface_ may only be used in LOD4 to model the interior boundary surfaces of a hollow space.
image::106a.png["",756,530]



For each LOD between 2 and 4, the geometry of a &#95;__BoundarySurface__ may be defined by a different _gml:MultiSurface_ geometry. Starting from LOD3, a &#95;__BoundarySurface__ may contain &#95;__Openings__ (cf. <<scls_10-4-4>>) like doors and windows. If the geometric location of openings topologically lies within a surface component (e.g. _gml:Polygon_) of the _gml:MultiSurface_ geometry, these openings must be represented as holes within that surface. A hole is represented by an interior ring within the corresponding surface geometry object. According to GML3, the points have to be specified in reverse order (exterior boundaries counter-clockwise and interior boundaries clockwise when looking in opposite direction of the surface's normal vector). If such an opening is sealed by a _Door_ or a _Window_, their outer boundary may consist of the same points as the inner ring (denoting the hole) of the surrounding surface. The embrasure surfaces of an opening belong to the relevant adjacent &#95;__BoundarySurface__. If, for example a door seals the opening, the embrasure surface on the one side of the door belongs to the _InteriorWallSurface_ and on the other side to the _WallSurface_ (cf. right part of <<fig_32>> for the same situation in a building model).

.GroundSurfaceType, GroundSurface
[source%unnumbered,xml]
----
<xs:complexType name="GroundSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfGroundSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:element name="GroundSurface" type="GroundSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================== -->
<xs:element name="_GenericApplicationPropertyOfGroundSurface" type="xs:anyType" abstract="true"/>
----

The ground plate of a tunnel or tunnel part is modelled by the class _GroundSurface_. Usually a _GroundSurface_ is a boundary surface between the tunnel and the surrounding earth (soil, rock etc.) or water.

.OuterCeilingSurfaceType, OuterCeilingSurface
[source%unnumbered,xml]
----
<xs:complexType name="OuterCeilingSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfOuterCeilingSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:element name="OuterCeilingSurface" type="OuterCeilingSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================== -->
<xs:element name="_GenericApplicationPropertyOfOuterCeilingSurface" type="xs:anyType" abstract="true"/>
----

A mostly horizontal surface belonging to the outer tunnel shell and with the orientation pointing downwards can be modeled as an _OuterCeilingSurface_. Examples are the visible part of an avalanche protector or the boundary surface between the tunnel and the surrounding earth or water.

.WallSurfaceType, WallSurface
[source%unnumbered,xml]
----
<xs:complexType name="WallSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfWallSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:element name="WallSurface" type="WallSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================== -->
<xs:element name="_GenericApplicationPropertyOfWallSurface" type="xs:anyType" abstract="true"/>
----

All parts of the tunnel facade belonging to the outer tunnel shell can be modelled by the class _WallSurface_. Usually a _WallSurface_ is a boundary surface between the tunnel and the surrounding earth (soil, rock etc.) or water.

.OuterFloorSurfaceType, OuterFloorSurface
[source%unnumbered,xml]
----
<xs:complexType name="OuterFloorSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfOuterFloorSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:element name="OuterFloorSurface" type="OuterFloorSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================== -->
<xs:element name="_GenericApplicationPropertyOfOuterFloorSurface" type="xs:anyType" abstract="true"/>
----

A mostly horizontal surface belonging to the outer tunnel shell and with the orientation pointing upwards can be modeled as an _OuterFloorSurface_.

.RoofSurfaceType, RoofSurface
[source%unnumbered,xml]
----
<xs:complexType name="RoofSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfRoofSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:element name="RoofSurface" type="RoofSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================== -->
<xs:element name="_GenericApplicationPropertyOfRoofSurface" type="xs:anyType" abstract="true"/>
----

Boundary surfaces belonging to the outer tunnel shell and with the main purpose to protect the tunnel from above are expressed by the class _RoofSurface_. The orientation of these boundaries is mainly pointing upwards.

.ClosureSurfaceType, ClosureSurface
[source%unnumbered,xml]
----
<xs:complexType name="ClosureSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfClosureSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:element name="ClosureSurface" type="ClosureSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================== -->
<xs:element name="_GenericApplicationPropertyOfClosureSurface" type="xs:anyType" abstract="true"/>
----

Openings in tunnels or hollow spaces not filled by a door or a window can be sealed by a virtual surface called _ClosureSurface_ (cf. <<scls_6-4>>). For example, the doorways of tunnels can be modelled as _ClosureSurface_.

.FloorSurfaceType, FloorSurface
[source%unnumbered,xml]
----
<xs:complexType name="FloorSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfFloorSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:element name="FloorSurface" type="FloorSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================== -->
<xs:element name="_GenericApplicationPropertyOfFloorSurface" type="xs:anyType" abstract="true"/>
----

The class _FloorSurface_ must only be used in the LOD4 interior tunnel model for modelling the floor of hollow spaces.

.InteriorWallSurfaceType, InteriorWallSurface
[source%unnumbered,xml]
----
<xs:complexType name="InteriorWallSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfInteriorWallSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:element name="InteriorWallSurface" type="InteriorWallSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================== -->
<xs:element name="_GenericApplicationPropertyOfInteriorWallSurface" type="xs:anyType" abstract="true"/>
----

The class _InteriorWallSurface_ is only allowed to be used in the LOD4 interior tunnel model for modelling the visible wall surfaces of hollow spaces.

.CeilingSurfaceType, CeilingSurface
[source%unnumbered,xml]
----
<xs:complexType name="CeilingSurfaceType">
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfCeilingSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:element name="CeilingSurface" type="CeilingSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================== -->
<xs:element name="_GenericApplicationPropertyOfCeilingSurface" type="xs:anyType" abstract="true"/>
----

The class _CeilingSurface_ is only allowed to be used in the LOD4 interior tunnel model for modelling the ceiling of hollow spaces.

[[scls_10-4-4]]
==== Openings

.AbstractOpeningType, _Opening
[source%unnumbered,xml]
----
<xs:complexType name="AbstractOpeningType" abstract="true">
	<xs:complexContent>
		<xs:extension base="core:AbstractCityObjectType">
			<xs:sequence>
				<xs:element name="lod3MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod4MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod3ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element name="lod4ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element ref="_GenericApplicationPropertyOfOpening" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="_Opening" type="AbstractOpeningType" abstract="true" substitutionGroup="core:_CityObject"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfOpening" type="xs:anyType" abstract="true"/>
----

The class &#95;__Opening__ is the abstract base class for semantically describing openings like doors or windows in outer and inner boundary surfaces. Openings only exist in models of LOD3 or LOD4. Each &#95;__Opening__ is associated with a _gml:MultiSurface_ geometry. Alternatively, the geometry may be given as _ImplicitGeometry_ object. Following the concept of _ImplicitGeometry_ the geometry of a prototype opening is stored only once in a local coordinate system and referenced by other opening features (see <<scls_8-2>>).

.WindowType, Window
[source%unnumbered,xml]
----
<xs:complexType name="AbstractOpeningType" abstract="true">
	<xs:complexContent>
		<xs:extension base="core:AbstractCityObjectType">
			<xs:sequence>
				<xs:element name="lod3MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod4MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod3ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element name="lod4ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element ref="_GenericApplicationPropertyOfOpening" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="_Opening" type="AbstractOpeningType" abstract="true" substitutionGroup="core:_CityObject"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfOpening" type="xs:anyType" abstract="true"/>
----

The class _Window_ is used for modelling windows in the in the exterior shell of a tunnel and in hollow spaces, or hatches between adjacent hollow spaces. The formal difference between the classes _Window_ and _Door_ is that – in normal cases – Windows are not specifically intended for the transit of people or vehicles.

.DoorType, Door
[source%unnumbered,xml]
----
<xs:complexType name="DoorType">
	<xs:complexContent>
		<xs:extension base="AbstractOpeningType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfDoor" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="Door" type="DoorType" substitutionGroup="_Opening"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfDoor" type="xs:anyType" abstract="true"/>
----

The class _Door_ is used for modelling doors in the exterior shell of a tunnel, or between adjacent hollow spaces. Doors can be used by people to enter or leave a tunnel or ahollow space. In contrast to a _ClosureSurface_ a door may be closed, blocking the transit of people or vehicles.

[[scls_10-4-5]]
==== Tunnel interior

.HollowSpaceType, HollowSpace
[source%unnumbered,xml]
----
<xs:complexType name="HollowSpaceType">
	<xs:complexContent>
		<xs:extension base="core:AbstractCityObjectType">
			<xs:sequence>
				<xs:element name="class" type="gml:CodeType" minOccurs="0"/>
				<xs:element name="function" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="usage" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="lod4Solid" type="gml:SolidPropertyType" minOccurs="0"/>
				<xs:element name="lod4MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="boundedBy" type="BoundarySurfacePropertyType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="interiorFurniture" type="InteriorFurniturePropertyType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="hollowSpaceInstallation" type="IntTunnelInstallationPropertyType" minOccurs="0" 
										maxOccurs="unbounded"/>
				<xs:element ref="_GenericApplicationPropertyOfHollowSpace" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:element name="HollowSpace" type="HollowSpaceType" substitutionGroup="core:_CityObject"/>
<!-- ========================================================================================== -->
<xs:element name="_GenericApplicationPropertyOfHollowSpace" type="xs:anyType" abstract="true"/>
----

A _HollowSpace_ is a semantic object for modelling the free space inside a tunnel and should be uniquely related to exactly one tunnel or tunnel part object. It should be closed (if necessary by using _ClosureSurface_) and the geometry normally will be described by a solid (_lod4Solid_). However, if the topological correctness of the boundary cannot be guaranteed, the geometry can alternatively be given as a _MultiSurface_ (_lod4MultiSurface_). The surface normals of the outer shell of a GML solid must point outwards. This is important if appearences should be assigned to _HollowSpace_ surfaces. In this case, textures and colors must be placed on the backside of the corresponding surfaces in order to be visible from the inside of the hollow space.

In addition to the geometrical representation, different parts of the visible surface of a hollow space can be modelled by specialised boundary surfaces (_FloorSurface_, _CeilingSurface_, _InteriorWallSurface_, and _ClosureSurface_, cf. <<scls_10-4-3>>).

.TunnelFurnitureType, TunnelFurniture
[source%unnumbered,xml]
----
<xs:complexType name="TunnelFurnitureType">
	<xs:complexContent>
		<xs:extension base="core:AbstractCityObjectType">
			<xs:sequence>
				<xs:element name="class" type="gml:CodeType" minOccurs="0"/>
				<xs:element name="function" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="usage" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="lod4Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod4ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element ref="_GenericApplicationPropertyOfTunnelFurniture" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:element name="TunnelFurniture" type="TunnelFurnitureType" substitutionGroup="core:_CityObject"/>
<!-- ========================================================================================== -->
<xs:element name="_GenericApplicationPropertyOfTunnelFurniture" type="xs:anyType" abstract="true"/>
----

Hollow spaces may have _TunnelFurniture_. A _TunnelFurniture_ is a movable part of a hollow space. A _TunnelFurniture_ object should be uniquely related to exactly one hollow space. Its geometry may be represented by an explicit geometry or an _ImplicitGeometry_ object. Following the concept of _ImplicitGeometry_ the geometry of a prototype tunnel furniture is stored only once in a local coordinate system and referenced by other tunnel furniture features (see <<scls_8-2>>).

.IntTunnelInstallationType, IntTunnelInstallation
[source%unnumbered,xml]
----
<xs:complexType name="IntTunnelInstallationType">
	<xs:complexContent>
		<xs:extension base="core:AbstractCityObjectType">
			<xs:sequence>
				<xs:element name="class" type="gml:CodeType" minOccurs="0"/>
				<xs:element name="function" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="usage" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="lod4Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod4ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element name="boundedBy" type="BoundarySurfacePropertyType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element ref="_GenericApplicationPropertyOfIntTunnelInstallation" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:element name="IntTunnelInstallation" type="IntTunnelInstallationType" substitutionGroup="core:_CityObject"/>
<!-- ========================================================================================== -->
<xs:element name="_GenericApplicationPropertyOfIntTunnelInstallation" type="xs:anyType" abstract="true"/>
----

An _IntTunnelInstallation_ is an object inside a tunnel with a specialized function or semantic meaning. In contrast to _TunnelFurniture_, objects of the class _IntTunnelInstallation_ are permanently attached to the tunnel structure and cannot be moved. Typical examples are interior stairs, railings, radiators or pipes. Objects of the class _IntTunnelInstallation_ can either be associated with a hollow space (class _HollowSpace_), or with the complete tunnel or tunnel part (class &#95;__AbstractTunnel__, see <<scls_10-4-1>>). However, they should be uniquely related to exactly one hollow space or one tunnel / tunnel part object. An _IntTunnelInstallation_ optionally has the attributes _class_, _function_ and _usage_. The attribute _class_, which can only occur once, represents a general classification of the internal tunnel component. With the attributes _function_ and _usage_, nominal and real functions of a tunnel installation can be described. For all three attributes the list of feasible values can be specified in a code list. For the geometrical representation of an _IntTunnelInstallation_, an arbitrary geometry object from the GML subset shown in <<fig_9>> can be used. Alternatively, the geometry may be given as _ImplicitGeometry_ object. Following the concept of _ImplicitGeometry_ the geometry of a prototype interior tunnel installation is stored only once in a local coordinate system and referenced by other interior tunnel installation features (see <<scls_8-2>>). The visible surfaces of an interior tunnel installation can be semantically classified using the concept of boundary surfaces (cf. <<scls_10-4-3>>).

[[scls_10-4-6]]
==== Examples

The example in <<fig_42>> shows a pedestrian underpass in the city centre of Karlsruhe, Germany. On the left side of <<fig_42>>, a photo illustrates the real world situation. Both entrances of the underpass are marked in the photo by dashed rectangles. On the right side of the figure, the CityGML tunnel model is shown. The terrain surrounding the tunnel has been virtually cut out of model in order to visualize the entire tunnel with its subsurface body. The same underpass is illustrated in <<fig_43>> from a different perspective. The camera is positioned in front of the left entrance (black dashed rectangle in <<fig_42>>) and pointing in the direction of the right entrance (white dashed rectangle in <<fig_42>>). On the right side of <<fig_43>>, the tunnel model is shown from the same perspective. Again holes are cut in the terrain surface in order to make the subsurface part of the tunnel visible. An LOD1 representation of the nearby buildings is shown in the background of the model.

[[fig_42]]
.Example of a tunnel modeled in LOD3 (real situation on the left side; CityGML model on the right side) (source: Karlsruhe Institute of Technology (KIT), courtesy of City of Karlsruhe).
image::108.png["",673,254]


[[fig_43]]
.The same LOD3 tunnel shown from a different perspective. The camera is positioned in front of the left entrance and pointing in the direction of the right entrance. (real situation on the left side; CityGML model on the right side). The model on the right also includes an LOD1 representation of the nearby buildings in the background (painted in light brown) (source: Karlsruhe Institute of Technology (KIT), courtesy of City of Karlsruhe).
image::109.png["",673,254]



The model is subdivided into one _Tunnel_ (the actual underpass) and two _TunnelParts_ (both entrances). The tunnel and tunnel parts are bounded by _GroundSurface_, _WallSurface_, _RoofSurface_. _ClosureSurface_&nbsp;objects are used to virtually seal the tunnel entrances. For safety reasons each of the two entrances has railings which are modeled as _TunnelInstallation_. Due to the high geometrical accuracy and the semantic richness, the model is classified as LOD3.

[[scls_10-4-7]]
==== Code lists

The attributes _class_, _function_, and _usage_ of the features __AbstractTunnel, TunnelInstallation, HollowSpace, TunnelFurniture_ and _IntTunnelInstallation_ are specified as _gml:CodeType_. The values of these properties can be enumerated in code lists. Proposals for corresponding code lists can be found in <<a_C-2>>.

[[scls_10-4-8]]
==== Conformance requirements

*Base requirements*

. If a tunnel only consists of one (homogeneous) part, it shall be represented by the element _Tunnel_. However, if a tunnel is composed of individual structural segments, it shall be modelled as a _Tunnel_ element having one or more additional _TunnelPart_ elements. Only the geometry and non-spatial properties of the main part of the tunnel should be represented within the aggregating _Tunnel_ element.

===== Usage restriction of tunnel model components according to different LODs

[start=2]
. The _lodXSolid_ and _lodXMultiSurface_, stem:[X in [1..4\]], properties (_gml:SolidPropertyType_ resp. _gml:MultiSurfacePropertyType_) of &#95;__AbstractTunnel__ may be used to geometrically represent the exterior shell of a tunnel (as volume or surface model) within each LOD. For LOD1, either _lod1Solid_ or _lod1MultiSurface_ must be used, but not both. Starting from LOD2, both properties may be modelled individually and complementary.
. Starting from LOD2, the exterior shell of an &#95;__AbstractTunnel__ may be semantically decomposed into &#95;__BoundarySurface__ elements using the _boundedBy_ property (type: _BoundarySurfacePropertyType_) of &#95;__AbstractTunnel__. Only _RoofSurface_, _WallSurface_, _GroundSurface_, _OuterCeilingSurface_, _OuterFloorSurface_ and _ClosureSurface_ as subclasses of &#95;__BoundarySurface__ are allowed. The _boundedBy_ property (not to be confused with the _gml:boundedBy_ property) shall not be used if the tunnel is only represented in LOD1. 

If the exterior shell is represented by &#95;__BoundarySurface__ elements, an additional geometric representation as volume or surface model using the _lodXSolid_ and _lodXMultiSurface_, stem:[X in [2..4\]], properties shall not explicitly define the geometry, but has to reference the according components of the _gml:MultiSurface_ element of &#95;__BoundarySurface__ within each LOD using the XLink concept of GML 3.1.1.

[start=4]
. Starting from LOD2, curve parts of the tunnel shell may be represented using the _lodXMultiCurve_, stem:[X in [2..4\]], property of &#95;__AbstractTunnel__. This property shall not be used if the tunnel is only represented in LOD1.
. Starting from LOD2, the _outerTunnelInstallation_ property (type: _TunnelInstallationPropertyType_) of &#95;__AbstractTunnel__ may be used to model _TunnelInstallation_ elements. _TunnelInstallation_ elements shall only be used to represent outer characteristics of a tunnel which do not have the significance of tunnel parts. The _outerTunnelInstallation_ property shall not be used if the tunnel is only represented in LOD1.
. Starting from LOD2, the geometry of _TunnelInstallation_ elements may be semantically classified by &#95;__BoundarySurface__ elements using the _boundedBy_ property (type: _BoundarySurfacePropertyType_) of _TunnelInstallation_. Only _RoofSurface_, _WallSurface_, _GroundSurface_, &#95;__OuterCeilingSurface__, _OuterFloorSurface_ and _ClosureSurface_ as subclasses of &#95;__BoundarySurface__ are allowed.
. Starting from LOD3, openings of &#95;__BoundarySurface__ elements may be modelled using the opening property (type: _OpeningPropertyType_) of &#95;__BoundarySurface__. This property shall not be used for &#95;__BoundarySurface__ elements only represented in LOD2. Accordingly, the surface geometry representing a &#95;__BoundarySurface__ in LOD2 must be simply connected. 

The opening property of &#95;__BoundarySurface__ may contain or reference &#95;__Opening__ elements. If the geometric location of an &#95;__Opening__ element topologically lies within a surface component of the &#95;__BoundarySurface__, the opening must also be represented as inner hole of that surface. The embrasure surface of an &#95;__Opening__ element shall belong to the relevant adjacent &#95;__BoundarySurface__.

[start=8]
. Starting from LOD4, the _interiorHollowSpace_ property (type: _InteriorHollowSpacePropertyType_) of &#95;__AbstractTunnel__ may be used to semantically model the free space inside the tunnel by _HollowSpace_ elements. This property shall not be used if the tunnel is only represented in LOD 1 – 3. The _HollowSpace_ element may be geometrically represented as a surface or volume model, using its _lod4Solid_ or _lod4MultiSurface_ property (_gml:SolidPropertyType_ resp. _gml:MultiSurfacePropertyType_).

In addition, different parts of the visible surface of a hollow space may be modelled by thematic &#95;__BoundarySurface__ elements. Only _FloorSurface_, _CeilingSurface_, _InteriorWallSurface_, and _ClosureSurface_ as subclasses of &#95;__BoundarySurface__ are allowed. If the visible surface of a hollow space is represented by &#95;__BoundarySurface__ elements, an additional geometric representation as volume or surface model using the _lod4Solid_ and _lod4MultiSurface_ property shall not explicitly define the geometry, but has to reference the according components of the _gml:MultiSurface_ element of &#95;__BoundarySurface__ using the XLink concept of GML 3.1.1.

[start=9]
. Starting from LOD4, the _interiorTunnelInstallation_ property (type: _IntTunnelInstallationPropertyType_) of &#95;__AbstractTunnel__ may be used to represent immovable objects inside the tunnel that are permanently attached to the tunnel structure. The _interiorTunnelInstallation_ property shall not be used if the tunnel is only represented in LOD 1 – 3. Furthermore, the _interiorTunnelInstallation_ property shall only be used if the object cannot be associated with a _HollowSpace_ element. In the latter case, the _hollowSpaceInstallation_ property (type: _IntTunnelInstallationPropertyType_) of the corresponding _HollowSpace_ element shall be used to represent the object.
. Starting from LOD4, the geometry of _IntTunnelInstallation_ elements may be semantically classified by &#95;__BoundarySurface__ elements using the _boundedBy_ property (type: _BoundarySurfacePropertyType_) of _IntTunnelInstallation_. Only _FloorSurface_, _CeilingSurface_, _InteriorWallSurface,_ and _ClosureSurface_ as subclasses of &#95;__BoundarySurface__ are allowed.

*Referential integrity*

[start=11]
. The _boundedBy_ property (type: _BoundarySurfacePropertyType_) of the element &#95;__AbstractTunnel__ may contain a &#95;__BoundarySurface__ element inline or an XLink reference to a remote &#95;__BoundarySurface__ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _boundedBy_ property may only point to a remote &#95;__BoundarySurface__ element (where remote &#95;__BoundarySurface__ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none. 
+
--
Only _RoofSurface_, _WallSurface_, _GroundSurface_, _OuterCeilingSurface_, _OuterFloorSurface_ and _ClosureSurface_ elements are allowed to be encapsulated or referenced by the _boundedBy_ property of &#95;__AbstractTunnel__.
--

. The _outerTunnelInstallation_ property (type: _TunnelInstallationPropertyType_) of the element &#95;__AbstractTunnel__ may contain a _TunnelInstallation_ element inline or an XLink reference to a remote _TunnelInstallation_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _outerTunnelInstallation_ property may only point to a remote _TunnelInstallation_ element (where remote _TunnelInstallation_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none. 
. The _interiorTunnelInstallation_ property (type: _IntTunnelInstallationPropertyType_) of the element &#95;__AbstractTunnel__ may contain an _IntTunnelInstallation_ element inline or an XLink reference to a remote _IntTunnelInstallation_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _interiorTunnelInstallation_ property may only point to a remote _IntTunnelInstallation_ element (where remote _IntTunnelInstallation_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _interiorHollowSpace_ property (type: _InteriorHollowSpacePropertyType_) of the element &#95;__AbstractTunnel__ may contain a _HollowSpace_ element inline or an XLink reference to a remote _HollowSpace_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _interiorHollowSpace_ property may only point to a remote _HollowSpace_ element (where remote _HollowSpace_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _consistsOfTunnelPart_ property (type: _TunnelPartPropertyType_) of the element &#95;__AbstractTunnel__ may contain a _TunnelPart_ element inline or an XLink reference to a remote _TunnelPart_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _consistsOfTunnelPart_ property may only point to a remote _TunnelPart_ element (where remote _TunnelPart_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _opening_ property (type: _OpeningPropertyType_) of the element &#95;__BoundarySurface__ may contain an &#95;__Opening__ element inline or an XLink reference to a remote &#95;__Opening__ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the opening property may only point to a remote &#95;__Opening__ element (where remote &#95;__Opening__ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _boundedBy_ property (type: _BoundarySurfacePropertyType_) of the element _TunnelInstallation_ may contain a &#95;__BoundarySurface__ element inline or an XLink reference to a remote &#95;__BoundarySurface__ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _boundedBy_ property may only point to a remote &#95;__BoundarySurface__ element (where remote &#95;__BoundarySurface__ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
+
--
Only _RoofSurface_, _WallSurface_, _GroundSurface_, _OuterCeilingSurface_, _OuterFloorSurface_ and _ClosureSurface_ elements are allowed to be encapsulated or referenced by the _boundedBy_ property of _TunnelInstallation_.
--

. The _boundedBy_ property (type: _BoundarySurfacePropertyType_) of the element _IntTunnelInstallation_ may contain a &#95;__BoundarySurface__ element inline or an XLink reference to a remote &#95;__BoundarySurface__ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _boundedBy_ property may only point to a remote &#95;__BoundarySurface__ element (where remote &#95;__BoundarySurface__ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
+
--
Only _FloorSurface_, _CeilingSurface_, _InteriorWallSurface,_ and _ClosureSurface_ elements are allowed to be encapsulated or referenced by the _boundedBy_ property of _IntTunnelInstallation_.
--
. The _boundedBy_ property (type: _BoundarySurfacePropertyType_) of the element _HollowSpace_ may contain a &#95;__BoundarySurface__ element inline or an XLink reference to a remote &#95;__BoundarySurface__ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _boundedBy_ property may only point to a remote &#95;__BoundarySurface__ element (where remote &#95;__BoundarySurface__ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none. 
+
--
Only _FloorSurface_, _CeilingSurface_, _InteriorWallSurface_, and _ClosureSurface_ elements are allowed to be encapsulated or referenced by the _boundedBy_ property of _HollowSpace_.
--

. The _interiorFurniture_ property (type: _InteriorFurniturePropertyType_) of the element _HollowSpace_ may contain an _TunnelFurniture_ element inline or an XLink reference to a remote _TunnelFurniture_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _interiorFurniture_ property may only point to a remote _TunnelFurniture_ element (where remote _TunnelFurniture_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _hollowSpaceInstallation_ property (type: _IntTunnelInstallationPropertyType_) of the element _HollowSpace_ may contain an _IntTunnelInstallation_ element inline or an XLink reference to a remote _IntTunnelInstallation_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _hollowSpaceInstallation_ property may only point to a remote _IntTunnelInstallation_ element (where remote _IntTunnelInstallation_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _lodXImplicitRepresentation_, stem:[X in [2..4\]], property (type: _core:ImplicitRepresentationPropertyType_) of the element _TunnelInstallation_ may contain a _core:ImplicitGeometry_ element inline or an XLink reference to a remote _core:ImplicitGeometry_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _lodXImplicitRepresentation_, stem:[X in [2..4\]], property may only point to a remote _core:ImplicitGeometry_ element (where remote _core:ImplicitGeometry_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _lod4ImplicitRepresentation_ property (type: _core:ImplicitRepresentationPropertyType_) of the element _IntTunnelInstallation_ may contain a _core:ImplicitGeometry_ element inline or an XLink reference to a remote _core:ImplicitGeometry_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _lod4ImplicitRepresentation_ property may only point to a remote _core:ImplicitGeometry_ element (where remote _core:ImplicitGeometry_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _lodXImplicitRepresentation_, stem:[X in [3..4\]], property (type: _core:ImplicitRepresentationPropertyType_) of the element &#95;__Opening__ may contain a _core:ImplicitGeometry_ element inline or an XLink reference to a remote _core:ImplicitGeometry_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _lodXImplicitRepresentation_, stem:[X in [3..4\]], property may only point to a remote _core:ImplicitGeometry_ element (where remote _core:ImplicitGeometry_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _lod4ImplicitRepresentation_ property (type: _core:ImplicitRepresentationPropertyType_) of the element _TunnelFurniture_ may contain a _core:ImplicitGeometry_ element inline or an XLink reference to a remote _core:ImplicitGeometry_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _lod4ImplicitRepresentation_ property may only point to a remote _core:ImplicitGeometry_ element (where remote _core:ImplicitGeometry_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.


[[scls_10-5]]
=== Bridge model

The bridge model allows for the representation of the thematic, spatial and visual aspects of bridges and bridge parts in four levels of detail, LOD 1 – 4. The bridge model of CityGML is defined by the thematic extension module _Bridge_ (cf. <<cls_7>>). <<fig_44>> illustrates examples of bridge models in all LODs.

[[fig_44]]
.Examples for bridge models in LOD1 (upper left), LOD2 (upper right), LOD3 (lower left) and LOD4 (lower right) (source: Google 3D warehouse)
image::113.png[]

The bridge model was developed in analogy to the building model (cf. <<scls_10-3>>) with regard to structure and attributes. The UML diagram of the bridge model is depicted in <<fig_45>>, and the XML schema definition is presented in <<a_A-3>>.

[[fig_45]]
.UML diagram of the bridge model, part one.
image::115.png[]

A (movable or unmovable) bridge is represented by an object of the class _Bridge_. This class inherits its attributes and relations from the abstract base class &#95;__AbstractBridge__. The spatial properties are defined by a solid for each of the four LODs (relations _lod1Solid_ to _lod4Solid_). In analogy to the building model, the semantical as well as the geometrical richness increases from LOD1 (blocks model) to LOD3 (architectural model). Simple examples of bridges in each of those LODs are depicted in <<fig_46>>. Interior structures like rooms are dedicated to LOD4. To cover the case of bridge models where the topology does not satisfy the properties of a solid (essentially water tightness), a multi surface representation is allowed (_lod1MultiSurface_ to _lod4MultiSurface_). The line where the bridge touches the terrain surface is represented by a terrain intersection curve, which is provided for each LOD (relations _lod1TerrainIntersection_ to _lod4TerrainIntersection_). In addition to the solid representation of a bridge, linear characteristics like ropes or antennas can be specified geometrically by the _lod1MultiCurve_ to _lod4MultiCurve_ relations. If those characteristics shall be represented semantically, the features _BridgeInstallation_ or _BridgeConstructionElement_ can be used (see <<scls_10-5-2>>). All relations to semantic objects and geometric properties are listed in <<tab_7>>.


[[fig_46]]
.Bridge model in LOD1 – LOD4. (source: Karlsruhe Institute of Technology (KIT))
image::116.png["",600,600]


The semantic attributes of an &#95;__AbstractBridge__ are _class, function, usage_ and _is_movable_. The attribute _class_ is used to classify bridges, e.g. to distinguish different construction types (cf. <<fig_48>>). The attribute _function_ allows representing the utilization of the bridge independently of the construction.Possiblevalues may be railway bridge, roadway bridge, pedestrian bridge, aqueduct, etc. The option to denote a usage which is divergent to one of the primary functions of the bridge (_function_) is given by the attribute _usage_. The type of these attributes is _gml:CodeType,_ the values of which can be defined in code lists. The name of the bridge can be represented by the _gml:name_ attribute, which is inherited from the base class _gml_: &#95;__GML__ via the classes _gml_: &#95;__Feature__, &#95;__CityObject__, and &#95;__Site__. Each _Bridge_ or _BridgePart_ feature may be assigned zero or more addresses using the _address_ property. The corresponding _AddressPropertyType_ is defined within the CityGML core module (cf. <<scls_10-1-4>>).


[[tab_7]]
.Semantic themes of the class &#95;__AbstractBridge__.
[cols="<,<,^,^,^,^",width=747,options="unnumbered"]
|===
h| Geometric / semantic theme h| Property type h| LOD1 h| LOD2 h| LOD3 h| LOD4
| Volume part of the bridge shell | _gml:SolidType_ | • | • | • | •
| Surface part of the bridge shell | _gml:MultiSurfaceType_ | • | • | • | •
| Terrain intersection curve | _gml:MultiCurveType_ | • | • | • | •
| Curve part of the bridge shell | _gml:MultiCurveType_ a| | • | • | •
| Bridge parts (<<scls_10-5-1>>) | _BridgePartType_ | • | • | • | •
| Boundary surfaces (<<scls_10-5-3>>) | _AbstractBoundarySurfaceType_ a| | • | • | •
| Outer bridge installations (<<scls_10-5-2>>) | _BridgeInstallationType_ a| | • | • | •
| Bridge construction elements (<<scls_10-5-2>>) | _BridgeConstruction-ElementType_ | • | • | • | •
| Openings (<<scls_10-5-4>>) | _AbstractOpeningType_ a| a| | • | •
| Bridge rooms(<<scls_10-5-5>>) | _BridgeRoomType_ a| | | | •
| Interior bridge installations | _IntBridgeInstallationType_ a| | | | •
|===


The boolean attribute _is_movable_ is defined to specify whether a bridge is movable or not. The modeling of the geometric aspects of the movement is delayed to later versions of this standard. Some types of movable bridges are depicted in <<fig_47>>.


[[fig_47]]
.Examples for movable bridges (source: ISO 6707).
//====
image::131.png["",600,600]
//image::047a.gif[]

//image::047b.gif[]

//image::047c.gif[]

//image::047d.gif[]

//image::047e.gif[]
//====


[[fig_48]]
.Examples for different types of bridges.
image::133.png["",650,600]



*XML namespace*

The XML namespace of the CityGML Bridge module is identified by the Uniform Resource Identifier (URI) http://www.opengis.net/citygml/bridge/2.0. Within the XML Schema definition of the Bridge module, this URI is also used to identify the default namespace.

[[scls_10-5-1]]
==== Bridge and bridge part

.BridgeType, Bridge
[source%unnumbered,xml]
----
<xs:complexType name="BridgeType">
	<xs:complexContent>
		<xs:extension base="AbstractBridgeType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfBridge" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="Bridge" type="BridgeType" substitutionGroup="_AbstractBridge"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfBridge" type="xs:anyType" abstract="true"/>
----

.BridgePartType, BridgePart
[source%unnumbered,xml]
----
<xs:complexType name="BridgeType">
	<xs:complexContent>
		<xs:extension base="AbstractBridgeType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfBridge" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="Bridge" type="BridgeType" substitutionGroup="_AbstractBridge"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfBridge" type="xs:anyType" abstract="true"/>
----

If some parts of a bridge differ from the remaining bridge with regard to attribute values or if parts like ramps can be identified as objects of their own, those parts can be represented as _BridgePart_. A bridge can consist of multiple _BridgeParts_. Like _Bridge_, _BridgePart_ is a subclass of &#95;__AbstractBridge__ and hence, has the same attributes and relations. The relation _consistOfBridgePart_ represents the aggregation hierarchy between a _Bridge_ (or a _BridgePart_) and it's _BridgeParts_. By this means, an aggregation hierarchy of arbitrary depth can be modeled. Each _BridgePart_ belongs to exactly one _Bridge_ (or _BridgePart_). Similar to the building model, the aggregation structure of a bridge forms a tree. A simple example for a bridge with parts is a twin bridge. Another example is presented in <<scls_10-5-6>>.

.AbstractBridgeType, _AbstractBridge
[source%unnumbered,xml]
----
<xs:complexType name="AbstractBridgeType" abstract="true">
	<xs:complexContent>
		<xs:extension base="core:AbstractSiteType">
			<xs:sequence>
				<xs:element name="class" type="gml:CodeType" minOccurs="0"/>
				<xs:element name="function" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="usage" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="yearOfConstruction" type="xs:gYear" minOccurs="0"/>
				<xs:element name="yearOfDemolition" type="xs:gYear" minOccurs="0"/>
				<xs:element name="isMovable" type="xs:boolean" default="false" minOccurs="0"/>
				<xs:element name="lod1Solid" type="gml:SolidPropertyType" minOccurs="0"/>
				<xs:element name="lod1MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod1TerrainIntersection" type="gml:MultiCurvePropertyType" minOccurs="0"/>
				<xs:element name="lod2Solid" type="gml:SolidPropertyType" minOccurs="0"/>
				<xs:element name="lod2MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod2MultiCurve" type="gml:MultiCurvePropertyType" minOccurs="0"/>
				<xs:element name="lod2TerrainIntersection" type="gml:MultiCurvePropertyType" minOccurs="0"/>
				<xs:element name="outerBridgeConstruction" type="BridgeConstructionElementPropertyType" minOccurs="0"
										maxOccurs="unbounded"/>
				<xs:element name="outerBridgeInstallation" type="BridgeInstallationPropertyType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="interiorBridgeInstallation" type="IntBridgeInstallationPropertyType" minOccurs="0"
										maxOccurs="unbounded"/>
				<xs:element name="boundedBy" type="BoundarySurfacePropertyType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="lod3Solid" type="gml:SolidPropertyType" minOccurs="0"/>
				<xs:element name="lod3MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod3MultiCurve" type="gml:MultiCurvePropertyType" minOccurs="0"/>
				<xs:element name="lod3TerrainIntersection" type="gml:MultiCurvePropertyType" minOccurs="0"/>
				<xs:element name="lod4Solid" type="gml:SolidPropertyType" minOccurs="0"/>
				<xs:element name="lod4MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod4MultiCurve" type="gml:MultiCurvePropertyType" minOccurs="0"/>
				<xs:element name="lod4TerrainIntersection" type="gml:MultiCurvePropertyType" minOccurs="0"/>
				<xs:element name="interiorBridgeRoom" type="InteriorBridgeRoomPropertyType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="consistsOfBridgePart" type="BridgePartPropertyType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="address" type="core:AddressPropertyType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element ref="_GenericApplicationPropertyOfAbstractBridge" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="_AbstractBridge" type="AbstractBridgeType" abstract="true" substitutionGroup="core:_Site"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfAbstractBridge" type="xs:anyType" abstract="true"/>
----

The abstract class &#95;__AbstractBridge__ is the base class of _Bridges_ and _BridgeParts_. It contains properties for bridge attributes, purely geometric representations, and geometric/semantic representations of the bridge or bridge part in different levels of detail. The attributes describe:

[type=a]
. The classification of the bridge or bridge part (_class_), the different intended usages (_function_), and the different actual usages (_usage_). The permitted values for these property types can be specified in code lists.
. The year of construction (_yearOfConstruction_) and the year of demolition (_yearOfDemolition_) of the bridge or bridge part. These attributes can be used to describe the chronology of the bridge development within a city model. The points of time refer to real world time.
. Wether the bridge is movable is specified by the Boolean attribute _isMovable_.

[[scls_10-5-2]]
==== Bridge construction elements and bridge installations

.BridgeConstructionElementType, BridgeConstructionElement
[source%unnumbered,xml]
----
<xs:complexType name="BridgeConstructionElementType">
	<xs:complexContent>
		<xs:extension base="core:AbstractCityObjectType">
			<xs:sequence>
				<xs:element name="class" type="gml:CodeType" minOccurs="0"/>
				<xs:element name="function" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="usage" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="lod1Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod2Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod3Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod4Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod1TerrainIntersection" type="gml:MultiCurvePropertyType" minOccurs="0"/>
				<xs:element name="lod2TerrainIntersection" type="gml:MultiCurvePropertyType" minOccurs="0"/>
				<xs:element name="lod3TerrainIntersection" type="gml:MultiCurvePropertyType" minOccurs="0"/>
				<xs:element name="lod4TerrainIntersection" type="gml:MultiCurvePropertyType" minOccurs="0"/>
				<xs:element name="lod1ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element name="lod2ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element name="lod3ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element name="lod4ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element name="boundedBy" type="BoundarySurfacePropertyType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element ref="_GenericApplicationPropertyOfBridgeConstructionElement" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="BridgeConstructionElement" type="BridgeConstructionElementType" substitutionGroup="core:_CityObject"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfBridgeConstructionElement" type="xs:anyType"/>
----

.BridgeInstallationType, BridgeInstallation
[source%unnumbered,xml]
----
<xs:complexType name="BridgeInstallationType">
	<xs:complexContent>
		<xs:extension base="core:AbstractCityObjectType">
			<xs:sequence>
				<xs:element name="class" type="gml:CodeType" minOccurs="0"/>
				<xs:element name="function" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="usage" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="lod2Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod3Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod4Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod2ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element name="lod3ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element name="lod4ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element name="boundedBy" type="BoundarySurfacePropertyType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element ref="_GenericApplicationPropertyOfBridgeInstallation" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="BridgeInstallation" type="BridgeInstallationType" substitutionGroup="core:_CityObject"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfBridgeInstallation" type="xs:anyType" abstract="true"/>
----

Bridge elements which do not have the size, significance or meaning of a _BridgePart_ can be modelled either as _BridgeConstructionElement_ or as _BridgeInstallation_. Elements which are essential from a structural point of view are modelled as _BridgeConstructionElement_, for example structural elements like pylons, anchorages etc. (cf. <<fig_49>>). A general classification as well as the intended and actual function of the construction element are represented by the attributes _class_, _function,_ and _usage_. The geometry of a _BridgeConstructionElement_, which may be present in LOD1 to LOD4, is _gml:_Geometry_. Alternatively, the geometry may be given as _ImplicitGeometry_ object. Following the concept of _ImplicitGeometry_ the geometry of a prototype bridge construction element is stored only once in a local coordinate system and referenced by other bridge construction element features (cf. <<scls_8-2>>). The visible surfaces of a bridge construction element can be semantically classified using the concept of boundary surfaces (cf. <<scls_10-5-3>>).

Whereas a _BridgeConstructionElement_ has structural relevance, a _BridgeInstallation_ represents an element of the bridge which can be eliminated without collapsing of the bridge (e.g. stairway, antenna, railing). _BridgeInstallations_ occur in LOD 2 to 4 only and are geometrically representated as _gml:_Geometry_. Again, the concept of _ImplicitGeometry_ can be applied to _BridgeInstallations_&nbsp;alternatively, and their visible surfaces can be semantically classified using the concept of boundary surfaces (cf. <<scls_10-5-3>>). The class _BridgeInstallation_ contains the semantic attributes _class_, _function_ and _usage_. The attribute _class_ gives a classification of installations of a bridge. With the attributes _function_ and _usage_, nominal and real functions of the bridge installation can be described. The type of all attributes is _gml:CodeType_ and their values can be defined in code lists.


[[fig_49]]
.BridgeConstructionElements of a suspension bridge.
image::140.png[]



[[scls_10-5-3]]
==== Boundary surfaces

.AbstractBoundarySurfaceType, _BoundarySurface
[source%unnumbered,xml]
----
<xs:complexType name="AbstractBoundarySurfaceType" abstract="true">
	<xs:complexContent>
		<xs:extension base="core:AbstractCityObjectType">
			<xs:sequence>
				<xs:element name="lod2MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod3MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod4MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="opening" type="OpeningPropertyType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element ref="_GenericApplicationPropertyOfBoundarySurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:element name="_BoundarySurface" type="AbstractBoundarySurfaceType" abstract="true" substitutionGroup="core:_CityObject"/>
<!-- ========================================================================================== -->
<xs:element name="_GenericApplicationPropertyOfBoundarySurface" type="xs:anyType" abstract="true"/>
----

The thematic boundary surfaces of a bridge are defined in analogy to the building module. &#95;__BoundarySurface__ is the abstract base class for several thematic classes, structuring the exterior shell of a bridge as well as the visible surfaces of rooms, bridge construction elements and both outer and interior bridge installations. It is a subclass of &#95;__CityObject__ and thus inherits all properties like the GML3 standard feature properties (_gml:name_ etc.) and the CityGML specific properties like _ExternalReferences_. From &#95;__BoundarySurface__, the thematic classes _RoofSurface_, _WallSurface_, _GroundSurface_, _OuterCeilingSurface_, _OuterFloorSurface_, _ClosureSurface_, _FloorSurface_, _InteriorWallSurface_, and _CeilingSurface_ are derived.

For each LOD between 2 and 4, the geometry of a &#95;__BoundarySurface__ may be defined by a different _gml:MultiSurface_ geometry.

In LOD3 and LOD4, a &#95;__BoundarySurface__ may contain &#95;__Openings__ (cf. <<scls_10-5-4>>) like doors and windows. If the geometric location of &#95;__Openings__ topologically lies within a surface component (e.g. _gml:Polygon_) of the _gml:MultiSurface_ geometry, these &#95;__Openings__ must be represented as holes within that surface. A hole is represented by an interior ring within the corresponding surface geometry object. According to GML3, the points have to be specified in reverse order (exterior boundaries counter-clockwise and interior boundaries clockwise when looking in opposite direction of the surface's normal vector). If such an opening is sealed by a _Door_, a _Window_, or a _ClosureSurface_, their outer boundary may consist of the same points as the inner ring (denoting the hole) of the surrounding surface. The embrasure surfaces of an _Opening_ belong to the relevant adjacent &#95;__BoundarySurface__. If, for example a door seals the _Opening_, the embrasure surface on the one side of the door belongs to the _InteriorWallSurface_ and on the other side to the _WallSurface._

<<fig_50>> depicts a bridge with _RoofSurfaces_, _WallSurfaces_, _OuterFloorSurfaces_ and _OuterCeilingSurfaces_. Besides _Bridges_ and _BridgeParts_, _BridgeConstructionElements_, _BridgeInstallations_ as well as _IntBridgeInstallations_ can be related to &#95;__BoundarySurface__. &#95;__BoundarySurfaces__ occur in LOD2 to LOD4. In LOD3 and LOD4, such a surface may contain &#95;__Openings__ (see <<scls_10-3-4>>) like doors and windows.

[[fig_50]]
.Different BoundarySurfaces of a bridge.
image::141.png["",400,500]



.GroundSurfaceType, GroundSurface
[source%unnumbered,xml]
----
<xs:complexType name="GroundSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfGroundSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="GroundSurface" type="GroundSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfGroundSurface" type="xs:anyType" abstract="true"/>
----

The ground plate of a bridge or bridge part is modelled by the class _GroundSurface_. The polygon defining the ground plate is congruent with the bridge's footprint. However, the surface normal of the ground plate is pointing downwards.

.OuterCeilingSurfaceType, OuterCeilingSurface
[source%unnumbered,xml]
----
<xs:complexType name="OuterCeilingSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfOuterCeilingSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:element name="OuterCeilingSurface" type="OuterCeilingSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================== -->
<xs:element name="_GenericApplicationPropertyOfOuterCeilingSurface" type="xs:anyType" abstract="true"/>
----

A mostly horizontal surface belonging to the outer bridge shell and having the orientation pointing downwards can be modeled as an _OuterCeilingSurface_.

.WallSurfaceType, WallSurface
[source%unnumbered,xml]
----
<xs:complexType name="WallSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfWallSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="WallSurface" type="WallSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfWallSurface" type="xs:anyType" abstract="true"/>
----

All parts of the bridge facade belonging to the outer bridge shell can be modelled by the class _WallSurface_.

.OuterFloorSurfaceType, OuterFloorSurface
[source%unnumbered,xml]
----
<xs:complexType name="OuterFloorSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfOuterFloorSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:element name="OuterFloorSurface" type="OuterFloorSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================== -->
<xs:element name="_GenericApplicationPropertyOfOuterFloorSurface" type="xs:anyType" abstract="true"/>
----

A mostly horizontal surface belonging to the outer bridge shell and with the orientation pointing upwards can be modeled as an _OuterFloorSurface_.

.RoofSurfaceType, RoofSurface
[source%unnumbered,xml]
----
<xs:complexType name="RoofSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfRoofSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================== -->
<xs:element name="RoofSurface" type="RoofSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================== -->
<xs:element name="_GenericApplicationPropertyOfRoofSurface" type="xs:anyType" abstract="true"/>
----

The major roof parts of a bridge or bridge part are expressed by the class _RoofSurface_.

.ClosureSurfaceType, ClosureSurface
[source%unnumbered,xml]
----
<xs:complexType name="ClosureSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfClosureSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="ClosureSurface" type="ClosureSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfClosureSurface" type="xs:anyType" abstract="true"/>
----

An opening in a bridge not filled by a door or window can be sealed by a virtual surface called _ClosureSurface_ (cf. <<scls_6-4>>). Hence, bridge with open sides can be virtually closed in order to be able to compute their volume. _ClosureSurfaces_ are also used in the interior bridge model. If two rooms with a different are directly connected without a separating door, a _ClosureSurface_ should be used to separate or connect the volumes of both rooms.

.FloorSurfaceType, FloorSurface
[source%unnumbered,xml]
----
<xs:complexType name="ClosureSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfClosureSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="ClosureSurface" type="ClosureSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfClosureSurface" type="xs:anyType" abstract="true"/>
----

The class _FloorSurface_ must only be used in the LOD4 interior bridge model for modelling the floor of a bridge room.

.InteriorWallSurfaceType, InteriorWallSurface
[source%unnumbered,xml]
----
<xs:complexType name="InteriorWallSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfInteriorWallSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="InteriorWallSurface" type="InteriorWallSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfInteriorWallSurface" type="xs:anyType" abstract="true"/>
----

The class _InteriorWallSurface_ must only be used in the LOD4 interior bridge model for modelling the visible surfaces of the bridge room walls.

.CeilingSurfaceType, CeilingSurface
[source%unnumbered,xml]
----
<xs:complexType name="CeilingSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfCeilingSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="CeilingSurface" type="CeilingSurfaceType" substitutionGroup="_BoundarySurface"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfCeilingSurface" type="xs:anyType" abstract="true"/>
----

The class _CeilingSurface_ must only be used in the LOD4 interior bridge model for modelling the ceiling of a bridge room.

[[scls_10-5-4]]
==== Openings

.AbstractOpeningType, _Opening
[source%unnumbered,xml]
----
<xs:complexType name="AbstractOpeningType" abstract="true">
	<xs:complexContent>
		<xs:extension base="core:AbstractCityObjectType">
			<xs:sequence>
				<xs:element name="lod3MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod4MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod3ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element name="lod4ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element ref="_GenericApplicationPropertyOfOpening" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="_Opening" type="AbstractOpeningType" abstract="true" substitutionGroup="core:_CityObject"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfOpening" type="xs:anyType" abstract="true"/>
----

The class &#95;__Opening__ is the abstract base class for semantically describing openings like doors or windows in outer or inner boundary surfaces like walls and roofs. Openings only exist in models of LOD3 or LOD4. Each &#95;__Opening__ is associated with a _gml:MultiSurface_ geometry. Alternatively, the geometry may be given as _ImplicitGeometry_ object. Following the concept of _ImplicitGeometry_ the geometry of a prototype opening is stored only once in a local coordinate system and referenced by other opening features (see <<scls_8-2>>).

.WindowType, Window
[source%unnumbered,xml]
----
<xs:complexType name="WindowType">
	<xs:complexContent>
		<xs:extension base="AbstractOpeningType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfWindow" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="Window" type="WindowType" substitutionGroup="_Opening"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfWindow" type="xs:anyType" abstract="true"/>
----

The class _Window_ is used for modelling windows in the exterior shell of a bridge, or hatches between adjacent rooms. The formal difference between the classes _Window_ and _Door_ is that – in normal cases – _Windows_ are not specifically intended for the transit of people or vehicles.

.DoorType, Door
[source%unnumbered,xml]
----
<xs:complexType name="DoorType">
	<xs:complexContent>
		<xs:extension base="AbstractOpeningType">
			<xs:sequence>
				<xs:element name="address" type="core:AddressPropertyType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element ref="_GenericApplicationPropertyOfDoor" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="Door" type="DoorType" substitutionGroup="_Opening"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfDoor" type="xs:anyType" abstract="true"/>
----

The class _Door_ is used for modelling doors in the exterior shell of a bridge, or between adjacent rooms. Doors can be used by people to enter or leave a bridge or room. In contrast to a _ClosureSurface_ a door may be closed, blocking the transit of people. A _Door_ may be assigned zero or more addresses. The corresponding _AddressPropertyType_ is defined within the CityGML core module (cf. <<scls_10-1-4>>).

[[scls_10-5-5]]
==== Bridge interior

The classes _BridgeRoom_, _IntBridgeInstallation_ and _BridgeFurniture_ allow for the representation of the bridge interior. They are designed in analogy to the classes _Room_, _IntBuildingInstallation_ and _BuildingFurniture_ of the building module and share the same meaning. The bridge interior can only be modeled in LOD4.

.BridgeRoomType, BridgeRoom
[source%unnumbered,xml]
----
<xs:complexType name="BridgeRoomType">
	<xs:complexContent>
		<xs:extension base="core:AbstractCityObjectType">
			<xs:sequence>
				<xs:element name="class" type="gml:CodeType" minOccurs="0"/>
				<xs:element name="function" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="usage" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="lod4Solid" type="gml:SolidPropertyType" minOccurs="0"/>
				<xs:element name="lod4MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="boundedBy" type="BoundarySurfacePropertyType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="interiorFurniture" type="InteriorFurniturePropertyType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="bridgeRoomInstallation" type="IntBridgeInstallationPropertyType" minOccurs="0" 
										maxOccurs="unbounded"/>
				<xs:element ref="_GenericApplicationPropertyOfBridgeRoom" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="BridgeRoom" type="BridgeRoomType" substitutionGroup="core:_CityObject"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfBridgeRoom" type="xs:anyType" abstract="true"/>
----

A _BridgeRoom_ is a semantic object for modelling the free space inside a bridge and should be uniquely related to exactly one bridge or bridge part object. It should be closed (if necessary by using _ClosureSurfaces_) and the geometry normally will be described by a solid (_lod4Solid_). However, if the topological correctness of the boundary cannot be guaranteed, the geometry can alternatively be given as a _MultiSurface_ (_lod4MultiSurface_). The surface normals of the outer shell of a GML solid must point outwards. This is important to consider when _BridgeRoom_ surfaces should be assigned _Appearances_. In this case, textures and colors must be placed on the backside of the corresponding surfaces in order to be visible from the inside of the room.

In addition to the geometrical representation, different parts of the visible surface of a room can be modelled by specialised _BoundarySurfaces_ (_FloorSurface_, _CeilingSurface_, _InteriorWallSurface_, and _ClosureSurface;_ cf. <<scls_10-5-3>>).

.BridgeFurnitureType, BridgeFurniture
[source%unnumbered,xml]
----
<xs:complexType name="BridgeFurnitureType">
	<xs:complexContent>
		<xs:extension base="core:AbstractCityObjectType">
			<xs:sequence>
				<xs:element name="class" type="gml:CodeType" minOccurs="0"/>
				<xs:element name="function" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="usage" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="lod4Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod4ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element ref="_GenericApplicationPropertyOfBridgeFurniture" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="BridgeFurniture" type="BridgeFurnitureType" substitutionGroup="core:_CityObject"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfBridgeFurniture" type="xs:anyType" abstract="true"/>
----

__BridgeRoom__s may have _BridgeFurnitures_ and _IntBridgeInstallations_. A _BridgeFurniture_ is a movable part of a room, such as a chair or furniture. A _BridgeFurniture_ object should be uniquely related to exactly one room object. Its geometry may be represented by an explicit geometry or an _ImplicitGeometry_ object. Following the concept of _ImplicitGeometry_ the geometry of a prototype bridge furniture is stored only once in a local coordinate system and referenced by other bridge furniture features (see <<scls_8-2>>).

.IntBridgeInstallationType, IntBridgeInstallation
[source%unnumbered,xml]
----
<xs:complexType name="IntBridgeInstallationType">
    <xs:complexContent>
        <xs:extension base="core:AbstractCityObjectType">
            <xs:sequence>
                <xs:element name="class" type="gml:CodeType" minOccurs="0"/>
                <xs:element name="function" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
                <xs:element name="usage" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
                <xs:element name="lod4Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
                <xs:element name="lod4ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
                <xs:element name="boundedBy" type="BoundarySurfacePropertyType" minOccurs="0" maxOccurs="unbounded"/>
                <xs:element ref="_GenericApplicationPropertyOfIntBridgeInstallation" minOccurs="0" maxOccurs="unbounded"/>
            </xs:sequence>
        </xs:extension>
    </xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="IntBridgeInstallation" type="IntBridgeInstallationType" substitutionGroup="core:_CityObject"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfIntBridgeInstallation" type="xs:anyType" abstract="true"/>
----

An _IntBridgeInstallation_ is an object inside a bridge with a specialised function or semantic meaning. In contrast to _BridgeFurniture_, _IntBridgeInstallations_ are permanently attached to the bridge structure and cannot be moved. Examples for _IntBridgeInstallations_ are stairways, railings and heaters. Objects of the class _IntBridgeInstallation_ can either be associated with a room (class _BridgeRoom_), or with the complete bridge / bridge part (class &#95;__AbstractBridge__, cf. <<scls_10-5-1>>). However, they should be uniquely related to exactly one room or one bridge / bridge part object. An _IntBridgeInstallation_ optionally has attributes _class_, _function_ and _usage_. The attribute _class_, which can only occur once, represents a general classification of the internal bridge component. With the attributes _function_ and _usage_, nominal and real functions of a bridge installation can be described. For all three attributes the list of feasible values can be specified in a code list. For the geometrical representation of an _IntBridgeInstallation_, an arbitrary geometry object from the GML subset shown in <<fig_9>> can be used. Alternatively, the geometry may be given as _ImplicitGeometry_ object. Following the concept of _ImplicitGeometry_ the geometry of a prototype interior bridge installation is stored only once in a local coordinate system and referenced by other interior bridge installation features (see <<scls_8-2>>). The visible surfaces of an interior bridge installation can be semantically classified using the concept of boundary surfaces (cf. <<scls_10-5-3>>).

[[scls_10-5-6]]
==== Examples

The bridge of Rees crossing the Rhine in Germany has three bridge parts which are separated by pylons. <<fig_51>> (left) depicts the Rees bridge model containing one _Bridge_ feature which consists of three _BridgePart_ features. The pylons, which are structurally essential, are represented by _BridgeConstructionElements_. On the top of the pylons, four lamps are located which are modeled as _BridgeInstallation_ features (cf. right part of <<fig_51>>).

[[fig_51]]
.The bridge of Rees, consisting of a _Bridge_ feature and three _BridgePart_ features (left). The bridge contains _BridgeConstructionElement_ and _BridgeInstallation_ features (right).
image::153.png[]


In the following <<fig_52>>, the main part of the bridge of Rees is shown as photograph on the left side (source: Harald Halfpapp), and the corresponding part of the LOD2 bridge model is depicted on the the right side (source: District of Recklinghausen / KIT).

[[fig_52]]
.The bridge of Rees (left photo (source: Harald Halfpapp); right LOD2 model (source: District of Recklinghausen / KIT)).
image::155.png[]

There are two bridges crossing the river Rhine at Karlsruhe, Germany. The first one is a two track railway bridge constructed as a truss bridge (cf. <<fig_53>> front). The second one is a four lane highway bridge constructed as a cable-stayed bridge (cf. <<fig_53>> background).

[[fig_53]]
.Bridge over the river Rhine at Karlsruhe (left a photo, right the 3D CityGML model) (source: Karlsruhe Institute of Technology (KIT), courtesy of City of Karlsruhe).
image::157.png[]


In CityGML both bridges are modeled as single _Bridge_ object with _BridgeConstructionElements_ and _BridgeInstallations_. The construction elements of the cable stayed bridge are the footings on both river sides and in the middle of the river, as well as the cables and the pylon. The construction elements of the truss bridge are the footings and the truss itself. Both bridges have several railings which are modeled as _BridgeInstallation_.

The bridge "Oberbaumbrücke" shown in <<fig_54>> is located in the centre of Berlin crossing the river Spree and serves as example for bridges having interior rooms. The real-world bridge is depicted in the left part of <<fig_54>>, whereas the corresponding CityGML model is shown on the right. The outer geometry of the bridge is modeled as _gml:MultiSurface_ element (_lod4MultiSurface_ property) and is assigned photorealistic textures. Additionally, the interior rooms located in both bridge towers are represented as _BridgeRoom_ objects with solid geometries (_gml:Solid_ assigned through the _lod4Solid_ property). Due to its high geometric accuracy and the representation of the interior structures of both bridge towers, the model is classified as LOD4.

[[fig_54]]
.The bridge"Oberbaumbrücke" in Berlin represented as bridge model in LOD4 (left a photo, right the 3D CityGML model) (source: Berlin Senate of Business, Technology and Women; Business Location Center, Berlin; Technische Universität Berlin; Karlsruhe Institute of Technology (KIT)).
image::159.png[]


[[scls_10-5-7]]
==== Code lists

The attributes _class_, _function_, and _usage_ of the features __AbstractBridge, BridgeConstructionElement, BridgeInstallation, BridgeRoom, BridgeFurniture_ and _IntBridgeInstallation_ are specified as _gml:CodeType_. The values of these properties can be enumerated in code lists. Proposals for corresponding code lists can be found in <<a_C-3>>.

[[scls_10-5-8]]
==== Conformance requirements

*Base requirements*

. If a bridge only consists of one (homogeneous) part, it shall be represented by the element _Bridge_. However, if a bridge is composed of individual structural segments, it shall be modelled as a _Bridge_ el-ement having one or more additional _BridgePart_ elements. Only the geometry and non-spatial properties of the main part of the bridge should be represented within the aggregating _Bridge_ element.

===== Usage restriction of bridge model components according to different LODs

[start=2]
. The _lodXSolid_ and _lodXMultiSurface_, stem:[X in [1..4\]], properties (_gml:SolidPropertyType_ resp. _gml:MultiSurfacePropertyType_) of &#95;__AbstractBridge__ may be used to geometrically represent the exte-rior shell of a bridge (as volume or surface model) within each LOD. For LOD1, either _lod1Solid_ or _lod1MultiSurface_ must be used, but not both. Starting from LOD2, both properties may be modelled individually and complementary.
. Starting from LOD2, the exterior shell of an &#95;__AbstractBridge__ may be semantically decomposed into &#95;__BoundarySurface__ elements using the _boundedBy_ property (type: _BoundarySurfacePropertyType_) of &#95;__AbstractBridge__. Only _RoofSurface_, _WallSurface_, _GroundSurface_, _OuterCeilingSurface_, _OuterFloorSurface_ and _ClosureSurface_ as subclasses of &#95;__BoundarySurface__ are allowed. The _boundedBy_ property (not to be confused with the _gml:boundedBy_ property) shall not be used if the bridge is only represented in LOD1.
+
--
If the exterior shell is represented by &#95;__BoundarySurface__ elements, an additional geometric representation as volume or surface model using the _lodXSolid_ and _lodXMultiSurface_, stem:[X in [2..4\]], properties shall not explicitly define the geometry, but has to reference the according components of the _gml:MultiSurface_ element of &#95;__BoundarySurface__ within each LOD using the XLink concept of GML 3.1.1.
--
. Starting from LOD2, curve parts of the bridge shell may be represented using the _lodXMultiCurve_, stem:[X in [2..4\]], property of &#95;__AbstractBridge__. This property shall not be used if the bridge is only represented in LOD1.
. Starting from LOD1, the _outerBridgeConstruction_ property (type: _BridgeConstructionElementPropertyType_) of &#95;__AbstractBridge__ may be used to model _BridgeConstructionElement_ elements. _BridgeConstructionElement_ elements shall only be used to represent outer characteristics of a bridge which do not have the significance of bridge parts and are essential from a structural point of view.
. Starting from LOD2, the geometry of _BridgeConstructionElement_ elements may be semantically classified by &#95;__BoundarySurface__ elements using the _boundedBy_ property (type: _BoundarySurfacePropertyType_) of _BridgeConstructionElement_. The _boundedBy_ property (not to be confused with the _gml:boundedBy_ property) shall not be used if the bridge construction element is only represented in LOD1. 
. Starting from LOD2, the _outerBridgeInstallation_ property (type: _BridgeInstallationPropertyType_) of &#95;__AbstractBridge__ may be used to model _BridgeInstallation_ elements. _BridgeInstallation_ elements shall only be used to represent outer characteristics of a bridge which do not have the significance of bridge parts and are not essential from a structural point of view. 
. Starting from LOD2, the geometry of _BridgeInstallation_ elements may be semantically classified by &#95;__BoundarySurface__ elements using the _boundedBy_ property (type: _BoundarySurfacePropertyType_) of _BridgeInstallation_. Only _RoofSurface_, _WallSurface_, _GroundSurface, &#95;__OuterCeilingSurface__, _OuterFloorSurface_ and _ClosureSurface_ as subclasses of &#95;__BoundarySurface__ are allowed.
. Starting from LOD3, openings of &#95;__BoundarySurface__ elements may be modelled using the _opening_ property (type: _OpeningPropertyType_) of &#95;__BoundarySurface__. This property shall not be used for &#95;__BoundarySurface__ elements only represented in LOD2. Accordingly, the surface geometry representing a &#95;__BoundarySurface__ in LOD2 must be simply connected.
+
--
The _opening_ property of &#95;__BoundarySurface__ may contain or reference &#95;__Opening__ elements. If the geo-metric location of an &#95;__Opening__ element topologically lies within a surface component of the &#95;__BoundarySurface__, the opening must also be represented as inner hole of that surface. The embrasure surface of an &#95;__Opening__ element shall belong to the relevant adjacent &#95;__BoundarySurface__.
--
. Starting from LOD4, the _interiorBridgeRoom_ property (type: _InteriorBridgeRoomPropertyType_) of &#95;__AbstractBridge__ may be used to semantically model the free space inside the bridge by _BridgeRoom_ elements. This property shall not be used if the bridge is only represented in LOD 1 – 3. The _BridgeRoom_ element may be geometrically represented as a surface or volume model, using its _lod4Solid_ or _lod4MultiSurface_ property (_gml:SolidPropertyType_ resp. _gml:MultiSurfacePropertyType_).
+
--
In addition, different parts of the visible surface of a bridge room may be modelled by thematic &#95;__BoundarySurface__ elements. Only _FloorSurface_, _CeilingSurface_, _InteriorWallSurface_, and _ClosureSurface_ as subclasses of &#95;__BoundarySurface__ are allowed. If the visible surface of a room is represented by &#95;__BoundarySurface__ elements, an additional geometric representation as volume or surface model using the _lod4Solid_ and _lod4MultiSurface_ property shall not explicitly define the geometry, but has to reference the according components of the _gml:MultiSurface_ element of &#95;__BoundarySurface__ using the XLink concept of GML 3.1.1.
--

. Starting from LOD4, the _interiorBridgeInstallation_ property (type: _IntBridgeInstallationPropertyType_) of &#95;__AbstractBridge__ may be used to represent immovable objects inside the bridge that are permamently attached to the bridge structure. The _interiorBridgeInstallation_ property shall not be used if the bridge is only represented in LOD 1 – 3. Furthermore, the _interiorBridgeInstallation_ property shall only be used if the object cannot be associated with a _BridgeRoom_ element. In the latter case, the _bridgeRoomInstallation_ property (type: _IntBridgeInstallationPropertyType_) of the corresponding _BridgeRoom_ element shall be used to represent the object.
. Starting from LOD4, the geometry of _IntBridgeInstallation_ elements may be semantically classified by &#95;__BoundarySurface__ elements using the _boundedBy_ property (type: _BoundarySurfacePropertyType_) of _IntBridgeInstallation_. Only _FloorSurface_, _CeilingSurface_, _InteriorWallSurface,_ and _ClosureSurface_ as subclasses of &#95;__BoundarySurface__ are allowed.

*Referential integrity*

[start=13]
. The _boundedBy_ property (type: _BoundarySurfacePropertyType_) of the element &#95;__AbstractBridge__ may contain a &#95;__BoundarySurface__ element inline or an XLink reference to a remote &#95;__BoundarySurface__ ele-ment using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _boundedBy_ property may only point to a remote &#95;__BoundarySurface__ element (where remote &#95;__BoundarySurface__ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
+
--
Only _RoofSurface_, _WallSurface_, _GroundSurface_, _OuterCeilingSurface_, _OuterFloorSurface_ and Clo-_sureSurface_ elements are allowed to be encapsulated or referenced by the boundedBy property of &#95;__AbstractBridge__.
--

. The _outerBridgeConstruction_ property (type: _BridgeConstructionElementPropertyType_) of the element &#95;__AbstractBridge__ may contain a _BridgeConstructionElement_ element inline or an XLink reference to a remote _BridgeConstructionElement_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _outerBridgeConstruction_ property may only point to a remote _BridgeConstructionElement_ element (where remote _BridgeConstructionElement_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _outerBridgeInstallation_ property (type: _BridgeInstallationPropertyType_) of the element &#95;__AbstractBridge__ may contain a _BridgeInstallation_ element inline or an XLink reference to a remote BridgeInstallation element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ at-tribute of the _outerBridgeInstallation_ property may only point to a remote _BridgeInstallation_ element (where remote _BridgeInstallation_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _interiorBridgeInstallation_ property (type: _IntBridgeInstallationPropertyType_) of the element &#95;__AbstractBridge__ may contain an _IntBridgeInstallation_ element inline or an XLink reference to a remote _IntBridgeInstallation_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _interiorBridgeInstallation_ property may only point to a remote _IntBridgeInstallation_ element (where remote _IntBridgeInstallation_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _interiorBridgeRoom_ property (type: _InteriorBridgeRoomPropertyType_) of the element &#95;__AbstractBridge__ may contain a _BridgeRoom_ element inline or an XLink reference to a remote _BridgeRoom_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _interiorBridgeRoom_ property may only point to a remote _BridgeRoom_ element (where remote _BridgeRoom_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _consistsOfBridgePart_ property (type: _BridgePartPropertyType_) of the element &#95;__AbstractBridge__ may contain a _BridgePart_ element inline or an XLink reference to a remote _BridgePart_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _consistsOfBridgePart_ property may only point to a remote _BridgePart_ element (where remote _BridgePart_ elements are locat-ed in another document or elsewhere in the same document). Either the contained element or the refer-ence must be given, but neither both nor none.
. The _address_ property (type: _core:AddressPropertyType_) of the element &#95;__AbstractBridge__ may contain an _core:Address_ element inline or an XLink reference to a remote _core:Address_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the address property may only point to a remote _core:Address_ element (where remote _core:Address_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _opening_ property (type: _OpeningPropertyType_) of the element &#95;__BoundarySurface__ may contain an &#95;__Opening__ element inline or an XLink reference to a remote &#95;__Opening__ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the opening property may only point to a re-mote &#95;__Opening__ element (where remote &#95;__Opening__ elements are located in another document or else-where in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _address_ property (type: _core:AddressPropertyType_) of the element _Door_ may contain an _core:Address_ element inline or an XLink reference to a remote _core:Address_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the address property may only point to a remote _core:Address_ element (where remote _core:Address_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _boundedBy_ property (type: _BoundarySurfacePropertyType_) of the element _BridgeConstructionElement_ may contain a &#95;__BoundarySurface__ element inline or an XLink reference to a remote &#95;__BoundarySurface__ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _boundedBy_ property may only point to a remote &#95;__BoundarySurface__ element (where remote &#95;__BoundarySurface__ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _boundedBy_ property (type: _BoundarySurfacePropertyType_) of the element _BridgeInstallation_ may contain a &#95;__BoundarySurface__ element inline or an XLink reference to a remote &#95;__BoundarySurface__ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _boundedBy_ property may only point to a remote &#95;__BoundarySurface__ element (where remote &#95;__BoundarySurface__ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
+
--
Only _RoofSurface_, _WallSurface_, _GroundSurface_, _OuterCeilingSurface_, _OuterFloorSurface_ and _ClosureSurface_ elements are allowed to be encapsulated or referenced by the _boundedBy_ property of _BridgeInstallation_.
--

[start=24]
. The _boundedBy_ property (type: _BoundarySurfacePropertyType_) of the element _IntBridgeInstallation_ may contain a &#95;__BoundarySurface__ element inline or an XLink reference to a remote &#95;__BoundarySurface__ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _boundedBy_ property may only point to a remote &#95;__BoundarySurface__ element (where remote &#95;__BoundarySurface__ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
+
--
Only _FloorSurface_, _CeilingSurface_, _InteriorWallSurface,_ and _ClosureSurface_ elements are allowed to be encapsulated or referenced by the _boundedBy_ property of _IntBridgeInstallation_.
--

. The _boundedBy_ property (type: _BoundarySurfacePropertyType_) of the element _BridgeRoom_ may contain a &#95;__BoundarySurface__ element inline or an XLink reference to a remote &#95;__BoundarySurface__ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _boundedBy_ property may only point to a remote &#95;__BoundarySurface__ element (where remote &#95;__BoundarySurface__ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
+
--
Only _FloorSurface_, _CeilingSurface_, _InteriorWallSurface_, and _ClosureSurface_ elements are allowed to be encapsulated or referenced by the _boundedBy_ property of _BridgeRoom_.
--
. The _interiorFurniture_ property (type: _InteriorFurniturePropertyType_) of the element _BridgeRoom_ may contain an _BridgeFurniture_ element inline or an XLink reference to a remote _BridgeFurniture_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _interiorFurniture_ property may only point to a remote _BridgeFurniture_ element (where remote _BridgeFurniture_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _bridgeRoomInstallation_ property (type: _IntBridgeInstallationPropertyType_) of the element _BridgeRoom_ may contain an _IntBridgeInstallation_ element inline or an XLink reference to a remote _IntBridgeInstallation_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _bridgeRoomInstallation_ property may only point to a remote _IntBridgeInstallation_ element (where remote _IntBridgeInstallation_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _lodXImplicitRepresentation_, stem:[X in [1..4\]], property (type: _core:ImplicitRepresentationPropertyType_) of the element _BridgeConstructionElement_ may contain a _core:ImplicitGeometry_ element inline or an XLink reference to a remote _core:ImplicitGeometry_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _lodXImplicitRepresentation_, stem:[X in [1..4\]], property may only point to a remote _core:ImplicitGeometry_ element (where remote _core:ImplicitGeometry_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _lodXImplicitRepresentation_, stem:[X in [2..4\]], property (type: _core:ImplicitRepresentationPropertyType_) of the element _BridgeInstallation_ may contain a _core:ImplicitGeometry_ element inline or an XLink reference to a remote _core:ImplicitGeometry_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _lodXImplicitRepresentation_, stem:[X in [2..4\]], property may only point to a remote _core:ImplicitGeometry_ element (where remote _core:ImplicitGeometry_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _lodXImplicitRepresentation_, stem:[X in [3..4\]], property (type: _core:ImplicitRepresentationPropertyType_) of the element &#95;__Opening__ may contain a _core:ImplicitGeometry_ element inline or an XLink reference to a remote _core:ImplicitGeometry_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _lodXImplicitRepresentation_, stem:[X in [3..4\]], property may only point to a remote _core:ImplicitGeometry_ element (where remote _core:ImplicitGeometry_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _lod4ImplicitRepresentation_ property (type: _core:ImplicitRepresentationPropertyType_) of the element _IntBridgeInstallation_ may contain a _core:ImplicitGeometry_ element inline or an XLink reference to a remote _core:ImplicitGeometry_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _lod4ImplicitRepresentation_ property may only point to a remote _core:ImplicitGeometry_ element (where remote _core:ImplicitGeometry_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _lod4ImplicitRepresentation_ property (type: _core:ImplicitRepresentationPropertyType_) of the element _BridgeFurniture_ may contain a _core:ImplicitGeometry_ element inline or an XLink reference to a remote _core:ImplicitGeometry_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _lod4ImplicitRepresentation_ property may only point to a remote _core:ImplicitGeometry_ element (where remote _core:ImplicitGeometry_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.





[[scls_10-6]]
=== Water bodies

Waters have always played an important role in urbanisation processes and cities were built preferably at rivers and places where landfall seemed to be easy. Obviously, water is essential for human alimentation and sanitation. Water bodies present the most economical way of transportation and are barriers at the same time, that avoid instant access to other locations. Bridging waterways caused the first efforts of construction and resulted in high-tech bridges of today. The landscapes of many cities are dominated by water, which directly relates to 3D city models. Furthermore, water bodies are important for urban life as subject of recreation and possible hazards as e.g. floods.

The distinct character of water bodies compared with the permanence of buildings, roadways, and terrain is considered in this thematic model. Water bodies are dynamic surfaces. Tides occur regularly, but irregular events predominate with respect to natural forces, for example flood events. The visible water surface changes in height and its covered area with the necessity to model its semantics and geometry distinct from adjacent objects like terrain or buildings.

This first modelling approach of water bodies fulfils the requirements of 3D city models. It does not inherit any hydrological or other dynamic aspects. In these terms it does not claim to be complete. However, the semantic and geometric description given here allows further enhancements of dynamics and conceptually different descriptions. The water bodies model of CityGML is embraced by the thematic extension module _WaterBody_ (cf. <<cls_7>>).

The water bodies model represents the thematic aspects and three-dimensional geometry of rivers, canals, lakes, and basins. In the LOD 2-4 water bodies are bounded by distinct thematic surfaces. These surfaces are the obligatory _WaterSurface_, defined as the boundary between water and air, the optional _WaterGroundSurface_, defined as the boundary between water and underground (e.g. DTM or floor of a 3D basin object), and zero or more _WaterClosureSurfaces_, defined as virtual boundaries between different water bodies or between water and the end of a modelled region (see <<fig_55>>). A dynamic element may be the _WaterSurface_ to represent temporarily changing situations of tidal flats.

[[fig_55]]
.Illustration of a water body defined in CityGML (graphic: IGG Uni Bonn).
image::161.gif["",497,292]



The UML diagram of the water body model is depicted in <<fig_56>>, for the XML schema definition see below and <<a_A-13>>. Each _WaterBody_ object may have the attributes _class_, _function_ and _usage_ whose possible values can be enumerated in code lists (cf. <<scls_10-6-3>> and <<a_C-9>>). The attribute _class_ defines the classification of the object, e.g. lake, river, or fountain and can occur only once. The attribute _function_ contains the purpose of the object like, for example national waterway or public swimming, while the attribute _usage_ defines the actual usages, e.g. whether the water body is navigable. The latter two attributes can occur multiple times.

_WaterBody_ is a subclass of &#95;__WaterObject__ and transitively of the root class &#95;__CityObject__. The class &#95;__WaterObject__ may be differentiated in further subclasses of water objects in the future. The geometrical representation of the _WaterBody_ varies through the different levels of detail. Since _WaterBody_ is a subclass of &#95;__CityObject__ and hence a feature, it inherits the attribute _gml:name._The _WaterBody_ can be differentiated semantically by the class &#95;__WaterBoundarySurface__. A &#95;__WaterBoundarySurface__ is a part of the water body's exterior shell with a special function like _WaterSurface_, _WaterGroundSurface_ or _WaterClosureSurface._ As with any &#95;__CityObject__, _WaterBody_ objects as well as _WaterSurface_, _WaterGroundSurface_, and _WaterClosureSurface_ may be assigned _ExternalReferences_(cf. <<scls_6-7>>) and may be augmented by _generic attributes_ using CityGML's _Generics_ module (cf. <<scls_10-12>>).

The optional attribute _waterLevel_ of a _WaterSurface_ can be used to describe the water level, for which the given 3D surface geometry was acquired. This is especially important when the water body is influenced by the tide. The allowed values can be defined in a corresponding code list.

[[fig_56]]
.UML diagram of the water body model in CityGML. Prefixes are used to indicate XML namespaces associated with model elements. Element names without a prefix are defined within the CityGML _WaterBody_ module.
image::162.png["",756,272]

Both LOD0 and LOD1 represent a low level of illustration and high grade of generalisation. Here the rivers are modelled as _MultiCurve_ geometry and brooks are omitted. Seas, oceans and lakes with significant extent are represented as a _MultiSurface_ (<<fig_56>>). Every _WaterBody_ may be assigned a combination of geometries of different types. Linear water bodies are represented as a network of 3D curves. Each curve is composed of straight line segments, where the line orientation denotes the flow direction (water flows from the first point of a curve, e.g. a _gml:LineString,_ to the last). Areal objects like lakes or seas are represented by 3D surface geometries of the water surface.

Starting from LOD1 water bodies may also be modelled as water filled volumes represented by _Solids_. If a water body is represented by a _gml:Solid_ in LOD2 or higher, the surface geometries of the corresponding thematic _WaterClosureSurface_, _WaterGroundSurface_, and _WaterSurface_ objects must coincide with the exterior shell of the _gml:Solid_. This can be ensured, if for each LOD _X_ the respective _lodXSolid_ representation (where _X_ is between 2 and 4) does not redundantly define the geometry, but instead references the corresponding polygons (using GML3's XLink mechanism) of the _lodXSurface_ elements (where _X_ is between 2 and 4) of _WaterClosureSurface_, _WaterGroundSurface_, and _WaterSurface_.

LOD2 to LOD4 demand a higher grade of detail and therefore any _WaterBody_ can be outlined by thematic surfaces or a solid composed of the surrounding thematic surfaces.

Every object of the class _WaterSurface_, _WaterClosureSurface_, and _WaterGroundSurface_ must have at least one associated surface geometry. This means, that every _WaterSurface_, _WaterClosureSurface_, and _WaterGroundSurface_ feature within a CityGML instance document must contain at least one of the following properties: _lod2Surface_, _lod3Surface_, _lod4Surface_.

The water body model implicitly includes the concept of _TerrainIntersectionCurves_ (TIC), e.g. to specify the exact intersection of the DTM with the 3D geometry of a _WaterBody_ or to adjust a _WaterBody_ or _WaterSurface_ to the surrounding DTM (see <<scls_6-5>>). The rings defining the _WaterSurface_ polygons implicitly delineate the intersection of the water body with the terrain or basin.

*XML namespace*

The XML namespace of the CityGML _WaterBody_ module is identified by the Uniform Resource Identifier (URI) http://www.opengis.net/citygml/waterbody/2.0. Within the XML Schema definition of the _WaterBody_ module, this URI is also used to identify the default namespace.

[[scls_10-6-1]]
==== Water body

.AbstractWaterObjectType, _WaterObject
[source%unnumbered,xml]
----
<xs:complexType name="AbstractWaterObjectType" abstract="true">
	<xs:complexContent>
		<xs:extension base="core:AbstractCityObjectType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfWaterObject" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="_WaterObject" type="AbstractWaterObjectType" abstract="true" substitutionGroup="core:_CityObject"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfWaterObject" type="xs:anyType" abstract="true"/>
----

.WaterBodyType, WaterBody
[source%unnumbered,xml]
----
<xs:complexType name="WaterBodyType">
	<xs:complexContent>
		<xs:extension base="AbstractWaterObjectType">
			<xs:sequence>
				<xs:element name="class" type="gml:CodeType" minOccurs="0"/>
				<xs:element name="function" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="usage" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="lod0MultiCurve" type="gml:MultiCurvePropertyType" minOccurs="0"/>
				<xs:element name="lod0MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod1MultiCurve" type="gml:MultiCurvePropertyType" minOccurs="0"/>
				<xs:element name="lod1MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod1Solid" type="gml:SolidPropertyType" minOccurs="0"/>
				<xs:element name="lod2Solid" type="gml:SolidPropertyType" minOccurs="0"/>
				<xs:element name="lod3Solid" type="gml:SolidPropertyType" minOccurs="0"/>
				<xs:element name="lod4Solid" type="gml:SolidPropertyType" minOccurs="0"/>
				<xs:element name="boundedBy" type="BoundedByWaterSurfacePropertyType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element ref="_GenericApplicationPropertyOfWaterBody" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="WaterBody" type="WaterBodyType" substitutionGroup="_WaterObject"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfWaterBody" type="xs:anyType" abstract="true"/>
----

[[scls_10-6-2]]
==== Boundary surfaces

With respect to different functions and characteristics three boundary classes for water are defined to build a solid or composite surface geometry (<<fig_55>>).

. Boundary class "Air to Water". The _WaterSurface_ is mandatory to the model and usually is registered using photogrammetric analysis or mapping exploration. The representation may vary due to tidal flats or changing water levels, which can be reflected by including different static water surfaces having different _waterLevels_ (_gml:CodeType)_, as for example highest flooding event, mean sea level, or minimum water level. This offers the opportunity to describe significant water surfaces due to levels that are important for certain representations e.g. in tidal zones.
. Boundary class "Water to Ground". The _WaterGroundSurface_ may be known by sonar exploration or other depth measurements. Also part of the ground surface is the boundary "Water to Construction". The ground surface might be identical to the underwater terrain model, but also describes the contour to other underwater objects. The usefulness of this concept arises from the existence of water defence constructions like sluices, sills, flood barrage or tidal power stations. The use of _WaterGroundSurface_ as boundary layer to man-made constructions is relevant in urban situations, where such objects may enclose the modeled water body completely, for example fountains and swimming pools. The _WaterSurface_ objects together with the _WaterGroundSurface_ objects enclose the _WaterBody_ as a volume. 
. Boundary class "Water to Water". The _WaterClosureSurface_ is an optional feature that comes in use when the union of the _WaterSurfaces_ and _WaterGroundSurfaces_ of a water body does not define a closed volume. The _WaterClosureSurface_ is then used to complete the enclosure of water volumes and to separate water volumes from those where only the surface is known. This might occur, where the cross section and ground surface of rivers is partly available during its course.

&#95;__WaterBoundarySurfaces__ should only be included as parts of corresponding _WaterBody_ objects and should not be used as stand-alone objects within a CityGML model.

.AbstractWaterBoundarySurfaceType, _WaterBoundarySurface
[source%unnumbered,xml]
----
<xs:complexType name="AbstractWaterBoundarySurfaceType" abstract="true">
	<xs:complexContent>
		<xs:extension base="core:AbstractCityObjectType">
			<xs:sequence>
				<xs:element name="lod2Surface" type="gml:SurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod3Surface" type="gml:SurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod4Surface" type="gml:SurfacePropertyType" minOccurs="0"/>
				<xs:element ref="_GenericApplicationPropertyOfWaterBoundarySurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="_WaterBoundarySurface" type="AbstractWaterBoundarySurfaceType" abstract="true" 
						substitutionGroup="core:_CityObject"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfWaterBoundarySurface" type="xs:anyType" abstract="true"/>
----

.WaterSurfaceType, WaterSurface
[source%unnumbered,xml]
----
<xs:complexType name="WaterSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractWaterBoundarySurfaceType">
			<xs:sequence>
				<xs:element name="waterLevel" type="gml:CodeType" minOccurs="0"/>
				<xs:element ref="_GenericApplicationPropertyOfWaterSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="WaterSurface" type="WaterSurfaceType" substitutionGroup="_WaterBoundarySurface"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfWaterSurface" type="xs:anyType" abstract="true"/>
----

.WaterGroundSurfaceType, WaterGroundSurface
[source%unnumbered,xml]
----
<xs:complexType name="WaterGroundSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractWaterBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfWaterGroundSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="WaterGroundSurface" type="WaterGroundSurfaceType" substitutionGroup="_WaterBoundarySurface"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfWaterGroundSurface" type="xs:anyType" abstract="true"/>
----

.WaterClosureSurfaceType, WaterClosureSurface
[source%unnumbered,xml]
----
<xs:complexType name="WaterClosureSurfaceType">
	<xs:complexContent>
		<xs:extension base="AbstractWaterBoundarySurfaceType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfWaterClosureSurface" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="WaterClosureSurface" type="WaterClosureSurfaceType" substitutionGroup="_WaterBoundarySurface"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfWaterClosureSurface" type="xs:anyType" abstract="true"/>
----

[[scls_10-6-3]]
==== Code lists

The attributes _class_, _function_, and _usage_ of the feature _WaterBody_ as well as the attribute _waterLevel_ of the feature _WaterSurface_ are specified as _gml:CodeType_. The values of these properties can be enumerated in code lists. Proposals for corresponding code lists can be found in <<a_C-9>>.

[[scls_10-6-4]]
==== Conformance requirements

*Base requirements*

. For LOD0 and LOD1, the geometry of a _WaterBody_ may be modelled as a linear network using _gml:MultiCurve_ geometry elements. In that case, each _gml:MultiCurve_ shall be composed of straight line segements, where the line orientation denotes the flow direction. The flow direction is from the first point of a line segment to its last point.
. Starting from LOD2, the exterior shell of a _WaterBody_ may be semantically decomposed into &#95;__WaterBoundarySurface__ elements using the _boundedBy_ property (type: _BoundedByWaterSurfacePropertyType_) of _WaterBody_. The _boundedBy_ property shall not be used if the water body is only represented in lower LODs.
+
--
If the exterior shell is represented by &#95;__WaterBoundarySurface__ elements, an additional geometric representation as volume model using the _lodXSolid_, stem:[X in [2..4\]], property of _WaterBody_ shall not explicitly define the geometry, but has to reference the according _gml:_Surface_ elements of the &#95;__WaterBoundarySurface__ objects within each LOD using the XLink concept of GML 3.1.1.
--
. Each &#95;__WaterBoundarySurface__ element must have at least one associated surface geometry given by the _lodXSurface_, stem:[X in [2..4\]], properties of &#95;__WaterBoundarySurface__.
. &#95;__WaterBoundarySurface__ elements shall only be included as parts of corresponding _WaterBody_ elements. They may not be given as stand-alone city objects within a CityGML model.

*Referential integrity*

[start=5]
. The _boundedBy_ property (type: _BoundedByWaterSurfacePropertyType_) of the element _WaterBody_ may contain a &#95;__WaterBoundarySurface__ element inline or an XLink reference to a remote &#95;__WaterBoundarySurface__ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _boundedBy_ property may only point to a remote &#95;__WaterBoundarySurface__ element (where remote &#95;__WaterBoundarySurface__ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.



[[scls_10-7]]
=== Transportation objects

The transportation model of CityGML is a multi-functional, multi-scale model focusing on thematic and functional as well as on geometrical/topological aspects. Transportation features are represented as a linear network in LOD0. Starting from LOD1, all transportation features are geometrically described by 3D surfaces. The areal modelling of transportation features allows for the application of geometric route planning algorithms. This can be useful to determine restrictions and manoeuvres required along a transportation route. This information can also be employed for trajectory planning of mobile robots in the real world or the automatic placement of avatars (virtual people) or vehicle models in 3D visualisations and training simulators. The transportation model of CityGML is provided by the thematic extension module _Transportation_ (cf. <<cls_7>>).

The main class is _TransportationComplex_, which represents, for example, a road, a track, a railway, or a square. <<fig_57>> illustrates the four different thematic classes.

[[fig_57]]
.Representations of _TransportationComplex_ (from left to right: examples of road, track, rail, and square) (source: Rheinmetall Defence Electronics).
image::163.png[]


A _TransportationComplex_ is composed of the parts _TrafficArea_ and _AuxiliaryTrafficArea_. <<fig_58>> depicts an example for a LOD2 _TransportationComplex_ configuration within a virtual 3D city model. The _Road_ consists of several _TrafficAreas_ for the sidewalks, road lanes, parking lots, and of _AuxiliaryTrafficAreas_ below the raised flower beds.

[[fig_58]]
.Example for the representation of a _TransportationComplex_ in LOD2 in CityGML: a road, which is the aggregation of _TrafficAreas_ and _AuxiliaryTrafficAreas_ (source: City of Solingen, IGG Uni Bonn).
image::167.gif["",540,345]


<<fig_59>> depicts the UML diagram of the transportation model, for the XML schema definition see <<a_A-10>>.


[[fig_59]]
.UML diagram of the transportation model in CityGML. Prefixes are used to indicate XML namespaces associated with model elements. Element names without a prefix are defined within the CityGML _Transportation_ module.
image::168.png["",756,325]


The road itself is represented as a _TransportationComplex_, which is further subdivided into _TrafficAreas_ and _AuxiliaryTrafficAreas_. The _TrafficAreas_ are those elements, which are important in terms of traffic usage, like car driving lanes, pedestrian zones and cycle lanes. The _AuxiliaryTrafficAreas_ are describing further elements of the road, like kerbstones, middle lanes, and green areas.

_TransportationComplex_ objects can be thematically differentiated using the subclasses _Track, Road, Railway,_ and _Square._ Every _TransportationComplex_ has the attributes _class_, _function_ and _usage_ whose possible values can be enumerated in code lists (<<scls_10-7-4>> and <<a_C-8>>). The attribute _class_ describes the classification of the object, _function_ describes the purpose of the object, for example national motorway, country road, or airport, while the attribute _usage_ can be used, if the actual usage differs from the function. The attributes _function_ and _usage_ can occur multiple times.

In addition both _TrafficArea_ and _AuxiliaryTrafficArea_ may have the attributes _class_, _function_, _usage_, and _surfaceMaterial_. The attribute _class_ describes the classification of the object. For _TrafficArea, &#95;__function__ describes, if the object for example may be a car driving lane, a pedestrian zones, or a cycle lane, while the _usage_ attribute indicates which modes of transportation can use it (e.g. pedestrian, car, tram, roller skates). The attribute _surfaceMaterial_ specifies the type of pavement and may also be used for _AuxiliaryTrafficAreas_ (e.g. asphalt, concrete, gravel, soil, rail, grass). The _function_ attribute of the _AuxiliaryTrafficArea_ defines, for example kerbstones, middle lanes, or green areas. The possible values can also be specified in code lists.

The shape of each traffic area is defined by a surface geometry. Additional metadata may be defined by using attributes from pre-defined catalogues. This affects the class, function and usage of each traffic area as well as its surface material. The attribute catalogues may be customer- or country-specific. The following tables show examples for various kinds of _TrafficArea_:


[width=749,options="unnumbered"]
|===
h| Example: h| Country road h| Motorway entry
| TransportationComplex – Function | road | road
| TrafficArea – Usage | car, truck, bus, taxi, motorcycle | car, truck, bus, taxi, motorcycle
| TrafficArea – Function | driving lane | motorway_entry
| TrafficArea – SurfaceMaterial | asphalt | concrete

|===


[width=752,options="unnumbered"]
|===
h| Example: h| Runway of an airport h| Apron of an airport
| TransportationComplex – Function | road | apron
| TrafficArea – Usage | aeroplane | aeroplane, car, truck, bus, pedestrian
| TrafficArea – Function | airport – runway | airport – apron
| TrafficArea – SurfaceMaterial | concrete | concrete

|===

_TransportationComplex_ is a subclass of &#95;__TransportationObject__ and of the root class &#95;__CityObject__. The geometrical representation of the _TransportationComplex_ varies through the different levels of detail. Since _TransportationComplex_ is a subclass of &#95;__CityObject__ and hence a feature, it inherits the attribute _gml:name._ The street name is also stored within the _gml:name_ property of the _Road_ feature.

In the coarsest LOD0 the transportation complexes are modelled by line objects establishing a linear network. On this abstract level, path finding algorithms or similar analyses can be executed. It also can be used to generate schematic drawings and visualisations of the transport network. Since this abstract definition of transportation network does not contain explicit descriptions of the transportation objects, it may be task of the viewer application to generate the graphical visualisation, for example by using a library with style-definitions (width, color resp. texture) for each transportation object.

Starting from LOD1 a _TransportationComplex_ provides an explicit surface geometry, reflecting the actual shape of the object, not just its centerline. In LOD2 to LOD4, it is further subdivided thematically into _TrafficAreas_, which are used by transportation, such as cars, trains, public transport, airplanes, bicycles or pedestrians and in _AuxiliaryTrafficAreas_, which are of minor importance for transportation purposes, for example road markings, green spaces or flower tubs. The different representations of a _TransportationComplex_ for each LOD are illustrated in <<fig_60>>.

[[fig_60]]
._TransportationComplex_ in LOD0, 1, and 2-4 (example shows part of a motorway) (source: Rheinmetall Defence Electronics).
image::169.png["",600,450]



In LOD0 areal transportation objects like squares should be modelled in the same way as in GDF, the ISO standard for transportation networks, which is used in most car navigation systems. In GDF a square is typically represented as a ring surrounding the place and to which the incident roads connect. CityGML does not cover further functional aspects of transportation network models (e.g. speed limits) as it is intended to complement and not replace existing standards like GDF. However, if specific functional aspects have to be associated with CityGML transportation objects, _generic attributes_ provided by CityGML's _Generics_ module (cf. <<scls_10-12>>) can be used. Moreover, further objects of interest can be added from other information systems by the use of _ExternalReferences_ (see <<scls_6-11>>). For example, GDF datasets, which provide additional information for car navigation, can be used for simulation and visualisation of traffic flows. The values of the object attributes can be augmented or replaced using the concept of dictionaries (see <<scls_6-6>>). These directories may be country- or user-specific (especially for country-specific road signs and signals).

[[fig_61]]
._TransportationComplex_ in LOD 2-4: representation of a road with a complex cross-section profile (example shows urban road) (source: Rheinmetall Defence Electronics).
image::171.png["",468,411]



The following example shows a complex urban crossing. The picture on the left is a screenshot of an editor application for a training simulator, which allows the definition of road networks consisting of transportation objects, external references, buildings and vegetation objects. On the right, the 3D representation of the defined crossing is shown including all referenced static and dynamic models.

[[fig_62]]
.Complex urban intersection (left: linear transportation network with surface descriptions and external references, right: generated scene) (source: Rheinmetall Defence Electronics).
image::172.png["",600,298]



*XML namespace*

The XML namespace of the CityGML _Transportation_ module is identified by the Uniform Resource Identifier (URI) http://www.opengis.net/citygml/transportation/2.0. Within the XML Schema definition of the _Transportation_ module, this URI is also used to identify the default namespace.

[[scls_10-7-1]]
==== Transportation complex

.AbstractTransportationObjectType, _TransportationObject
[source%unnumbered,xml]
----
<xs:complexType name="AbstractTransportationObjectType" abstract="true">
	<xs:complexContent>
		<xs:extension base="core:AbstractCityObjectType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfTransportationObject" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="_TransportationObject" type="AbstractTransportationObjectType" abstract="true" 
						substitutionGroup="core:_CityObject"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfTransportationObject" type="xs:anyType" abstract="true"/>
----

&#95;__TransportationObject__ represents the abstract superclass for transportation objects. Future extensions of the CityGML transportation model shall be modelled as subclasses of this class.

.TransportationComplexType, TransportationComplex
[source%unnumbered,xml]
----
<xs:complexType name="TransportationComplexType">
	<xs:complexContent>
		<xs:extension base="AbstractTransportationObjectType">
			<xs:sequence>
				<xs:element name="class" type="gml:CodeType" minOccurs="0"/>
				<xs:element name="function" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="usage" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="trafficArea" type="TrafficAreaPropertyType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="auxiliaryTrafficArea" type="AuxiliaryTrafficAreaPropertyType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="lod0Network" type="gml:GeometricComplexPropertyType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="lod1MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod2MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod3MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod4MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element ref="_GenericApplicationPropertyOfTransportationComplex" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="TransportationComplex" type="TransportationComplexType" substitutionGroup="_TransportationObject"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfTransportationComplex" type="xs:anyType" abstract="true"/>
----

This type and element describe transportation complexes like roads or railways which may be aggregated from different thematic components (traffic areas, e.g. pedestrian path, and auxiliary traffic areas). As a subclass of &#95;__CityObject__, _TransportationComplex_ inherits all attributes and relations, in particular an id, names, external references, and generalisation relations. Furthermore, it represents the superclass for thematically distinct types of transportation complexes.

[[scls_10-7-2]]
==== Subclasses of transportation complexes

.TrackType, Track
[source%unnumbered,xml]
----
<xs:complexType name="TrackType">
	<xs:complexContent>
		<xs:extension base="TransportationComplexType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfTrack" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="Track" type="TrackType" substitutionGroup="TransportationComplex"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfTrack" type="xs:anyType" abstract="true"/>
----

A _Track_ is a small path mainly used by pedestrians. It is a subclass of _TransportationComplex_ and thus inherits all its attributes and relations.

.RoadType, Road
[source%unnumbered,xml]
----
<xs:complexType name="RoadType">
	<xs:complexContent>
		<xs:extension base="TransportationComplexType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfRoad" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="Road" type="RoadType" substitutionGroup="TransportationComplex"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfRoad" type="xs:anyType" abstract="true"/>
----

_Road_ is intended to be used to represent transportation features that are mainly used by vehicles like cars, for example streets, motorways, and country roads. It is a subclass of _TransportationComplex_ and thus inherits all its attributes and relations.

.RailwayType, Railway
[source%unnumbered,xml]
----
<xs:complexType name="RoadType">
	<xs:complexContent>
		<xs:extension base="TransportationComplexType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfRoad" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="Road" type="RoadType" substitutionGroup="TransportationComplex"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfRoad" type="xs:anyType" abstract="true"/>
----

_Railway_ represents routes that are utilised by rail vehicles like trams or trains. It is a subclass of _TransportationComplex_ and thus inherits all its attributes and relations.

.SquareType, Square
[source%unnumbered,xml]
----
<xs:complexType name="SquareType">
	<xs:complexContent>
		<xs:extension base="TransportationComplexType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfSquare" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="Square" type="SquareType" substitutionGroup="TransportationComplex"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfSquare" type="xs:anyType" abstract="true"/>
----

A _Square_ is an open area commonly found in cities (e.g. a plaza, market square). It is a subclass of _TransportationComplex_ and thus inherits all its attributes and relations.

[[scls_10-7-3]]
==== Subdivisions of transportation complexes

.TrafficAreaType, TrafficArea
[source%unnumbered,xml]
----
<xs:complexType name="TrafficAreaType">
	<xs:complexContent>
		<xs:extension base="AbstractTransportationObjectType">
			<xs:sequence>
				<xs:element name="class" type="gml:CodeType" minOccurs="0"/>
				<xs:element name="function" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="usage" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="surfaceMaterial" type="gml:CodeType" minOccurs="0"/>
				<xs:element name="lod2MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod3MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod4MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element ref="_GenericApplicationPropertyOfTrafficArea" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="TrafficArea" type="TrafficAreaType" substitutionGroup="_TransportationObject"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfTrafficArea" type="xs:anyType" abstract="true"/>
----

.AuxiliaryTrafficAreaType, AuxiliaryTrafficArea
[source%unnumbered,xml]
----
<xs:complexType name="AuxiliaryTrafficAreaType">
	<xs:complexContent>
		<xs:extension base="AbstractTransportationObjectType">
			<xs:sequence>
				<xs:element name="class" type="gml:CodeType" minOccurs="0"/>
				<xs:element name="function" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="usage" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="surfaceMaterial" type="gml:CodeType" minOccurs="0"/>
				<xs:element name="lod2MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod3MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod4MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element ref="_GenericApplicationPropertyOfAuxiliaryTrafficArea" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="AuxiliaryTrafficArea" type="AuxiliaryTrafficAreaType" substitutionGroup="_TransportationObject"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfAuxiliaryTrafficArea" type="xs:anyType" abstract="true"/>
----

[[scls_10-7-4]]
==== Code lists

The attributes _class_, _function_, and _usage_ of the features _TransportationComplex, TrafficArea_ and _AuxiliaryTrafficArea_ as well as the attribute _surfaceMaterial_ of the features _TrafficArea_ and _AuxiliaryTrafficArea_ are specified as _gml:CodeType_. The values of these properties can be enumerated in code lists. Proposals for corresponding code lists can be found in <<a_C-8>>.

[[scls_10-7-5]]
==== Conformance requirements

*Base requirements*

. For LOD0, the geometry of a _TransportationComplex_ shall be modelled using GML line objects representing the centerline of the transportation complex. The line objects shall establish a linear network. Thus, the _lod0Network_ property (type: _gml:GeometricComplexPropertyType_) of the element _TransportationComplex_ may only contain or reference an appropriate curve geometry element.
. Starting from LOD2, the _trafficArea_ property (type: _TrafficAreaPropertyType_) as well as the _auxiliaryTrafficArea_ property (type: _AuxiliaryTrafficAreaPropertyType_) of the element _TransportationComplex_ may be used. These properties shall not be used if the transportation complex is only represented in lower LODs.

*Referential integrity*

[start=3]
. The _trafficArea_ property (type: _TrafficAreaPropertyType_) of the element _TransportationComplex_ may contain a _TrafficArea_ element inline or an XLink reference to a remote _TrafficArea_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _trafficArea_ property may only point to a remote _TrafficArea_ element (where remote _TrafficArea_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _auxiliaryTrafficArea_ property (type: _TrafficAreaPropertyType_) of the element _TransportationComplex_ may contain an _AuxiliaryTrafficArea_ element inline or an XLink reference to a remote _AuxiliaryTrafficArea_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _auxiliaryTrafficArea_ property may only point to a remote _AuxiliaryTrafficArea_ element (where remote _AuxiliaryTrafficArea_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.





[[scls_10-8]]
=== Vegetation objects

Vegetation features are important components of a 3D city model, since they support the recognition of the surrounding environment. By the analysis and visualisation of vegetation objects, statements on their distribution, structure and diversification can be made. Habitats can be analysed and impacts on the fauna can be derived. The vegetation model may be used as a basis for simulations of, for example forest fire, urban aeration or micro climate. The model could be used, for example to examine forest damage, to detect obstacles (e.g. concerning air traffic) or to perform analysis tasks in the field of environmental protection. The vegetation model of CityGML is defined by the thematic extension module _Vegetation_ (cf. <<cls_7>>).

The vegetation model of CityGML distinguishes between solitary vegetation objects like trees and vegetation areas, which represent biotopes like forests or other plant communities (<<fig_63>>). Single vegetation objects are modelled by the class _SolitaryVegetationObject_, whereas for areas filled with a specific vegetation the class _PlantCover_ is used. The geometry representation of a _PlantCover_ feature may be a _MultiSurface_ or a _MultiSolid_, depending on the vertical extent of the vegetation. For example regarding forests, a _MultiSolid_ representation might be more appropriate. The UML diagram of the vegetation model is depicted in <<fig_64>>, for the XML schema definition see below and <<a_A-12>>.

[[fig_63]]
.Example for vegetation objects of the classes _SolitaryVegetationObject_ and _PlantCover_ (graphic: District of Recklinghausen).
image::174.png["",435,326]



A _SolitaryVegetationObject_ may have the attributes _class_, _function_, _usage_, _species height_, _trunkDiameter_ and _crownDiameter_. The attribute _class_ contains the classification of the object or plant habit, e.g. tree, bush, grass, and can occur only once (see <<scls_10-8-4>> and <<a_C-7>>). The attribute _species_ defines the species' name, for example "Abies alba", and can occur at most once (see <<scls_10-8-4>> and <<a_C-7>>). The optional attributes _function_ and _usage_ denotes the intended respectively real purpose of the object, for example botanical monument, and can occur multiple times. The possible attribute values for _class_, _species_, _function_, and _usage_ can be provided in a code list. The attribute_height_containsthe relative height of the object. The attributes _crownDiameter_ and_trunkDiameter_ represent the plant crown and trunk diameter respectively. The trunk diameter is often used in regulations of municipal cadastre (e.g. tree management rules).

A _PlantCover_ feature may have the attributes _class, function, usage_ and _averageHeight_. The plant community of a _PlantCover_ is represented by the attribute _class._ The values of this attribute can be specified in a code list (cf. <<scls_10-8-4>> and <<a_C-7>>) whose values should not only describe one plant type or species, but denote a typical mixture of plant types in a plant community. This information can be used in particular to generate realistic 3D visualisations, where the _PlantCover_ region is automatically, perhaps randomly, filled with a corresponding mixture of 3D plant objects. The attributes _function_ and _usage_ indicate the intended respectively real purpose of the object, for example national forest, and can occur multiple times. The attribute_averageHeight_denotes the average relative vegetation height.

Since both _SolitaryVegetationObject_ and _PlantCover_ are derived fom &#95;__CityObject__, they inherit all attributes of a city object, in particular a name (_gml:name)_ and an _ExternalReference_ to a corresponding object in an external information system, which may contain botanical information from public environmental agencies (see <<scls_6-7>>).

[[fig_64]]
.UML diagram of vegetation objects in CityGML. Prefixes are used to indicate XML namespaces associated with model elements. Element names without a prefix are defined within the CityGML _Vegetation_ module.
image::175.png["",755,251]



The geometry of a _SolitaryVegetationObject_ may be defined in LOD 1-4 explicitly by a GML geometry having absolute coordinates, or prototypically by an _ImplicitGeometry_ (cf. <<scls_8-2>>). Solitary vegetation objects probably are one of the most important features where implicit geometries are appropriate, since the shape of most types of vegetation objects, such as trees of the same species, can be treated as identical in most cases. Furthermore, season dependent appearances may by mapped using _ImplicitGeometry._ For visualisation purposes, only the content of the library object defining the object's shape and appearance has to be swapped (cf. <<fig_65>>).

[[fig_65]]
.Visualisation of a vegetation object in different seasons (source: District of Recklinghausen).
image::176.png["",600,450]



A _SolitaryVegetationObject_ or a _PlantCover_ may have a different geometry in each LOD. Whereas a _SolitaryVegetationObject_ is associated with the _gml_:&#95;__Geometry__ class representing an arbitrary GML geometry (by the relation _lodXGeometry_, stem:[X in [1..4\]]), a _PlantCover_ is restricted to be either a _gml:MultiSolid_ or a _gml:MultiSurface._ An example of a _PlantCover_ modelled as _gml:MultiSolid_ is a '_solid forest model'_, see <<fig_66>>.

[[fig_66]]
.Example for the visualisation/modelling of a solid forest (source: District of Recklinghausen).
image::178.png["",583,220]



*XML namespace*

The XML namespace of the CityGML _Vegetation_ module is identified by the Uniform Resource Identifier (URI) http://www.opengis.net/citygml/vegetation/2.0. Within the XML Schema definition of the _Vegetation_ module, this URI is also used to identify the default namespace.

[[scls_10-8-1]]
==== Vegetation object

.AbstractVegetationObjectType, _VegetationObject
[source%unnumbered,xml]
----
<xs:complexType name="AbstractVegetationObjectType" abstract="true">
	<xs:complexContent>
		<xs:extension base="core:AbstractCityObjectType">
			<xs:sequence>
				<xs:element ref="_GenericApplicationPropertyOfVegetationObject" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="_VegetationObject" type="AbstractVegetationObjectType" abstract="true" substitutionGroup="core:_CityObject"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfVegetationObject" type="xs:anyType" abstract="true"/>
----

[[scls_10-8-2]]
==== Solitary vegetation objects

.SolitaryVegetationObjectType, SolitaryVegetationObject
[source%unnumbered,xml]
----
<xs:complexType name="SolitaryVegetationObjectType">
	<xs:complexContent>
		<xs:extension base="AbstractVegetationObjectType">
			<xs:sequence>
				<xs:element name="class" type="gml:CodeType" minOccurs="0"/>
				<xs:element name="function" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="usage" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="species" type="gml:CodeType" minOccurs="0"/>
				<xs:element name="height" type="gml:LengthType" minOccurs="0"/>
				<xs:element name="trunkDiameter" type="gml:LengthType" minOccurs="0"/>
				<xs:element name="crownDiameter" type="gml:LengthType" minOccurs="0"/>
				<xs:element name="lod1Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod2Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod3Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod4Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod1ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element name="lod2ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element name="lod3ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element name="lod4ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element ref="_GenericApplicationPropertyOfSolitaryVegetationObject" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="SolitaryVegetationObject" type="SolitaryVegetationObjectType" substitutionGroup="_VegetationObject"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfSolitaryVegetationObject" type="xs:anyType" abstract="true"/>
----

[[scls_10-8-3]]
==== Plant cover objects

.PlantCoverType, PlantCover
[source%unnumbered,xml]
----
<xs:complexType name="PlantCoverType">
	<xs:complexContent>
		<xs:extension base="AbstractVegetationObjectType">
			<xs:sequence>
				<xs:element name="class" type="gml:CodeType" minOccurs="0"/>
				<xs:element name="function" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="usage" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="averageHeight" type="gml:LengthType" minOccurs="0"/>
				<xs:element name="lod1MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod2MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod3MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod4MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod1MultiSolid" type="gml:MultiSolidPropertyType" minOccurs="0"/>
				<xs:element name="lod2MultiSolid" type="gml:MultiSolidPropertyType" minOccurs="0"/>
				<xs:element name="lod3MultiSolid" type="gml:MultiSolidPropertyType" minOccurs="0"/>
				<xs:element name="lod4MultiSolid" type="gml:MultiSolidPropertyType" minOccurs="0"/>
				<xs:element ref="_GenericApplicationPropertyOfPlantCover" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="PlantCover" type="PlantCoverType" substitutionGroup="_VegetationObject"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfPlantCover" type="xs:anyType" abstract="true"/>
----

[[scls_10-8-4]]
==== Code lists

The attributes _class_, _function_, and _usage_ of the features _PlantCover_ and _SolitaryVegetationObject_ as well as the attribute _species_ of the feature _SolitaryVegetationObject_ are specified as _gml:CodeType_. The values of these properties can be enumerated in code lists. Proposals for corresponding code lists can be found in <<a_C-7>>.

[[scls_10-8-5]]
==== Example CityGML dataset

The following two excerpts of a CityGML dataset contain a solitary tree (_SolitaryVegetationObject)_ and a plant community (_PlantCover_). The solitary tree has the attributes: _class_ = 1070 (deciduous tree), _species_ = 1040 (Fagus/beech), _height_ = 8 m, _trunkDiameter_ = 0.7 m, _crownDiameter_ = 8.0 m. The plant community has the attributes: _class_ =1180 (isoeto-nanojuncetea), _averageHeight_ = 0.5 m. The attribute values of the _class_ and _species_ attributes are taken from code lists proposed by the SIG 3D which are presented in <<a_C-7>>.


[source%unnumbered,xml]
----
<SolitaryVegetationObject>
	<class codeSpace="http://www.sig3d.org/codelists/standard/vegetation/2.0/SolitaryVegetationObject_class.xml">1070</class>
	<species codeSpace="http://www.sig3d.org/codelists/standard/vegetation/2.0/SolitaryVegetationObject_species.xml">1040</species>
	<height uom="#m">8</height>
	<trunkDiameter uom="#m">0.7</trunkDiameter>
	<crownDiameter uom="#m">8</crownDiameter>
	<lod1ImplicitRepresentation>
		<core:ImplicitGeometry>
			<core:mimeType>1010</core:mimeType>
			<core:libraryObject>urn:sig3d:tree.wrl</core:libraryObject>
			<core:referencePoint>
				<gml:Point srsName="urn:ogc:def:crs,crs:EPSG:6.12:31466,crs:EPSG:6.12:5783">
					<gml:pos srsDimension="3">5733690.578 2571129.123 60.0</gml:pos>
				</gml:Point>
			</core:referencePoint>
		</core:ImplicitGeometry>
	</lod1ImplicitRepresentation>
</SolitaryVegetationObject>
----


[source%unnumbered,xml]
----
<PlantCover>
	<class codeSpace="http://www.sig3d.org/codelists/standard/vegetation/2.0/PlantCover_class.xml">1180</class>
	<averageHeight uom="#m">0.5</averageHeight>
	<lod1MultiSurface>
		<gml:MultiSurface>
			<gml:surfaceMember>
				<gml:Polygon srsName="urn:ogc:def:crs,crs:EPSG:6.12:31466,crs:EPSG:6.12:5783">
					<gml:exterior>
						<gml:LinearRing>
							<gml:pos srsDimension="3">5733806.146 2571329.227 60.0</gml:pos>
							<gml:pos srsDimension="3">5733754.782 2571387.011 60.0</gml:pos>
							<gml:pos srsDimension="3">5733674.527 2571374.170 60.0</gml:pos>
							<gml:pos srsDimension="3">5733670.246 2571274.653 60.0</gml:pos>
							<gml:pos srsDimension="3">5733764.413 2571243.621 60.0</gml:pos>
							<gml:pos srsDimension="3">5733806.146 2571329.227 60.0</gml:pos>
						</gml:LinearRing>
					</gml:exterior>
				</gml:Polygon>
			</gml:surfaceMember>
		</gml:MultiSurface>
		...
	</lod1MultiSurface>
</PlantCover>
----


[[scls_10-8-6]]
==== Conformance requirements

*Referential integrity*

* The _lodXImplicitRepresentation_, stem:[X in [1..4\]], property (type: _core:ImplicitRepresentationPropertyType_) of the element _SolitaryVegetationObject_ may contain a _core:ImplicitGeometry_ element inline or an XLink reference to a remote _core:ImplicitGeometry_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _lodXImplicitRepresentation_, stem:[X in [1..4\]], property may only point to a remote _core:ImplicitGeometry_ element (where remote _core:ImplicitGeometry_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.





[[scls_10-9]]
=== City furniture

City furniture objects are immovable objects like lanterns, traffic lights, traffic signs, flower buckets, advertising columns, benches, delimitation stakes, or bus stops (<<fig_67>>, <<fig_68>>). City furniture objects can be found in traffic areas, residential areas, on squares or in built-up areas. The modelling of city furniture objects is used for visualisation of, for example city traffic, but also for analysing local structural conditions. The recognition of special locations in a city model is improved by the use of these detailed city furniture objects, and the city model itself becomes more alive and animated. The city furniture model of CityGML is defined by the thematic extension module _CityFurniture_ (cf. <<cls_7>>).

City furniture objects can have an important influence on simulations of, for example city traffic situations. Navigation systems can be realised, for example for visually handicapped people using a traffic light as routing target. Likewise, city furniture objects are important to plan a heavy vehicle transportation, where the exact position and further conditions of obstacles must be known.

[[fig_67]]
.Real situation showing a bus stop (left). The advertising billboard and the refuge are modelled as _CityFurniture_ objects in the right image (source: 3D city model of Barkenberg).
image::179.png["",600,450]



[[fig_68]]
.Real situation showing lanterns and delimitation stakes (left). In the right image they are modelled as _CityFurniture_ objects with _ImplicitGeometry_ representations (source: 3D city model of Barkenberg).
image::181.png["",600,450]


The UML diagram of the city furniture model is depicted in <<fig_69>>, for the XML schema definition see below and <<a_A-5>>.

The class _CityFurniture_ may have the attributes _class, function_ and _usage_. Their possible values can be specified in corresponding code lists (<<scls_10-9-2>> and <<a_C-4>>). The _class_ attribute allows an object classification like traffic light, traffic sign, delimitation stake, or garbage can, and can occur only once. The _function_ attribute describes, to which thematic area the city furniture object belongs to (e.g. transportation, traffic regulation, architecture), and can occur multiple times. The attribute _usage_ denotes the real purpose of the object.

[[fig_69]]
.UML diagram of city furniture objects in CityGML. Prefixes are used to indicate XML namespaces associated with model elements. Element names without a prefix are defined within the CityGML _CityFurniture_ module.
image::183.png["",755,268]



Since _CityFurniture_ is a subclass of &#95;__CityObject__ and hence is a feature, it inherits the attribute _gml:name._ As with any &#95;__CityObject__, _CityFurniture_ objects may be assigned _ExternalReferences_(cf. <<scls_6-7>>) and may be augmented by _generic attributes_ using CityGML's _Generics_ module (cf. <<scls_10-12>>). For _ExternalReferences_ city furniture objects can have links to external thematic databases. Thereby, semantic information of the objects, which cannot be modelled in CityGML, can be transmitted and used in the 3D city model for further processing, for example information from systems of powerlines or pipelines, traffic sign cadaster, or water resources for disaster management.

City furniture objects can be represented in city models with their specific geometry, but in most cases the same kind of object has an identical geometry. The geometry of _CityFurniture_ objects in LOD 1-4 may be represented by an explicit geometry (_lodXGeometry_ where _X_ is between 1 and 4) or an _ImplicitGeometry_ object (_lodXImplicitRepresentation_ with _X_ between 1 and 4). Following the concept of _ImplicitGeometry_ the geometry of a prototype city furniture is stored only once in a local coordinate system and referenced by other city furniture features (see <<scls_8-2>>). Spatial information of city furniture objects can be taken, for example, from city maps or from public and private external information systems.

In order to specify the exact intersection of the DTM with the 3D geometry of a city furniture object, the latter can have a _TerrainIntersectionCurve_ (TIC) for each LOD (cf. <<scls_6-5>>). This allows for ensuring a smooth transition between the DTM and the city furniture object.

*XML namespace*

The XML namespace of the CityGML _CityFurniture_ module is identified by the Uniform Resource Identifier (URI) http://www.opengis.net/citygml/cityfurniture/2.0. Within the XML Schema definition of the _CityFurniture_ module, this URI is also used to identify the default namespace.

[[scls_10-9-1]]
==== City furniture object

.CityFurnitureType, CityFurniture
[source%unnumbered,xml]
----
<xs:complexType name="CityFurnitureType">
	<xs:complexContent>
		<xs:extension base="core:AbstractCityObjectType">
			<xs:sequence>
				<xs:element name="class" type="gml:CodeType" minOccurs="0"/>
				<xs:element name="function" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="usage" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="lod1Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod2Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod3Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod4Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod1TerrainIntersection" type="gml:MultiCurvePropertyType" minOccurs="0"/>
				<xs:element name="lod2TerrainIntersection" type="gml:MultiCurvePropertyType" minOccurs="0"/>
				<xs:element name="lod3TerrainIntersection" type="gml:MultiCurvePropertyType" minOccurs="0"/>
				<xs:element name="lod4TerrainIntersection" type="gml:MultiCurvePropertyType" minOccurs="0"/>
				<xs:element name="lod1ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element name="lod2ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element name="lod3ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element name="lod4ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element ref="_GenericApplicationPropertyOfCityFurniture" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="CityFurniture" type="CityFurnitureType" substitutionGroup="core:_CityObject"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfCityFurniture" type="xs:anyType" abstract="true"/>
----

[[scls_10-9-2]]
==== Code lists

The attributes _class_, _function_, and _usage_ of the feature _CityFurniture_ are specified as _gml:CodeType_. The values of these properties can be enumerated in code lists. Proposals for corresponding code lists can be found in <<a_C-4>>.

[[scls_10-9-3]]
==== Example CityGML dataset

The following example of a CityGML dataset is an extract of the model of a delimitation stake in LOD3 and contains the attributes _class_ = 1000 and _function_ = 1520 (delimitation stake) whose coded attribute values are taken from a code list proposed by the SIG 3D (cf. <<a_C-4>>). The delimitation stake with the object ID _stake0815_ has an _ExternalReference_ pointing to a cadastre object within the German ALKIS database (www.adv-online.de) which is identified by the URI _urn:adv:oid:DEHE123400007001_.

The example dataset shows the geometry of the top surface (_gml:id_ "cover") and of the left surface (_gml:id_ "surfLeft") of the stake which are both depicted in <<fig_70>>. The top surface is assigned a constant material (white color) and the left surfaceis textured using the texture image _stake.gif_ by denoting the relevant texture coordinates. Both surface appearances are modelled using the CityGML _Appearance_ module (cf. <<cls_9>>).

[[fig_70]]
.Example of a simple city furniture object (source: District of Recklinghausen).
image::184.png["",241,360]



[source%unnumbered,xml]
----
<!-- delimitation stake in LOD3 -->
<CityFurniture gml:id="stake0815">
	<core:externalReference>
		<core:informationSystem>http://www.adv-online.de</core:informationSystem>
		<!-- Reference to ALKIS -->
		<core:externalObject>
			<core:uri>urn:adv:oid:DEHE123400007001</core:uri>
			<!-- ALKIS Object ID -->
		</core:externalObject>
	</core:externalReference>
	<app:appearance>
		<app:Appearance>
			<app:surfaceDataMember>
				<app:X3DMaterial>
					<app:ambientIntensity>0.4</app:ambientIntensity>
					<app:diffuseColor>1.0  1.0  1.0</app:diffuseColor>
					<app:target>#cover</app:target>
				</app:X3DMaterial>
			</app:surfaceDataMember>
			<app:surfaceDataMember>
				<app:ParameterizedTexture>
					<app:imageURI>stake.gif</app:imageURI>
					<app:textureType>typical</app:textureType>
					<app:target uri="#surfLeft">
						<app:TexCoordList>
							<app:textureCoordinates ring="#surfLeft_ring1"> 
								0.000 0.000 1.000 0.000 1.000 1.000 0.000 1.000 0.000 0.000
							</app:textureCoordinates>
						</app:TexCoordList>
					</app:target>
				</app:ParameterizedTexture>
			</app:surfaceDataMember>
		</app:Appearance>
	</app:appearance>
	<class codeSpace="http://www.sig3d.org/codelists/standard/cityfurniture/2.0/CityFurniture_class.xml">1000</class>
	<!-- 1000 = traffic  -->
	<function codeSpace="http://www.sig3d.org/codelists/standard/cityfurniture/2.0/CityFurniture_function.xml">1520</function>
	<!-- 1520 = boundary post  -->
	<lod3Geometry>
		<!--Stake 0.06x0.06x1.2-->
		<gml:Solid srsName="urn:ogc:def:crs,crs:EPSG:6.12:31466,crs:EPSG:6.12:5783">
			<gml:exterior>
				<gml:CompositeSurface>
					<gml:surfaceMember>
					<gml:Polygon gml:id="cover">
							<gml:exterior>
								<!-- Cover-Surface  -->
								<gml:LinearRing>
									<gml:pos>5733500.060 2572400.060 61.200</gml:pos>
									<gml:pos>5733500.060 2572400.000 61.200</gml:pos>
									<gml:pos>5733500.000 2572400.000 61.200</gml:pos>
									<gml:pos>5733500.000 2572400.060 61.200</gml:pos>
									<gml:pos>5733500.060 2572400.060 61.200</gml:pos>
								</gml:LinearRing>
							</gml:exterior>
						</gml:Polygon>
					</gml:surfaceMember>
					<gml:surfaceMember>
						<gml:Polygon gml:id="surfLeft">
							<gml:exterior>
								<!-- Surface left  -->
								<gml:LinearRing gml:id="surfLeft_ring1">
									<gml:pos>5733500.060 2572400.000 60.000</gml:pos>
									<gml:pos>5733500.000 2572400.000 60.000</gml:pos>
									<gml:pos>5733500.000 2572400.000 61.200</gml:pos>
									<gml:pos>5733500.060 2572400.000 61.200</gml:pos>
									<gml:pos>5733500.060 2572400.000 60.000</gml:pos>
								</gml:LinearRing>
							</gml:exterior>
						</gml:Polygon>
					</gml:surfaceMember>
					...
				</gml:CompositeSurface>
			</gml:exterior>
		</gml:Solid>
	</lod3Geometry>
</CityFurniture>
----

[[scls_10-9-4]]
==== Conformance requirements

*Referential integrity*

* The _lodXImplicitRepresentation_, stem:[X in [1..4\]], property (type: _core:ImplicitRepresentationPropertyType_) of the element _CityFurniture_ may contain a _core:ImplicitGeometry_ element inline or an XLink reference to a remote _core:ImplicitGeometry_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _lodXImplicitRepresentation_, stem:[X in [1..4\]], property may only point to a remote _core:ImplicitGeometry_ element (where remote _core:ImplicitGeometry_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.



[[scls_10-10]]
=== Land use

_LandUse_ objects can be used to describe areas of the earth's surface dedicated to a specific land use, but also to describe areas of the earth's surface having a specific land cover with or without vegetation, such as sand, rock, mud flats, forest, grasslands, etc (i.e. the physical appearance). Land use and land cover are different concepts; the first describes human activities on the earth's surface, the second describes its physical and biological cover. However, the two are interlinked and often mixed in practice. _LandUse_ objects in CityGML represent both concepts: They can be employed to represent, parcels, spatial planning objects, recreational objects and objects describing the physical characteristics of an area, in 3D (e.g. wetlands). <<fig_71>> shows the UML diagram of land use objects, for the XML schema definition see <<scls_10-10-1>> and <<a_A-8>>. The land use model of CityGML is provided by the thematic extension module _LandUse_ (cf. <<cls_7>>).

[[fig_71]]
.UML diagram of land use objects in CityGML. Prefixes are used to indicate XML namespaces associated with model elements. Element names without a prefix are defined within the CityGML _LandUse_ module.
image::185.png["",613,223]


Every _LandUse_ object may have the attributes _class_, _function_, and _usage_. The _class_ attribute is used to represent the classification of land use objects, like settlement area, industrial area, farmland etc., and can occur only once. The possible values can be specified in a code list (cf. <<a_C-5>>). The attribute _function_ defines the purpose of the object or their nature, like e.g. cornfield or heath, while the attribute _usage_ can be used, if the way the object is actually used differs from the function. Both attributes can occur multiple times.

The _LandUse_ object is defined for all LOD 0-4 and may have different geometries in any LOD. The surface geometry of a _LandUse_ object is required to have 3D coordinate values. It must be a GML3 _MultiSurface_, which might be assigned appearance properties like textures or colors (using CityGML's appearance model, cf. <<cls_9>>).

_LandUse_ objects can be employed to establish a coherent geometric/semantical tesselation of the earth's surface. In this case topological relations between neighbouring _LandUse_ objects should be made explicit by defining the boundary _LineStrings_ only once and by referencing them in the corresponding _Polygons_ using XLinks (cf. <<scls_8-1>>). <<fig_72>> shows a land use tesselation, where the geometries of the land use objects are represented as triangulated surfaces. In fact, they are the result of a constrained triangulation of a DTM with consideration of breaklines defined by a 2D vector map of land use classifications.

[[fig_72]]
.LOD0 regional model consisting of land use objects in CityGML (source: IGG Uni Bonn).
image::186.png["",600,600]


*XML namespace*

The XML namespace of the CityGML _LandUse_ module is identified by the Uniform Resource Identifier (URI) http://www.opengis.net/citygml/landuse/2.0. Within the XML Schema definition of the _LandUse_ module, this URI is also used to identify the default namespace.


[[scls_10-10-1]]
==== Land use object

.LandUseType, LandUse
[source%unnumbered,xml]
----
<xs:complexType name="LandUseType">
	<xs:complexContent>
		<xs:extension base="core:AbstractCityObjectType">
			<xs:sequence>
				<xs:element name="class" type="gml:CodeType" minOccurs="0"/>
				<xs:element name="function" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="usage" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="lod0MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod1MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod2MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod3MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element name="lod4MultiSurface" type="gml:MultiSurfacePropertyType" minOccurs="0"/>
				<xs:element ref="_GenericApplicationPropertyOfLandUse" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="LandUse" type="LandUseType" substitutionGroup="core:_CityObject"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfLandUse" type="xs:anyType" abstract="true"/>
----

[[scls_10-10-2]]
==== Code lists

The attributes _class_, _function_, and _usage_ of the feature _LandUse_ are specified as _gml:CodeType_. The values of these properties can be enumerated in code lists. Proposals for corresponding code lists can be found in <<a_C-5>>.

[[scls_10-10-3]]
==== Conformance requirements

*Base requirements*

* The _gml:MultiSurface_ geometry element representing the geometry of a _LandUse_ object must be given with 3D coordinate values within each LOD.



[[scls_10-11]]
=== City object groups

The CityGML grouping concept has been introduced in <<scls_6-8>>. _CityObjectGroups_ are modelled using the Composite Design Patternfrom software engineering (cf. Gamma et al. 1995): _CityObjectGroups_ aggregate _CityObjects_ and furthermore are defined as special _CityObjects_. This implies that a group may become a member of another group realizing a recursive aggregation schema. However, in a CityGML instance document it has to be ensured (by the generating application) that no cyclic groupings are included. <<fig_73>> shows the UML diagram for the class _CityObjectGroup,_ forthe XML schema see <<a_A-6>>. The grouping concept of CityGML is defined by the thematic extension module _CityObjectGroup_ (cf. <<cls_7>>).

[[fig_73]]
.UML diagram of city object groups in CityGML. Prefixes are used to indicate XML namespaces associated with model elements. Element names without a prefix are defined within the CityGML _CityObjectGroup_ module.
image::187.png["",445,256]



The class _CityObjectGroup_ has the optional attributes _class, function_ and _usage._ The _class_ attribute allows a group classification with respect to the stated function and may occur only once. The _function_ attribute is intended to express the main purpose of a group, possibly to which thematic area it belongs (e.g. site, building, transportation, architecture, unknown etc.). The attribute _usage_ can be used, if the way the object is actually used differs from the function. Both attributes can occur multiple times. Each member of a group may be qualified by a _role_ name, reflecting the role each &#95;__CityObject__ plays in the context of the group. Furthermore, a _CityObjectGroup_ can optionally be assigned an arbitrary geometry object from the GML3 subset shown in <<fig_9>> in <<scls_8-1>>. This may be used to represent a generalised geometry generated from the members geometries.

The parent association linking a _CityObjectGroup_ to a &#95;__CityObject__ allows for the modelling of a generic hierarchical grouping concept. Named aggregations of components (CityObjects) can be added to specific CityObjects considered as the parent object. The parent association links to the aggregate, while the parts are given by the group members. This concept is used, for example, to represent storeys in buildings (see <<scls_10-3-6>>: Modelling building storeys using CityObjectGroups).

*XML namespace*

The XML namespace of the CityGML _CityObjectGroup_ module is identified by the Uniform Resource Identifier (URI) http://www.opengis.net/citygml/cityobjectgroup/2.0. Within the XML Schema definition of the _CityObjectGroup_ module, this URI is also used to identify the default namespace.


[[scls_10-11-1]]
==== City object group

.CityObjectGroupType, CityObjectGroup
[source%unnumbered,xml]
----
<xs:complexType name="CityObjectGroupType">
	<xs:complexContent>
		<xs:extension base="core:AbstractCityObjectType">
			<xs:sequence>
				<xs:element name="class" type="gml:CodeType" minOccurs="0"/>
				<xs:element name="function" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="usage" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="groupMember" type="CityObjectGroupMemberType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="parent" type="CityObjectGroupParentType" minOccurs="0"/>
				<xs:element name="geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element ref="_GenericApplicationPropertyOfCityObjectGroup" minOccurs="0" maxOccurs="unbounded"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="CityObjectGroup" type="CityObjectGroupType" substitutionGroup="core:_CityObject"/>
<!-- ========================================================================================= -->
<xs:element name="_GenericApplicationPropertyOfCityObjectGroup" type="xs:anyType" abstract="true"/>
<!-- ========================================================================================= -->
<xs:complexType name="CityObjectGroupMemberType">
	<xs:sequence minOccurs="0">
		<xs:element ref="core:_CityObject"/>
	</xs:sequence>
	<xs:attribute name="role" type="xs:string"/>
	<xs:attributeGroup ref="gml:AssociationAttributeGroup"/>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:complexType name="CityObjectGroupParentType">
	<xs:sequence minOccurs="0">
		<xs:element ref="core:_CityObject"/>
	</xs:sequence>
	<xs:attributeGroup ref="gml:AssociationAttributeGroup"/>
</xs:complexType>
----

[[scls_10-11-2]]
==== Code lists

The attributes _class_, _function_, and _usage_ of the feature _CityObjectGroup_ are specified as _gml:CodeType_. The values of these properties can be enumerated in code lists. Proposals for corresponding code lists can be found in <<a_C-10>>.

[[scls_10-11-3]]
==== Conformance requirements

*Base requirements*

. No cyclic groupings shall be included within a CityGML instance document.

*Referential integrity*

[start=2]
. The _groupMember_ property (type: _CityObjectGroupMemberType_) of the element _CityObjectGroup_ may contain a _core:_CityObject_ element inline or an XLink reference to a remote _core:_CityObject_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _groupMember_ property may only point to a remote _core:_CityObject_ element (where remote _core:_CityObject_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.
. The _parent_ property (type: _CityObjectGroupParentType_) of the element _CityObjectGroup_ may contain a _core:_CityObject_ element inline or an XLink reference to a remote _core:_CityObject_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _parent_ property may only point to a remote _core:_CityObject_ element (where remote _core:_CityObject_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.



[[scls_10-12]]
=== Generic city objects and attributes

The concept of generic city objects and attributes allows for the storage and exchange of 3D objects which are not covered by any explicitly modelled thematic class within CityGML or which require attributes not represented in CityGML. These generic extensions to the CityGML data model are realised by the classes _GenericCityObject_ and &#95;__genericAttribute__ defined within the thematic extension module _Generics_ (cf. <<cls_7>>). In order to avoid problems concerning semantic interoperability, generic extensions shall only be used if appropriate thematic classes or attributes are not provided by any other CityGML module.

<<fig_74>> shows the UML diagram of generic objects and attributes. For XML schema definition see below and <<a_A-7>>.

[[fig_74]]
.UML diagram of generic objects and attributes in CityGML. Prefixes are used to indicate XML namespaces associated with model elements. Element names without a prefix are defined within the CityGML _Generics_ module.
image::188.png["",756,409]



Generic attributes are name-value pairs associated with a city object. Each generic attribute has a mandatory _name_ identifier which can be freely chosen. The data type of the attribute value may be _String_, _Integer_, _Double_ (floating point number), _URI, Date,_ and _gml:MeasureType_. The attribute type is defined by the selection of the particular subclass of &#95;__genericAttribute__, for example _stringAttribute_, _intAttribute_, etc. A _measureAttribute_ facilitates the representation of measured values. Its value is of the structured type _gml:MeasureType_ which provides an optional attribute _uom_ (units of measure) of type _xs:anyURI_ that points to a reference system for the amount.

Generic attributes can be grouped under a common name using a _genericAttributeSet_. The _genericAttributeSet_ class is derived from &#95;__genericAttribute__ and thus is also realized as generic attribute. Its value is the set of contained generic attributes and its _name_ property provides a name identifier for the entire set. Since _genericAttributeSet_ is itself a generic attribute, it may also be contained in a generic attribute set facilitating a recursive nesting of arbitrary depth. The optional _codeSpace_ attribute (of type _xs:anyURI_) of _genericAttributeSet_ is used to associate the attribute set with an authority, e.g. the organisation or community who defined the attribute set and its contained attributes. By this means, generic attribute sets can be clearly distinguished even if they share the same name.

In order to model generic attributes, the abstract base class &#95;__CityObject__ defined within the _CityGML Core_ module is augmented by the additional property element &#95;__genericAttribute__ using CityGML's _Application Domain Extension_ mechanism (cf. <<scls_6-12>>). By this means, each thematic subclass of &#95;__CityObject__ inherits this property and, thus, may be assigned an arbitrary number of generic attributes in order to represent additional properties of features not represented by the explicitly modelled thematic classes of the CityGML data model. Thus, the _Generics_ module has a deliberate impact on all CityGML extension modules defining thematic subclasses of &#95;__CityObject__.

A _GenericCityObject_ may have the attributes _class, function_ and _usage_ defined as _gml:CodeType_. The _class_ attribute allows an object classification within the thematic area such as pipe, power line, dam, or unknown. The _function_ attribute describes to which thematic area the _GenericCityObject_ belongs (e.g. site, transportation, architecture, energy supply, water supply, unknown etc.). The attribute _usage_ can be used, if the way the object is actually used differs from the function. Both attributes can occur multiple times.

The geometry of a _GenericCityObject_ can either be an explicit GML3 geometry or an _ImplicitGeometry_ (see <<scls_8-2>>)_._ In the case of an explicit geometry the object can have only one geometry for each LOD, which may be an arbitrary 3D GML geometry object (class _gml:&#95;__Geometry__, which is the base class of all GML geometries, _lodXGeometry_, stem:[X in [0..4\]]). Absolute coordinates according to the reference system of the city model must be given for the explicit geometry. In the case of an _ImplicitGeometry_, a reference point (anchor point) of the object and optionally a transformation matrix must be given. In order to compute the actual location of the object, the transformation of the local coordinates into the reference system of the city model must be processed and the anchor point coordinates must be added. The shape of an _ImplicitGeometry_ can be given as an external resource with a proprietary format, e.g. a VRML or DXF file from a local file system or an external web service. Alternatively the shape can be specified as a 3D GML3 geometry with local cartesian coordinates using the property _relativeGeometry_ (further details are given in <<scls_8-2>>).

In order to specify the exact intersection of the DTM with the 3D geometry of a _GenericCityObject_, the latter can have _TerrainIntersectionCurves_ for every LOD (cf. <<scls_6-5>>). This is important for 3D visualisation but also for certain applications like driving simulators. For example, if a city wall (e.g., the Great Wall of China) should be represented as a _GenericCityObject_, a smooth transition between the DTM and the city wall would have to be ensured.

*XML namespace*

The XML namespace of the CityGML _Generics_ module is identified by the Uniform Resource Identifier (URI) http://www.opengis.net/citygml/generics/2.0. Within the XML Schema definition of the _Generics_ module, this URI is also used to identify the default namespace.

[[scls_10-12-1]]
==== Generic city object

.GenericCityObjectType, GenericCityObject
[source%unnumbered,xml]
----
<xs:complexType name="GenericCityObjectType">
	<xs:complexContent>
		<xs:extension base="core:AbstractCityObjectType">
			<xs:sequence>
				<xs:element name="class" type="gml:CodeType" minOccurs="0"/>
				<xs:element name="function" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="usage" type="gml:CodeType" minOccurs="0" maxOccurs="unbounded"/>
				<xs:element name="lod0Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod1Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod2Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod3Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod4Geometry" type="gml:GeometryPropertyType" minOccurs="0"/>
				<xs:element name="lod0TerrainIntersection" type="gml:MultiCurvePropertyType" minOccurs="0"/>
				<xs:element name="lod1TerrainIntersection" type="gml:MultiCurvePropertyType" minOccurs="0"/>
				<xs:element name="lod2TerrainIntersection" type="gml:MultiCurvePropertyType" minOccurs="0"/>
				<xs:element name="lod3TerrainIntersection" type="gml:MultiCurvePropertyType" minOccurs="0"/>
				<xs:element name="lod4TerrainIntersection" type="gml:MultiCurvePropertyType" minOccurs="0"/>
				<xs:element name="lod0ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element name="lod1ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element name="lod2ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element name="lod3ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
				<xs:element name="lod4ImplicitRepresentation" type="core:ImplicitRepresentationPropertyType" minOccurs="0"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="GenericCityObject" type="GenericCityObjectType" substitutionGroup="core:_CityObject"/>
----

[[scls_10-12-2]]
==== Generic attributes

.AbstractGenericAttributeType, _genericAttribute, StringAttributeType, stringAttribute, etc.
[source%unnumbered,xml]
----
<xs:complexType name="AbstractGenericAttributeType" abstract="true">
	<xs:sequence/>
	<xs:attribute name="name" type="xs:string" use="required"/>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="_genericAttribute" type="AbstractGenericAttributeType" abstract="true"
						substitutionGroup="core:_GenericApplicationPropertyOfCityObject"/>
<!-- ========================================================================================= -->
<xs:complexType name="StringAttributeType">
	<xs:complexContent>
		<xs:extension base="AbstractGenericAttributeType">
			<xs:sequence>
				<xs:element name="value" type="xs:string"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="stringAttribute" type="StringAttributeType" substitutionGroup="_genericAttribute"/>
<!-- ========================================================================================= -->
<xs:complexType name="IntAttributeType">
	<xs:complexContent>
		<xs:extension base="AbstractGenericAttributeType">
			<xs:sequence>
				<xs:element name="value" type="xs:integer"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="intAttribute" type="IntAttributeType" substitutionGroup="_genericAttribute"/>
<!-- ========================================================================================= -->
<xs:complexType name="DoubleAttributeType">
	<xs:complexContent>
		<xs:extension base="AbstractGenericAttributeType">
			<xs:sequence>
				<xs:element name="value" type="xs:double"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="doubleAttribute" type="DoubleAttributeType" substitutionGroup="_genericAttribute"/>
<!-- ========================================================================================= -->
<xs:complexType name="DateAttributeType">
	<xs:complexContent>
		<xs:extension base="AbstractGenericAttributeType">
			<xs:sequence>
				<xs:element name="value" type="xs:date"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="dateAttribute" type="DateAttributeType" substitutionGroup="_genericAttribute"/>
<!-- ========================================================================================= -->
<xs:complexType name="UriAttributeType">
	<xs:complexContent>
		<xs:extension base="AbstractGenericAttributeType">
			<xs:sequence>
				<xs:element name="value" type="xs:anyURI"/>
			</xs:sequence>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="uriAttribute" type="UriAttributeType" substitutionGroup="_genericAttribute"/>
<!-- ========================================================================================= -->
<xs:complexType name="MeasureAttributeType">
	<xs:complexContent>
		<xs:extension base="AbstractGenericAttributeType">
----

.GenericAttributeSetType, genericAttributeSet
[source%unnumbered,xml]
----
<xs:complexType name="GenericAttributeSetType">
	<xs:complexContent>
		<xs:extension base="AbstractGenericAttributeType">
			<xs:sequence>
				<xs:element ref="_genericAttribute" minOccurs="1" maxOccurs="unbounded"/>
			</xs:sequence>
			<xs:attribute name="codeSpace" type="xs:anyURI" use="optional"/>
		</xs:extension>
	</xs:complexContent>
</xs:complexType>
<!-- ========================================================================================= -->
<xs:element name="genericAttributeSet" type="GenericAttributeSetType" substitutionGroup="_genericAttribute"/>
----

[[scls_10-12-3]]
==== Code lists

The attributes _class_, _function_, and _usage_ of the feature _GenericCityObject_ are specified as _gml:CodeType_. The values of these properties can be enumerated in code lists.

[[scls_10-12-4]]
==== Conformance requirements

===== Usage restriction for generic city objects and attributes

. The _GenericCityObject_ element may only be used to model thematic city objects which are not provided by any other CityGML module and, thus, are not covered by the overall CityGML data model. If an appropriate thematic class is available though, this thematic class shall be used instead, and, consequently, the corresponding CityGML module has to be employed by the CityGML instance document.
. The &#95;__genericAttribute__ property of the element _core_: &#95;__CityObject__ shall only be used to describe additional properties of features not represented by the explicitly modelled thematic classes of the CityGML data model. Thus, generic attributes shall only be modelled if the appropriate thematic class representing the feature does not offer a feasible property.

*Referential integrity*

[start=3]
. The _lodXImplicitRepresentation_, stem:[X in [0..4\]], property (type: _core:ImplicitRepresentationPropertyType_) of the element _GenericCityObject_ may contain a _core:ImplicitGeometry_ element inline or an XLink reference to a remote _core:ImplicitGeometry_ element using the XLink concept of GML 3.1.1. In the latter case, the _xlink:href_ attribute of the _lodXImplicitRepresentation_, stem:[X in [0..4\]], property may only point to a remote _core:ImplicitGeometry_ element (where remote _core:ImplicitGeometry_ elements are located in another document or elsewhere in the same document). Either the contained element or the reference must be given, but neither both nor none.



[[scls_10-13]]
=== Application Domain Extensions (ADE)

CityGML has been designed as an application independent information model and exchange format for 3D city and landscape models. However, specific applications typically have additional information needs to be modelled and exchanged. In general, there are two different approaches to combine city model data and application data:

. Embed the CityGML objects into a (larger) application framework and establish the connection between application data and CityGML data within the application framework. For example, CityGML data fragments may be embedded into the application's XML data files or stored as attributes of application objects according to the application's data model.
. Incorporate application specific information into the CityGML instance documents. This approach is especially feasible, if the application specific information follows essentially the same structure as defined by the CityGML schema. This is the case, if the application data could be represented by additional attributes of CityGML objects and only some new feature types would have to be defined.

In the following, we will focus on the second option, as only this approach lies within the scope of this specification. Generic attributes and objects have already been introduced as a first possibility to support the exchange of application specific data (see section 10.12). Whereas they allow to extend CityGML without changing its XML schema definition, this flexibility has some disadvantages:

* Generic attributes and objects may occur arbitrarily in the CityGML instance documents, but there is no formal specification of the names, datatypes, and multiplicities. Thus, there is no guarantee for an application that a specific instance of a generic attribute is included a minimum or maximum number of times per CityGML feature. Unlike the predefined CityGML objects, the concrete layout and occurrence of generic objects and attributes cannot be validated by an XML parser. This may reduce semantic interoperability.
* Naming conflicts of generic attributes or objects can occur, if the CityGML instance documents should be augmented by specific information from different applications simultaneously. 
* There is only a limited number of predefined data types that can be used for generic attributes. Also the structure of generic objects might not be appropriate to represent more complex objects.

If application specific information are well-structured, it is desirable to represent them in a systematic way, i. e. by the definition of an extra formal schema based on the CityGML schema definitions. Such an XML schema is called a CityGML _Application Domain Extension_ (ADE). It allows to validate instance documents both against the extended CityGML and the ADE schema and therefore helps to maintain semantic and syntactic interoperability between different systems working in the same application field. In order to prevent naming conflicts, every ADE has to be defined within its own namespace which must differ from the namespaces associated with the CityGML modules. An ADE schema may extend one or more CityGML module schemas. The relevant CityGML module schemas have to be imported by the ADE schema.

The ADE concept defines a special way of extending existing CityGML feature types which allows to use different ADEs within the same instance document simultaneously (see below). For example, the specification of ADEs can be useful in the following application fields: cultural heritage (extension of abstract class &#95;__CityObject__ e.g. by time period information and monument protection status); representation of subsurface objects (tunnel, underpass) or city lighting (light sources like street lamps and house lights); real estate management (economic parameters of the CityGML features; inclusion of attributes defined for real estate assets as defined by OSCRE); utility networks (as topographic features); additional building properties as defined by the U.S. national building information model standard (NBIMS).

[[scls_10-13-1]]
==== Technical principle of ADEs

Each ADE is specified by its own XML schema file. The target namespace is provided by the information community who specifies the CityGML ADE. This is typically not the OGC or the SIG 3D. The namespace should be in the control of this information community and must be given as a previously unused and globally unique URI. This URI will be used in CityGML ADE instance documents to distinguish extensions from CityGML base elements. As the URI refers to the information community it also denotes the originator of the employed ADE.

The ADE's XML schema file must be available (or accessible on the Internet) to everybody creating and parsing CityGML instance documents including these ADE specific augmentations.

An ADE XML schema can define various extensions to CityGML. However, all extensions shall belong to one of the two following categories:

. New feature types are defined within the ADE namespace and are based on CityGML abstract or concrete classes. In general, this mechanism follows the same principles as the definition of application schemas for GML. This means, that new feature types have to be derived from existing (here: CityGML) feature types. For example, new feature types could be defined by classes derived from the abstract classes like &#95;__CityObject__ or &#95;__AbstractBuilding__ or the concrete class _CityFurniture_. The new feature types then automatically inherit all properties (i.e. attributes) and associations (i.e. relations) from the respective CityGML superclasses.
. Existing CityGML feature types are extended by application specific properties (in the ADE namespace). These properties may have simple or complex data types. Also geometries or embedded features (feature properties) are possible. The latter can also be used to model relations to other features.
+
--
In this case, extension of the CityGML feature type is not being realised by the inheritance mechanism of XML schema. Instead, every CityGML feature type provides a "hook" in its XML schema definition, that allows to attach additional properties to it by ADEs. This "hook" is implemented as a GML property of the form "&#x0005F;GenericApplicationPropertyOf__&lt;Featuretypename&gt;__&#x200c;" where __&lt;Featuretypename&gt;__ is equal to the name of the feature type definition in which it is included. The datatype for these kinds of properties is always "xsd:anyType" from the XSD namespace. The minimum occurrence of the "&#x0005F;GenericApplicationPropertyOf__&lt;Featuretypename&gt;__&#x200c;" is 0 and the maximum occurrence unbounded. This means, that the CityGML schema allows that every CityGML feature may have an arbitrary number of additional properties with arbitrary XML content with the name "&#x0005F;GenericApplicationPropertyOf__&lt;Featuretypename&gt;__&#x200c;". For example, the last property in the definition of the CityGML feature type __LandUse__ is the element &#95;__GenericApplicationPropertyOfLandUse__ (cf. <<scls_10-10-1>>).

Such properties are called "hooks" to attach application specific properties, because they are used as the head of a substitution group by ADEs. Whenever an ADE wants to add an extra property to an existing CityGML feature type, it should declare the respective element with the appropriate dataype within the ADE namespace. In the element declaration this element shall be explicitly assigned to the substitution group defined by the corresponding "_GenericApplicationPropertyOf__&lt;Featuretypename&gt;__&#x200c;" in the corresponding CityGML module namespace. An example is given in the following subsection.

By following this concept, it is possible to specify different ADEs for different information communities. Every ADE may add their specific properties to the same CityGML feature type as they all can belong to the same substitution group. This allows to have CityGML instance documents where CityGML features contain additional information from different ADEs simultaneously.
--

Please note that usage of ADEs introduces an extra level of complexity as data files may contain mixed information (features, properties) from different namespaces, not only from the GML and CityGML module namespaces. However, extended CityGML instance documents are quite easy to handle by applications that are not "schema-aware", i.e. applications that do not parse and interpret GML application schemas in a generic way. These applications can simply skip anything from a CityGML instance document that is not from a CityGML module or GML namespace. Thus, a building is still represented by the _&lt;bldg:Building&gt;_ element with the standard CityGML properties, but with possibly some extra properties from different namespaces. Also features from a different namespace than those declared by CityGML modules or GML could be skipped (e.g. by a viewer application).

[[scls_10-13-2]]
==== Example ADE

In this section, the ADE mechanism is illustrated by a short example, which deals with the application of virtual 3D city models to generate noise pollution maps. In our example, two extensions of CityGML are required for this task: buildings have to be extended to represent a "noise reflection correction" value and the number of inhabitants. As a new feature type noise barriers have to be defined which also have a "noise reflection correction" value.

The XSD schema which has to be defined to implement this model declares a new namespace for the noise extension (_http://www.citygml.org/ade/noise_de/2.0_). Additionally, the namespaces of the extended CityGML modules are declared (for corresponding prefixes see <<scls_4-3>> and <<cls_7>>), and the respective schema definition files are imported. The XML schema adds the elements _buildingReflectionCor­rection_ and _buildingHabitants_, both being members of the substitution group _bldg:_GenericApplication­Property­Of­AbstractBuilding_ which is defined by the CityGML _Building_ module. Thus, both elements may be used as child elements of CityGML building features. Noise barriers are represented as _NoiseCityFurnitureSegment_ elements. The corresponding type _NoiseCityFurnitureSegmentType_ is defined as subtype of the CityGML abstract type _core:AbstractCityObjectType_ provided by the _CityGML Core_ module, applying the usual subtyping mechanism of XML and XSD. A further element _noiseCityFurnitureSegmentProperty_ is added as a member of the substitution group __frn:_GenericApplication­Property­Of­CityFurniture__. By this means, noise barriers may be modelled as child elements of CityGML city furniture objects.

The XSD file for this example CityGML Noise ADE is given by the following excerpt (the complete CityGML Noise ADE is given in <<annex_h>>):


[source%unnumbered,xml]
----
<?xml version="1.0" encoding="UTF-8"?>
<xsd:schema xmlns="http://www.citygml.org/ade/noise_de/2.0" xmlns:gml="http://www.opengis.net/gml"
	xmlns:core="http://www.opengis.net/citygml/2.0"
	xmlns:bldg="http://www.opengis.net/citygml/building/2.0" 
	xmlns:frn="http://www.opengis.net/citygml/cityfurniture/2.0" 
	xmlns:xsd="http://www.w3.org/2001/XMLSchema"targetNamespace="http://www.citygml.org/ade/noise_de/2.0" 
	elementFormDefault="qualified" attributeFormDefault="unqualified">
	<xsd:import namespace="http://www.opengis.net/gml" schemaLocation="http://schemas.opengis.net/gml/3.1.1/base/gml.xsd"/>
	<xsd:import namespace="http://www.opengis.net/citygml/2.0" 
							schemaLocation="http://schemas.opengis.net/citygml/2.0/cityGMLBase.xsd"/>
	<xsd:import namespace="http://www.opengis.net/citygml/transportation/2.0" 
							schemaLocation="http://schemas.opengis.net/citygml/transportation/2.0/transportation.xsd"/>
	<xsd:import namespace="http://www.opengis.net/citygml/building/2.0" 
							schemaLocation="http://schemas.opengis.net/citygml/building/2.0/building.xsd"/>
	<xsd:import namespace="http://www.opengis.net/citygml/cityfurniture/2.0" 
							schemaLocation="http://schemas.opengis.net/citygml/cityfurniture/2.0/cityFurniture.xsd"/>	
	...
	<xsd:element name="buildingReflection" type="xsd:string" 
							  substitutionGroup="bldg:_GenericApplicationPropertyOfAbstractBuilding"/>
	<xsd:element name="buildingHabitants" type="xsd:positiveInteger" 
							  substitutionGroup="bldg:_GenericApplicationPropertyOfAbstractBuilding"/>
	...
	<xsd:element name="noiseCityFurnitureSegmentProperty" type="NoiseCityFurnitureSegmentPropertyType"
							  substitutionGroup="frn:_GenericApplicationPropertyOfCityFurniture"/>
	<!-- ============================================================================================ -->
	<xsd:complexType name="NoiseCityFurnitureSegmentPropertyType">
		<xsd:sequence minOccurs="0">
			<xsd:element ref="NoiseCityFurnitureSegment" minOccurs="0"/>
		</xsd:sequence>
		<xsd:attributeGroup ref="gml:AssociationAttributeGroup"/>
	</xsd:complexType>
	<!-- ============================================================================================ -->
	<xsd:complexType name="NoiseCityFurnitureSegmentType">
		<xsd:complexContent>
			<xsd:extension base="core:AbstractCityObjectType">
				<xsd:sequence>
					<xsd:element name="type" type="NoiseCityFurnitureSegmentTypeType" minOccurs="0"/>
					<xsd:element name="reflection" type="xsd:string" minOccurs="0"/>
					<xsd:element name="reflectionCorrection" type="gml:MeasureType" minOccurs="0"/>
					<xsd:element name="height" type="gml:LengthType" minOccurs="0"/>
					<xsd:element name="distance" type="gml:LengthType" minOccurs="0"/>
					<xsd:element name="lod0BaseLine" type="gml:CurvePropertyType"/>
				</xsd:sequence>
			</xsd:extension>
		</xsd:complexContent>
	</xsd:complexType>
	<!-- ============================================================================================ -->
	<xsd:element name="NoiseCityFurnitureSegment" type="NoiseCityFurnitureSegmentType" substitutionGroup="core:_CityObject"/>	...
</xsd:schema>
----

An example for a feature collection in a corresponding instance document is depicted below. Two CityGML buildings contain application specific properties distinguished from CityGML properties by the namespace prefix _noise_. The other properties, function and geometry, are defined by corresponding CityGML modules. In addition to the buildings, a noise barrier as child of a city furniture element is included in the feature collection. Please note, that the order of the child elements in the sequence is not arbitrary: the child elements defined by an ADE subschema have to occur after the child elements defined by CityGML modules. There is, however, no specific order of the ADE properties.


[source%unnumbered,xml]
----
...
<core:cityObjectMember>
	<bldg:Building gml:id="aa">
		<bldg:function>1004</bldg:function>
		<bldg:lod1Solid> ... </bldg:lod1Solid>
		<noise:buildingHabitants>14</noise:buildingHabitants>
		<noise:buildingReflectionCorrection uom="dB">4.123</noise:buildingReflectionCorrection>
	</bldg:Building>
</core:cityObjectMember>
<core:cityObjectMember>
	<bldg:Building gml:id="aaa">
		<bldg:function>1004</bldg:function>
		<bldg:lod1Solid> ... </bldg:lod1Solid>
		<noise:buildingReflectionCorrection uom="dB">3.123</noise:buildingReflectionCorrection>
		<noise:buildingHabitants>6</noise:buildingHabitants>
	</bldg:Building>
</core:cityObjectMember>
<core:cityObjectMember>
	<frn:CityFurniture gml:id="CFUR_0815">
		<frn:function>1520</frn:function>
		<frn:lod1Geometry> ... </frn:lod1Geometry>
		<noise:noiseCityFurnitureSegmentProperty>
			<noise:NoiseCityFurnitureSegment gml:id="CFRS_0815">
				<noise:type>1</noise:type>
				<noise:reflection>absorbierende Lärmschutzwand</noise:reflection>
				<noise:reflectionCorrection uom="dB">4.123</noise:reflectionCorrection>
				<noise:height uom="m">7.123</noise:height>
				<noise:distance uom="m">21.123</noise:distance>
				<noise:lod0BaseLine>
					<gml:LineString srsName="urn:ogc:def:crs,crs:EPSG:6.12:31466,crs:EPSG:6.12:5783" srsDimension="3">
						<gml:coordinates decimal="." cs="," ts=" ">5707335,2524175,188 5707338,2524181,188 5707330,2524185,188
							5707327,2524179,188</gml:coordinates>
					</gml:LineString>
				</noise:lod0BaseLine>
			</noise:NoiseCityFurnitureSegment>
		</noise:noiseCityFurnitureSegmentProperty>
	</frn:CityFurniture>
</core:cityObjectMember>
...
----


[[scls_10-14]]
=== Code lists

CityGML feature types often include attributes whose values can be enumerated in a list of discrete values. An example is the attribute _roof type_ of a building, whose attribute values typically are saddle back roof, hip roof, semi-hip roof, flat roof, pent roof, or tent roof. If such an attribute is typed as string, misspellings or different names for the same notion obstruct interoperability.

If the list of values is fixed, the allowed attribute values are specified in and enforced by the CityGML schema using an _enumeration_ as attribute type. Attributes of an enumerated type may only take values from the predefined list. Examples for such attributes are _relativeToTerrain_ and _relativeToWater_ of the abstract base class _core:_CityObject_ (_CityGML Core_ module, cf. <<scls_10-1>>) as well as _wrapMode_ of the abstract class _app:_Texture_ (_Appearance_ module, cf. <<scls_9-4>>).

In case a fixed enumeration of possible attribute values is not suitable, the attribute type is specified as _gml:CodeType_ and the allowed attribute values can be provided in a _code list_ which is specified outside the CityGML schema. Examples for such attributes are _class_, _function_, and _usage_ which are available for almost all CityGML feature types. A code list contains coded attribute values which hinder misspellings and ensure that the same code is used for the same notion or concept. If a code list is provided for an attribute of type _gml:CodeType_, then any conformant attribute shall only take values from the given code list. This allows applications to validate the attribute values and thus facilitates semantic and syntactic interoperability. The optional _codeSpace_ attribute declared for _gml:CodeType_ is used to associate an attribute with a code list. If a _codeSpace_ is present, then its value shall be a persistent URI identifying the code list. If no _codeSpace_ is given, then the attribute value can only be interpreted as a simple text token and validation requires additional knowledge.

The governance of code lists is decoupled from the governance of the CityGML schema and specification. Accordingly, code lists can be specified by any organisation or information community according to their information needs. There shall be one authority per _codeSpace_ and hence per code list who is in charge of the contents and the maintenance of the code list. As a result, the code list values are managed outside the CityGML schema. Thus, in contrast to a fixed _enumeration_ enforced by the CityGML schema, changes to a code list do not require a revision of the CityGML schema and specification.

The contents of code lists may substantially vary for different countries (e.g., due to national law or regulations) and for different information communities. For this reason, this International standard does not specify normative code lists for any of the attributes of type _gml:CodeType_. However, <<annex_c>> provides non-normative code lists for selected attributes which are proposed and maintained by the SIG 3D. These code lists can be directly referenced in CityGML instance documents and serve as an example for the definition of code lists. The code lists given in <<annex_c>> comprise the non-normative code lists which are included in the previous version 1.0 of this International standard in order to ensure backwards compatibility.

It is recommended that code lists are implemented as _simple dictionaries_ following the _GML 3.1.1 Simple Dictionary Profile_ (cf. Whiteside 2005)_._ An example for a code list implemented as _simple dictionary_ is given below. It shows an excerpt of the code list proposed by the SIG 3D for the attribute _roofType_ of the class &#95;__AbstractBuilding__ (_Building_ module, cf. <<scls_10-3>>).


[[listing_2]]
.Example of a code list implemented as simple dictionary following the _GML 3.1.1 Simple Dictionary Profile._
[source,xml]
----
<gml:Dictionary xmlns:gml="http://www.opengis.net/gml"xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.opengis.net/gml http://schemas.opengis.net/gml/3.1.1/profiles/SimpleDictionary/1.0.0/gmlSimpleDictionaryProfile.xsd"
 gml:id="roofType">
    <gml:name>roofType</gml:name>
    <gml:dictionaryEntry>
        <gml:Definition gml:id="id357">
            <gml:description>flat roof</gml:description>
            <gml:name>1000</gml:name>
        </gml:Definition>
    </gml:dictionaryEntry>
    <gml:dictionaryEntry>
        <gml:Definition gml:id="id358">
            <gml:description>monopitch roof</gml:description>
            <gml:name>1010</gml:name>
        </gml:Definition>
    </gml:dictionaryEntry>
    ...
</gml:Dictionary>
----


In the simple dictionary concept, the code list itself is represented by a _gml:Dictionary_ element. The allowed attribute values are listed as _gml:Definition_ entries contained in the _gml:Dictionary_. For each definition entry, the coded attribute value is specified by the _gml:name_ subelement. Any attribute referencing this code list in a CityGML instance document may only take values which are specified by a _gml:name_ element of one of the definition entries. If the attribute value is not specified by one of the definition entries, then the attribute value is invalid. The _gml:description_ subelement of a definition entry provides an additional textual description for the coded attribute value. This description can be used, for example, as human readable substitute for the coded attribute value.

The following excerpt of a CityGML instance document illustrates the usage of the code list mechanism. The document contains a _bldg:Building_ object whose _roofType_ value is taken from the code list shown in <<listing_2>>. The _codeSpace_ attribute of the _roofType_ element identifies the code list through the globally unique URL _http://www.sig3d.org/codelists/standard/building/2.0/_AbstractBuilding_roofType.xml_ which is managed and maintained by the SIG 3D. According to this code list, the coded attribute value _1000_ denotes a _flat roof_ for this building.



[source%unnumbered,xml]
----
<bldg:Building>
    <bldg:roofType
        codeSpace="http://www.sig3d.org/codelists/standard/building/2.0/_AbstractBuilding_roofType.xml"\>1000\</bldg:roofType\>
    ...
</bldg:Building>
----
